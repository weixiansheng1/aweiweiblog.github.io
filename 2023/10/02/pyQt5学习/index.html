<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>pyQt5学习 | 嗷，Mr.威</title><meta name="author" content="嗷，Mr.威"><meta name="copyright" content="嗷，Mr.威"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2.2消息框控件123456789101112131415161718192021222324252627282930313233import sysfrom PyQt5.QtWidgets import *from PyQt5.QtCore import *from PyQt5.QtGui import *class Window(QWidget):    def __init__(self):"><meta property="og:type" content="article"><meta property="og:title" content="pyQt5学习"><meta property="og:url" content="https://weixiansheng1.github.io/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/index.html"><meta property="og:site_name" content="嗷，Mr.威"><meta property="og:description" content="2.2消息框控件123456789101112131415161718192021222324252627282930313233import sysfrom PyQt5.QtWidgets import *from PyQt5.QtCore import *from PyQt5.QtGui import *class Window(QWidget):    def __init__(self):"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://th.bing.com/th/id/R.3a2265a62c9ea6e5769e2ab506e606a6?rik=eRGuqrtWyswwWg&riu=http%3a%2f%2fwww.v3wall.com%2fwallpaper%2f1920_1080%2f1108%2f1920_1080_20110819121148354481.jpg&ehk=Ngr6unVKpbdvUlP8b1xdPcLdhijzPSJSsMoSX8EKvL0%3d&risl=&pid=ImgRaw&r=0"><meta property="article:published_time" content="2023-10-02T06:17:08.474Z"><meta property="article:modified_time" content="2023-10-01T14:25:00.000Z"><meta property="article:author" content="嗷，Mr.威"><meta property="article:tag" content="python"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://th.bing.com/th/id/R.3a2265a62c9ea6e5769e2ab506e606a6?rik=eRGuqrtWyswwWg&riu=http%3a%2f%2fwww.v3wall.com%2fwallpaper%2f1920_1080%2f1108%2f1920_1080_20110819121148354481.jpg&ehk=Ngr6unVKpbdvUlP8b1xdPcLdhijzPSJSsMoSX8EKvL0%3d&risl=&pid=ImgRaw&r=0"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://weixiansheng1.github.io/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":5,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"pyQt5学习",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-10-01 22:25:00"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><style>#article-container.post-content h1:before,h2:before,h3:before,h4:before,h5:before,h6:before{-webkit-animation:avatar_turn_around 1s linear infinite;-moz-animation:avatar_turn_around 1s linear infinite;-o-animation:avatar_turn_around 1s linear infinite;-ms-animation:avatar_turn_around 1s linear infinite;animation:avatar_turn_around 1s linear infinite}</style><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="嗷，Mr.威" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/2f517e76-.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://th.bing.com/th/id/R.3a2265a62c9ea6e5769e2ab506e606a6?rik=eRGuqrtWyswwWg&amp;riu=http%3a%2f%2fwww.v3wall.com%2fwallpaper%2f1920_1080%2f1108%2f1920_1080_20110819121148354481.jpg&amp;ehk=Ngr6unVKpbdvUlP8b1xdPcLdhijzPSJSsMoSX8EKvL0%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0)"><nav id="nav"><span id="blog-info"><a href="/" title="嗷，Mr.威"><span class="site-name">嗷，Mr.威</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">pyQt5学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-01T14:25:00.000Z" title="更新于 2023-10-01 22:25:00">2023-10-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">36.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>159分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="pyQt5学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="2-2消息框控件"><a href="#2-2消息框控件" class="headerlink" title="2.2消息框控件"></a>2.2消息框控件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        #实例化qpushbotton按钮控件</span><br><span class="line">        button = QPushButton(&#x27;信息框&#x27;)                  </span><br><span class="line">        button.clicked.connect(self.show_information)  </span><br><span class="line">        </span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(button)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_information(self):</span><br><span class="line">        QMessageBox.information(self,&#x27;标题&#x27;,&#x27;内容&#x27;,QMessageBox.Yes)  # information(父类，信息框标题，信息框内容)</span><br><span class="line">        #如果显示多个按钮：QMessageBox.information(self, &#x27;标题&#x27;, &#x27;内容&#x27;, QMessageBox.Yes|QMessageBox.No)，</span><br><span class="line">        #默认不填则yes。    Ok,Yes,No,Close,Cancel,Open,Save。</span><br><span class="line">        #询问框：QMessageBox.question()</span><br><span class="line">        #信息框：QMessageBox.information()</span><br><span class="line">        #警告框：QMessageBox.warning()</span><br><span class="line">        #错误框：QMessageBox.critical()</span><br><span class="line">        #关于框：QMessageBox.about()</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())#关闭窗口时，app.exec()返回0并穿给sys.exit()，使python解释器正常退出。</span><br></pre></td></tr></table></figure><h3 id="2-2-2与消息框交互"><a href="#2-2-2与消息框交互" class="headerlink" title="2.2.2与消息框交互"></a>2.2.2与消息框交互</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        #实例化qpushbotton按钮控件</span><br><span class="line">        self.button = QPushButton(&#x27;信息框&#x27;)                  </span><br><span class="line">        self.button.clicked.connect(self.show_information)  </span><br><span class="line">        </span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.button)#比2.2多了self</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_information(self):</span><br><span class="line">        choice = QMessageBox.question(self,&#x27;标题&#x27;,&#x27;内容&#x27;,QMessageBox.Yes|QMessageBox.No)  # information(父类，信息框标题，信息框内容)</span><br><span class="line">        #如果显示多个按钮：QMessageBox.information(self, &#x27;标题&#x27;, &#x27;内容&#x27;, QMessageBox.Yes|QMessageBox.No)，</span><br><span class="line">        #默认不填则yes。    Ok,Yes,No,Close,Cancel,Open,Save。</span><br><span class="line">        #询问框：QMessageBox.question()</span><br><span class="line">        #信息框：QMessageBox.information()</span><br><span class="line">        #警告框：QMessageBox.warning()</span><br><span class="line">        #错误框：QMessageBox.critical()</span><br><span class="line">        #关于框：QMessageBox.about()</span><br><span class="line">        if choice == QMessageBox.Yes:</span><br><span class="line">            self.button.setText(&#x27;hao&#x27;)</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())#关闭窗口时，app.exec()返回0并穿给sys.exit()，使python解释器正常退出。</span><br></pre></td></tr></table></figure><h3 id="2-2-3编写带中文按钮的消息框"><a href="#2-2-3编写带中文按钮的消息框" class="headerlink" title="2.2.3编写带中文按钮的消息框"></a>2.2.3编写带中文按钮的消息框</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">#自定义消息框</span><br><span class="line">class QuestionMessageBox(QMessageBox):</span><br><span class="line">    def __init__(self, parent, title, content):     #初始化</span><br><span class="line">        super(QuestionMessageBox, self).__init__(parent)</span><br><span class="line">        self.setWindowTitle(title)</span><br><span class="line">        self.setText(content)</span><br><span class="line">        self.setIcon(QMessageBox.Question)      #设置图标</span><br><span class="line">        #问号图标：QMessageBox.Question</span><br><span class="line">        #信息图标：QMessageBox.Information</span><br><span class="line">        #警告图标：QMessageBox.Warning</span><br><span class="line">        #错误图标：QMessageBox.Critical</span><br><span class="line">        #无图标： QMessageBox.NoIcon</span><br><span class="line">        self.addButton(&#x27;是&#x27;, QMessageBox.YesRole)  #自定义按钮</span><br><span class="line">        self.addButton(&#x27;否&#x27;, QMessageBox.NoRole)   #</span><br><span class="line">        #ok按钮：QMessageBox.AcceptRole</span><br><span class="line">        #cancel按钮：QMessageBox.RejectRole</span><br><span class="line">        #yes按钮：QMessageBox.YesRole</span><br><span class="line">        #No按钮：QMessageBox.NoRole</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        #实例化qpushbotton按钮控件</span><br><span class="line">        self.button = QPushButton(&#x27;信息框&#x27;)                  </span><br><span class="line">        self.button.clicked.connect(self.show_information)  </span><br><span class="line">        </span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.button)#比2.2多了self</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_information(self):</span><br><span class="line">        choice = QuestionMessageBox(self,&#x27;标题&#x27;,&#x27;内容&#x27;)  # information(父类，信息框标题，信息框内容)</span><br><span class="line">        choice.exec()#调用exec方法让消息框显示出来</span><br><span class="line">        if choice.clickedButton().text()==&#x27;是&#x27;:</span><br><span class="line">            self.button.setText(&#x27;hao&#x27;)</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())#关闭窗口时，app.exec()返回0并穿给sys.exit()，使python解释器正常退出。</span><br><span class="line">    </span><br></pre></td></tr></table></figure><h2 id="2-3文本框控件"><a href="#2-3文本框控件" class="headerlink" title="2.3文本框控件"></a>2.3文本框控件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.username_line = QLineEdit()           #注释1开始</span><br><span class="line">        self.password_line = QLineEdit()</span><br><span class="line">        </span><br><span class="line">        h_layout1 = QHBoxLayout()</span><br><span class="line">        h_layout2 = QHBoxLayout()</span><br><span class="line">        v_layout = QVBoxLayout()                   #注释1结束</span><br><span class="line">        h_layout1.addWidget(QLabel(&#x27;Username:&#x27;))   # 2</span><br><span class="line">        h_layout1.addWidget(self.username_line)</span><br><span class="line">        h_layout2.addWidget(QLabel(&#x27;Password:&#x27;))</span><br><span class="line">        h_layout2.addWidget(self.password_line)</span><br><span class="line">        v_layout.addLayout(h_layout1)</span><br><span class="line">        v_layout.addLayout(h_layout2)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="2-4-4复选框按钮控件QCheckBox"><a href="#2-4-4复选框按钮控件QCheckBox" class="headerlink" title="2.4.4复选框按钮控件QCheckBox"></a>2.4.4复选框按钮控件QCheckBox</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.check_box1 = QCheckBox(&#x27;Check 1&#x27;)</span><br><span class="line">        self.check_box2 = QCheckBox(&#x27;Check 2&#x27;)</span><br><span class="line">        self.check_box3 = QCheckBox(&#x27;Check 3&#x27;)</span><br><span class="line"></span><br><span class="line">        self.check_box1.setChecked(True)                       #复选框默认选中和未选中</span><br><span class="line">        self.check_box2.setChecked(False)</span><br><span class="line">        self.check_box3.setTristate(True)                      #增加状态</span><br><span class="line">        self.check_box3.setCheckState(Qt.PartiallyChecked)     #设置半选中状态，也可用来设置按钮的选中和未选中状态</span><br><span class="line">        #Qt.Uncheckd          未选中状态</span><br><span class="line">        #Qt.PartiallyChecked  半选中状态</span><br><span class="line">        #Qt.Checked           选中状态</span><br><span class="line">        </span><br><span class="line">        self.check_box1.stateChanged.connect(self.show_state)  #注释2开始</span><br><span class="line">        self.check_box2.stateChanged.connect(self.show_state)</span><br><span class="line">        self.check_box3.stateChanged.connect(self.show_state)  #注释2结束</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.check_box1)</span><br><span class="line">        v_layout.addWidget(self.check_box2)</span><br><span class="line">        v_layout.addWidget(self.check_box3)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def show_state(self):</span><br><span class="line">        print(self.sender().checkState())</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="2-4-5可编辑的下拉框按钮控件QcomboBox"><a href="#2-4-5可编辑的下拉框按钮控件QcomboBox" class="headerlink" title="2.4.5可编辑的下拉框按钮控件QcomboBox"></a>2.4.5可编辑的下拉框按钮控件QcomboBox</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.combo_box = QComboBox()</span><br><span class="line">        self.combo_box.addItem(&#x27;Louis&#x27;)</span><br><span class="line">        self.combo_box.addItems([&#x27;Mike&#x27;, &#x27;Mary&#x27;, &#x27;John&#x27;])</span><br><span class="line">        self.combo_box.currentIndexChanged.connect(self.show_choice)</span><br><span class="line"></span><br><span class="line">        self.combo_box.setEditable(True)           #设置可编辑的下拉框</span><br><span class="line">        self.line_edit = self.combo_box.lineEdit() #获取下拉框的内容</span><br><span class="line">        self.line_edit.textChanged.connect(self.show_edited_text)  # 2</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.combo_box)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_choice(self):</span><br><span class="line">        print(self.combo_box.currentIndex())</span><br><span class="line">        print(self.combo_box.currentText())</span><br><span class="line"></span><br><span class="line">    def show_edited_text(self):</span><br><span class="line">        print(self.line_edit.text())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="2-5-1液晶数字控件QLCDNumber"><a href="#2-5-1液晶数字控件QLCDNumber" class="headerlink" title="2.5.1液晶数字控件QLCDNumber"></a>2.5.1液晶数字控件QLCDNumber</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.lcd1 = QLCDNumber()</span><br><span class="line">        self.lcd1.setDigitCount(5)                     # 设置QLCDNumber控件的最大长度</span><br><span class="line">        self.lcd1.display(12345)                       # 通过display设置要显示的数字</span><br><span class="line">        self.lcd1.setMode(QLCDNumber.Dec)              # 设置数字的进制</span><br><span class="line">        #QLCDNumber.Hex  十六进制</span><br><span class="line">        #QLCDNumber.Dec  十进制</span><br><span class="line">        #QLCDNumber.Oct  八进制</span><br><span class="line">        #QLCDNumber.Bin  二进制</span><br><span class="line">        </span><br><span class="line">        self.lcd2 = QLCDNumber()</span><br><span class="line">        self.lcd2.setDigitCount(5)</span><br><span class="line">        self.lcd2.display(0.1234)</span><br><span class="line">        self.lcd2.setSegmentStyle(QLCDNumber.Flat)     # 设置浮点数样式</span><br><span class="line">        #QLCDNumber.Outline  片段凸起，并用背景颜色填充</span><br><span class="line">        #QLCDNumber.Filled   片段凸起，并用前景颜色填充</span><br><span class="line">        #QLCDNumber.Flat     片段扁平，并用背景颜色填充</span><br><span class="line"></span><br><span class="line">        self.lcd3 = QLCDNumber()</span><br><span class="line">        self.lcd3.setDigitCount(5)</span><br><span class="line">        self.lcd3.display(123456789)   # 显示对象大于所设置的长度，则显示为0</span><br><span class="line"></span><br><span class="line">        self.lcd4 = QLCDNumber()</span><br><span class="line">        self.lcd4.display(&#x27;HELLO&#x27;)     # QLCNumber控件只能显示这些字符：</span><br><span class="line">        #A、B、C、D、E、F、h、H、L、o、P、r、u、U、Y、O/0、S/5、g/9。</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.lcd1)</span><br><span class="line">        v_layout.addWidget(self.lcd2)</span><br><span class="line">        v_layout.addWidget(self.lcd3)</span><br><span class="line">        v_layout.addWidget(self.lcd4)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="2-5-2数字调节框控件QSpinBox和QDoubleSpinBox"><a href="#2-5-2数字调节框控件QSpinBox和QDoubleSpinBox" class="headerlink" title="2.5.2数字调节框控件QSpinBox和QDoubleSpinBox"></a>2.5.2数字调节框控件QSpinBox和QDoubleSpinBox</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.spinbox = QSpinBox()              # 调节整数</span><br><span class="line">        self.spinbox.setRange(-99, 99)         # 调节整数范围</span><br><span class="line">        self.spinbox.setSingleStep(2)          # 调节整数步长</span><br><span class="line">        self.spinbox.setValue(66)              # 设置初始值</span><br><span class="line">        self.spinbox.valueChanged.connect(self.show_spinbox_value)</span><br><span class="line"></span><br><span class="line">        self.db_spinbox = QDoubleSpinBox()     # 调节浮点数</span><br><span class="line">        self.db_spinbox.setRange(-99.99, 99.99)</span><br><span class="line">        self.db_spinbox.setSingleStep(1.5)</span><br><span class="line">        self.db_spinbox.setValue(66.66)</span><br><span class="line">        self.db_spinbox.valueChanged.connect(self.show_db_spinbox_value)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.spinbox)</span><br><span class="line">        v_layout.addWidget(self.db_spinbox)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def show_spinbox_value(self):</span><br><span class="line">        print(self.spinbox.value())</span><br><span class="line"></span><br><span class="line">    def show_db_spinbox_value(self):</span><br><span class="line">        print(self.db_spinbox.value())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="2-5-3滑动条控件QSlider"><a href="#2-5-3滑动条控件QSlider" class="headerlink" title="2.5.3滑动条控件QSlider"></a>2.5.3滑动条控件QSlider</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.slider1 = QSlider()                           # 滑动条控件</span><br><span class="line">        self.slider1.setRange(0, 99)                       # 范围</span><br><span class="line">        self.slider1.setValue(66)                          # 初始值</span><br><span class="line">        self.slider1.setSingleStep(2)                      # 步长</span><br><span class="line">        self.slider1.valueChanged.connect(self.show_value) </span><br><span class="line"></span><br><span class="line">        self.slider2 = QSlider()                           </span><br><span class="line">        self.slider2.setOrientation(Qt.Horizontal)        # 设置滑动条方向为水平</span><br><span class="line">        # Qt.Horizontal 水平方向</span><br><span class="line">        # Qt.Vertical   垂直方向</span><br><span class="line">        </span><br><span class="line">        self.slider2.setMinimum(0)</span><br><span class="line">        self.slider2.setMaximum(99)                        #设置最大最小值，同setRange</span><br><span class="line"></span><br><span class="line">        self.slider3 = QSlider(Qt.Horizontal)              # 实例化时直接传入滑动条方向</span><br><span class="line">        self.slider3.setRange(0, 99)</span><br><span class="line">        self.slider3.setTickPosition(QSlider.TicksBelow)   # 增加刻度线</span><br><span class="line">        # QSlider.NoTicks        不添加刻度线</span><br><span class="line">        # QSlider.TicksBothSides 在滑动条两侧都添加刻度线</span><br><span class="line">        # QSlider.TicksAbove     在水平滑动条上方添加刻度线</span><br><span class="line">        # QSlider.TicksBelow     在水平滑动条方添加刻度线</span><br><span class="line">        # QSlider.TicksLeft      在垂直滑动条左侧添加刻度线</span><br><span class="line">        # QSlider.TicksRight     在垂直滑动条右侧添加刻度线</span><br><span class="line">        self.slider3.setTickInterval(10)                   # 设置刻度间隔</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.slider1)</span><br><span class="line">        v_layout.addWidget(self.slider2)</span><br><span class="line">        v_layout.addWidget(self.slider3)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def show_value(self):</span><br><span class="line">        print(self.slider1.value())</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="2-5-3滑动条控件QSlider-1"><a href="#2-5-3滑动条控件QSlider-1" class="headerlink" title="2.5.3滑动条控件QSlider"></a>2.5.3滑动条控件QSlider</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.dial = QDial()</span><br><span class="line">        self.dial.setRange(0, 365)                     #设置范围</span><br><span class="line">        self.dial.valueChanged.connect(self.show_value)</span><br><span class="line">        </span><br><span class="line">        self.dial.setNotchesVisible(True)  #是否显示刻度线</span><br><span class="line">        self.dial.setNotchTarget(10.5)     #设置刻度之间的像素间隔（默认3.7像素）</span><br><span class="line">        #self.dial.setWrapping(True)       #加这行代码可以让刻度线对仪表盘360°包裹</span><br><span class="line">        </span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.dial)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_value(self):</span><br><span class="line">        print(self.dial.value())</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="2-6-1日历控件QCalendarWidge"><a href="#2-6-1日历控件QCalendarWidge" class="headerlink" title="2.6.1日历控件QCalendarWidge"></a>2.6.1日历控件QCalendarWidge</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">爬虫任务是耗时的，所以我们不能把爬虫代码放在UI主线程中执行，否则会导致界面无响应。正确的做法是将爬虫任务交给子线程来完成</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">from parsel import Selector</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class CrawlThread(QThread):</span><br><span class="line">    log_signal = pyqtSignal(str)</span><br><span class="line">    finish_signal = pyqtSignal()</span><br><span class="line">    data_signal = pyqtSignal(list)</span><br><span class="line"></span><br><span class="line">    def __init__(self, window):</span><br><span class="line">        super(CrawlThread, self).__init__()</span><br><span class="line">        self.window = window</span><br><span class="line">        self.flag = True</span><br><span class="line"></span><br><span class="line">    def run(self):</span><br><span class="line">        page_count = 0</span><br><span class="line">        total_page = self.window.page_spin_box.value()</span><br><span class="line"></span><br><span class="line">        self.flag = True</span><br><span class="line">        while page_count &lt; total_page:</span><br><span class="line">            if self.flag:</span><br><span class="line">                page_count += 1</span><br><span class="line">                self.crawl_page(page_count)</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">        self.finish_signal.emit()   # 传递爬取日志</span><br><span class="line"></span><br><span class="line">    def crawl_page(self, page_num):</span><br><span class="line">        self.log_signal.emit(f&#x27;当前正在爬取第&#123;page_num&#125;页&#x27;)</span><br><span class="line"></span><br><span class="line">        page_url = f&#x27;https://quotes.toscrape.com/page/&#123;page_num&#125;/&#x27;</span><br><span class="line">        response = requests.get(page_url)</span><br><span class="line"></span><br><span class="line">        if &#x27;No quotes found!&#x27; in response.text:</span><br><span class="line">            self.log_signal.emit(&#x27;当前页面上没有名言了，不再继续爬取。&#x27;)</span><br><span class="line">            self.stop()</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        selector = Selector(response.text)</span><br><span class="line">        quotes = selector.xpath(&#x27;//div[@class=&quot;quote&quot;]&#x27;)</span><br><span class="line"></span><br><span class="line">        for quote in quotes:</span><br><span class="line">            content = quote.xpath(&#x27;./span/text()&#x27;).extract_first()</span><br><span class="line">            author = quote.xpath(&#x27;./span/small/text()&#x27;).extract_first()</span><br><span class="line">            tags = quote.xpath(&#x27;./div[@class=&quot;tags&quot;]/a/text()&#x27;).extract()</span><br><span class="line">            tags = &#x27;;&#x27;.join(tags)</span><br><span class="line">            print([content, author, tags])</span><br><span class="line">            self.data_signal.emit([content, author, tags])  # 传递数据</span><br><span class="line"></span><br><span class="line">    def stop(self):</span><br><span class="line">        self.flag = False</span><br></pre></td></tr></table></figure><h3 id="2-6-2日期时间控件QDateTimeEdit"><a href="#2-6-2日期时间控件QDateTimeEdit" class="headerlink" title="2.6.2日期时间控件QDateTimeEdit"></a>2.6.2日期时间控件QDateTimeEdit</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.datetime_edit = QDateTimeEdit(QDateTime.currentDateTime())</span><br><span class="line">        self.datetime_edit.setDisplayFormat(&#x27;yyyy-MM-dd HH:mm:ss&#x27;) # 1</span><br><span class="line">        self.datetime_edit.setDateRange(QDate(1949, 10, 1), QDate(6666, 6, 6))</span><br><span class="line">        self.datetime_edit.setCalendarPopup(True)      # 2</span><br><span class="line">        self.datetime_edit.dateTimeChanged.connect(self.show_text)  # 3</span><br><span class="line"></span><br><span class="line">        self.date_edit = QDateEdit(QDate.currentDate())</span><br><span class="line">        self.date_edit.setDisplayFormat(&#x27;yyyy-MM-dd&#x27;)</span><br><span class="line">        self.date_edit.setDateRange(QDate(1949, 10, 1), QDate(6666, 6, 6))</span><br><span class="line">        self.date_edit.dateChanged.connect(self.show_text)</span><br><span class="line"></span><br><span class="line">        self.time_edit = QTimeEdit(QTime.currentTime())</span><br><span class="line">        self.time_edit.setDisplayFormat(&#x27;HH:mm:ss&#x27;)</span><br><span class="line">        self.time_edit.setTimeRange(QTime(6, 6, 6), QTime(8, 8, 8))</span><br><span class="line">        self.date_edit.timeChanged.connect(self.show_text)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.datetime_edit)</span><br><span class="line">        v_layout.addWidget(self.date_edit)</span><br><span class="line">        v_layout.addWidget(self.time_edit)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def show_text(self):</span><br><span class="line">        print(self.sender().text())</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="2-7-1定时器控件QTimer"><a href="#2-7-1定时器控件QTimer" class="headerlink" title="2.7.1定时器控件QTimer"></a>2.7.1定时器控件QTimer</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.lcd = QLCDNumber()                            #显示时间</span><br><span class="line">        self.lcd.setSegmentStyle(QLCDNumber.Flat)</span><br><span class="line">        self.lcd.setDigitCount(20)                         #显示最大字符数</span><br><span class="line">        self.update_date_time()                            #显示当前时间（不会动）</span><br><span class="line">        </span><br><span class="line">        self.timer = QTimer()                              #注释2开始</span><br><span class="line">        self.timer.start(1000)                             #每隔1000ms发射一次timeout信号</span><br><span class="line">        self.timer.timeout.connect(self.update_date_time)  #链接的槽函数将新时间显示到QLCDNumber控件上</span><br><span class="line">    </span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.lcd)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def update_date_time(self):</span><br><span class="line">        date_time = QDateTime.currentDateTime().toString(&#x27;yyyy-M-d hh:mm:ss&#x27;)</span><br><span class="line">        self.lcd.display(date_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="2-7-2进度条控件QProgressBar"><a href="#2-7-2进度条控件QProgressBar" class="headerlink" title="2.7.2进度条控件QProgressBar"></a>2.7.2进度条控件QProgressBar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.value = 0                                 # 用于保存当前进度值</span><br><span class="line"></span><br><span class="line">        self.timer = QTimer()</span><br><span class="line">        self.timer.start(100)</span><br><span class="line">        self.timer.timeout.connect(self.update_progress)</span><br><span class="line"></span><br><span class="line">        self.progress_bar1 = QProgressBar()            #进度条1</span><br><span class="line">        self.progress_bar1.setRange(0, 100)</span><br><span class="line">        #self.progress_bar1.setRange(0, 0)     #使进度条显示繁忙</span><br><span class="line">        </span><br><span class="line">        self.progress_bar2 = QProgressBar()</span><br><span class="line">        self.progress_bar2.setTextVisible(False)       #隐藏进度条2的数字</span><br><span class="line">        self.progress_bar2.setMinimum(0)</span><br><span class="line">        self.progress_bar2.setMaximum(100)</span><br><span class="line">        self.progress_bar2.setInvertedAppearance(True) #使进度条从右向左填满</span><br><span class="line">        </span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.progress_bar1)</span><br><span class="line">        v_layout.addWidget(self.progress_bar2)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def update_progress(self):</span><br><span class="line">        self.value += 1</span><br><span class="line">        self.progress_bar1.setValue(self.value)</span><br><span class="line">        self.progress_bar2.setValue(self.value)</span><br><span class="line"></span><br><span class="line">        if self.value == 100:</span><br><span class="line">            self.timer.stop()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-1-1分组框控件QGroupBox"><a href="#3-1-1分组框控件QGroupBox" class="headerlink" title="3.1.1分组框控件QGroupBox"></a>3.1.1分组框控件QGroupBox</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.letter_group_box = QGroupBox(&#x27;字母&#x27;)   #直接放入名称</span><br><span class="line">        self.number_group_box = QGroupBox()</span><br><span class="line">        self.number_group_box.setTitle(&#x27;数字&#x27;)      #使用setTitle放入名称</span><br><span class="line">        </span><br><span class="line">        self.letter1 = QLabel(&#x27;a&#x27;)</span><br><span class="line">        self.letter2 = QLabel(&#x27;b&#x27;)</span><br><span class="line">        self.letter3 = QLabel(&#x27;c&#x27;)</span><br><span class="line">        self.number1 = QLabel(&#x27;1&#x27;)</span><br><span class="line">        self.number2 = QLabel(&#x27;2&#x27;)</span><br><span class="line">        self.number3 = QLabel(&#x27;3&#x27;)</span><br><span class="line"></span><br><span class="line">        letter_v_layout = QVBoxLayout()</span><br><span class="line">        number_v_layout = QVBoxLayout()</span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        letter_v_layout.addWidget(self.letter1)</span><br><span class="line">        letter_v_layout.addWidget(self.letter2)</span><br><span class="line">        letter_v_layout.addWidget(self.letter3)</span><br><span class="line">        number_v_layout.addWidget(self.number1)</span><br><span class="line">        number_v_layout.addWidget(self.number2)</span><br><span class="line">        number_v_layout.addWidget(self.number3)</span><br><span class="line"></span><br><span class="line">        self.letter_group_box.setLayout(letter_v_layout)   #注释2开始</span><br><span class="line">        self.number_group_box.setLayout(number_v_layout)   #注释2结束</span><br><span class="line">        window_v_layout.addWidget(self.letter_group_box)   #注释3开始</span><br><span class="line">        window_v_layout.addWidget(self.number_group_box)</span><br><span class="line">        self.setLayout(window_v_layout)                    #注释3结束</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-1-2工具箱控件QToolBox"><a href="#3-1-2工具箱控件QToolBox" class="headerlink" title="3.1.2工具箱控件QToolBox"></a>3.1.2工具箱控件QToolBox</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.letter_group_box = QGroupBox()</span><br><span class="line">        self.number_group_box = QGroupBox()</span><br><span class="line"></span><br><span class="line">        self.letter1 = QLabel(&#x27;a&#x27;)</span><br><span class="line">        self.letter2 = QLabel(&#x27;b&#x27;)</span><br><span class="line">        self.letter3 = QLabel(&#x27;c&#x27;)</span><br><span class="line">        self.number1 = QLabel(&#x27;1&#x27;)</span><br><span class="line">        self.number2 = QLabel(&#x27;2&#x27;)</span><br><span class="line">        self.number3 = QLabel(&#x27;3&#x27;)</span><br><span class="line"></span><br><span class="line">        letter_v_layout = QVBoxLayout()</span><br><span class="line">        number_v_layout = QVBoxLayout()</span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        letter_v_layout.addWidget(self.letter1)</span><br><span class="line">        letter_v_layout.addWidget(self.letter2)</span><br><span class="line">        letter_v_layout.addWidget(self.letter3)</span><br><span class="line">        number_v_layout.addWidget(self.number1)</span><br><span class="line">        number_v_layout.addWidget(self.number2)</span><br><span class="line">        number_v_layout.addWidget(self.number3)</span><br><span class="line">        self.letter_group_box.setLayout(letter_v_layout)</span><br><span class="line">        self.number_group_box.setLayout(number_v_layout)</span><br><span class="line"></span><br><span class="line">        self.tool_box = QToolBox()                            </span><br><span class="line">        self.tool_box.addItem(self.letter_group_box, &#x27;字母&#x27;)</span><br><span class="line">        self.tool_box.insertItem(0, self.number_group_box, &#x27;数字&#x27;)#0表示插入位置</span><br><span class="line">        self.tool_box.setItemIcon(0, QIcon(&#x27;number.png&#x27;))     #加图标</span><br><span class="line">        self.tool_box.setItemIcon(1, QIcon(&#x27;letter.png&#x27;))     #加图标</span><br><span class="line">        self.tool_box.currentChanged.connect(self.show_current_text) #信号会在抽屉被切换时发射</span><br><span class="line"></span><br><span class="line">        window_v_layout.addWidget(self.tool_box)</span><br><span class="line">        self.setLayout(window_v_layout)</span><br><span class="line"></span><br><span class="line">    def show_current_text(self):</span><br><span class="line">        index = self.tool_box.currentIndex()</span><br><span class="line">        print(self.tool_box.itemText(index))</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-2-1控件滚动区域QScrollArea"><a href="#3-2-1控件滚动区域QScrollArea" class="headerlink" title="3.2.1控件滚动区域QScrollArea"></a>3.2.1控件滚动区域QScrollArea</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.pic_scroll_area = QScrollArea()               #实例化对象</span><br><span class="line">        self.btn_scroll_area = QScrollArea()               </span><br><span class="line"></span><br><span class="line">        pic_label = QLabel()</span><br><span class="line">        pic_label.setPixmap(QPixmap(&#x27;pyqt.jpg&#x27;))</span><br><span class="line">        self.pic_scroll_area.setWidget(pic_label)          #显示图片</span><br><span class="line">        self.pic_scroll_area.ensureVisible(750, 750, 100, 100)#（坐标x，坐标y，边距x，边距y）</span><br><span class="line">        </span><br><span class="line">        widget_for_btns = QWidget()                        #注释3开始</span><br><span class="line">        btn_h_layout = QHBoxLayout()</span><br><span class="line">        for i in range(100):</span><br><span class="line">            btn = QPushButton(f&#x27;按钮&#123;i+1&#125;&#x27;)</span><br><span class="line">            btn_h_layout.addWidget(btn)</span><br><span class="line">        widget_for_btns.setLayout(btn_h_layout)</span><br><span class="line">        self.btn_scroll_area.setWidget(widget_for_btns)</span><br><span class="line">        self.btn_scroll_area.setAlignment(Qt.AlignCenter)  #注释3结束</span><br><span class="line"></span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        window_v_layout.addWidget(self.pic_scroll_area)</span><br><span class="line">        window_v_layout.addWidget(self.btn_scroll_area)</span><br><span class="line">        self.setLayout(window_v_layout)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-2-2滚动条控件QScrollBar"><a href="#3-2-2滚动条控件QScrollBar" class="headerlink" title="3.2.2滚动条控件QScrollBar"></a>3.2.2滚动条控件QScrollBar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">笔者会隐藏掉QScrollArea自带的水平滚动条，并实例化一个新的QScrollBar对象来代替它</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.scroll_area = QScrollArea()</span><br><span class="line">        self.original_bar = self.scroll_area.horizontalScrollBar()</span><br><span class="line"></span><br><span class="line">        self.pic_label = QLabel()</span><br><span class="line">        self.pic_label.setPixmap(QPixmap(&#x27;pyqt.jpg&#x27;))</span><br><span class="line">        self.scroll_area.setWidget(self.pic_label)</span><br><span class="line"></span><br><span class="line">        self.scroll_area.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff)# 隐藏水平滚动条</span><br><span class="line">        # Qt.ScrollBarAsNeeded  滚动条在鼠标有滚动操作时才会显示（macOS和Linux系统上的默认显示模式。</span><br><span class="line">        # Qt.ScrollBarAlwaysOff 不显示滚动条</span><br><span class="line">        # Qt.ScrollBarAlwaysOn  滚动条会一直显示（windows系统上的默认显示模式）</span><br><span class="line"></span><br><span class="line">        self.scroll_bar = QScrollBar()                #实例化QScrollBar控件对象</span><br><span class="line">        self.scroll_bar.setOrientation(Qt.Horizontal) #设置水平滚动条，默认是垂直滚动条</span><br><span class="line">        self.scroll_bar.valueChanged.connect(self.move_bar) </span><br><span class="line">        self.scroll_bar.setMinimum(self.original_bar.minimum())</span><br><span class="line">        self.scroll_bar.setMaximum(self.original_bar.maximum())#实例化一个新的QScrollBar控件对象，用setOrientation(Qt.Horizontal)将它设置成水平滚动条（默认是垂直滚动条）。valuedChanged信号会在滚动条移动时发射。QScrollBar还有一个sliderMoved信号，它只有在用户使用鼠标按住并移动滚动条时才会发射，用鼠标滚轮移动时不会发射。槽函数通过value()方法获取到滚动条的值后，将其传递给了自带的滚动条original_bar。这样在移动scroll_bar时，original_bar会跟着移动（虽然看不见），图片也就会跟着移动了。自定义的scroll_bar的最大值、最小值要和原先自带的original_bar的一样，所以需要用setMinimum()和setMaximum()方法进行设置</span><br><span class="line">        # self.scroll_area.setHorizontalScrollBar(self.scroll_bar)# 3</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.scroll_area)</span><br><span class="line">        v_layout.addWidget(self.scroll_bar)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def move_bar(self):</span><br><span class="line">        value = self.scroll_bar.value()</span><br><span class="line">        self.original_bar.setValue(value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-3-1拆分窗口控件QSplitter"><a href="#3-3-1拆分窗口控件QSplitter" class="headerlink" title="3.3.1拆分窗口控件QSplitter"></a>3.3.1拆分窗口控件QSplitter</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.splitter = QSplitter()</span><br><span class="line"></span><br><span class="line">        self.text_edit1 = QTextEdit()</span><br><span class="line">        self.text_edit2 = QTextEdit()</span><br><span class="line">        self.text_edit3 = QTextEdit()</span><br><span class="line">        self.text_edit1.setPlaceholderText(&#x27;edit 1&#x27;)</span><br><span class="line">        self.text_edit2.setPlaceholderText(&#x27;edit 2&#x27;)</span><br><span class="line">        self.text_edit3.setPlaceholderText(&#x27;edit 3&#x27;)</span><br><span class="line"></span><br><span class="line">        self.splitter.addWidget(self.text_edit1)       </span><br><span class="line">        self.splitter.insertWidget(0, self.text_edit2) #需要指定插入位置的索引0</span><br><span class="line">        self.splitter.addWidget(self.text_edit3)</span><br><span class="line">        self.splitter.setSizes([300, 200, 100])        # 列表中元素为各个控件宽度，没有设宽度的控件则不显示</span><br><span class="line">        self.splitter.setOpaqueResize(False)           # False：拖拽动作防守后控件大小才改变  True：控件大小实时改变</span><br><span class="line">        self.splitter.setOrientation(Qt.Vertical)      #垂直布局各个控件</span><br><span class="line">        </span><br><span class="line">        window_h_layout = QHBoxLayout()</span><br><span class="line">        window_h_layout.addWidget(self.splitter)</span><br><span class="line">        self.setLayout(window_h_layout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-3-2-标签页控件QTabWidget"><a href="#3-3-2-标签页控件QTabWidget" class="headerlink" title="3.3.2 标签页控件QTabWidget"></a>3.3.2 标签页控件QTabWidget</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">QTabWidget用来分页显示内容，它上面有一些标签。用户每单击一个标签就能够显示一个选项卡，</span><br><span class="line">这样多个选项卡就可以共享一块区域，可以节省很多空间</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.tab_widget = QTabWidget()</span><br><span class="line"></span><br><span class="line">        self.text_edit1 = QTextEdit()</span><br><span class="line">        self.text_edit2 = QTextEdit()</span><br><span class="line">        self.text_edit3 = QTextEdit()</span><br><span class="line">        self.text_edit1.setPlaceholderText(&#x27;edit 1&#x27;)</span><br><span class="line">        self.text_edit2.setPlaceholderText(&#x27;edit 2&#x27;)</span><br><span class="line">        self.text_edit3.setPlaceholderText(&#x27;edit 3&#x27;)</span><br><span class="line"></span><br><span class="line">        self.tab_widget.addTab(self.text_edit1, &#x27;edit 1&#x27;)    #(控件，选项卡文本)</span><br><span class="line">        self.tab_widget.insertTab(0, self.text_edit2, &#x27;edit 2&#x27;)#（索引，控件，选项卡文本）</span><br><span class="line">        self.tab_widget.addTab(self.text_edit3, QIcon(&#x27;edit.png&#x27;), &#x27;edit 3&#x27;)    #(控件，图标，选项卡文本)</span><br><span class="line">                                                             </span><br><span class="line">        self.tab_widget.currentChanged.connect(self.show_tab_name)</span><br><span class="line">        self.tab_widget.setTabShape(QTabWidget.Triangular)   # 设置选项卡形状，</span><br><span class="line">        # QTabWidget.Rounded     圆角（默认形状）</span><br><span class="line">        # QTabWidget.Triangular  三角</span><br><span class="line">        self.tab_widget.setTabPosition(QTabWidget.South)#设置选项卡位置，无这行代码则默认选项卡在上方</span><br><span class="line">        # QTabWidget.North 选项卡在窗口上方</span><br><span class="line">        # QTabWidget.West  选项卡在窗口左方</span><br><span class="line">        # QTabWidget.East  选项卡在窗口右方</span><br><span class="line">        # QTabWidget.South 选项卡在窗口下方</span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.tab_widget)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_tab_name(self):</span><br><span class="line">        index = self.tab_widget.currentIndex()#获取当前选项卡的索引</span><br><span class="line">        print(self.tab_widget.tabText(index))</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-3-3-堆栈控件QStackedWidget"><a href="#3-3-3-堆栈控件QStackedWidget" class="headerlink" title="3.3.3 堆栈控件QStackedWidget"></a>3.3.3 堆栈控件QStackedWidget</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">堆栈控件和标签页控件相似，可以让多个界面共享同一块区域，不同的是，</span><br><span class="line">堆栈控件不提供选项卡，而是将各个界面按照层级顺序上下摆放的。</span><br><span class="line">QStackedWidget通常需要搭配其他控件来实现切换效果</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.stacked_widget = QStackedWidget()</span><br><span class="line"></span><br><span class="line">        self.text_edit1 = QTextEdit()</span><br><span class="line">        self.text_edit2 = QTextEdit()</span><br><span class="line">        self.text_edit3 = QTextEdit()</span><br><span class="line">        self.text_edit1.setPlaceholderText(&#x27;edit 1&#x27;)</span><br><span class="line">        self.text_edit2.setPlaceholderText(&#x27;edit 2&#x27;)</span><br><span class="line">        self.text_edit3.setPlaceholderText(&#x27;edit 3&#x27;)</span><br><span class="line"></span><br><span class="line">        self.stacked_widget.addWidget(self.text_edit1) #注释1， QStackedWidget同样用addWidget()和insertWidget()添加控件</span><br><span class="line">        self.stacked_widget.insertWidget(0, self.text_edit2)</span><br><span class="line">        self.stacked_widget.addWidget(self.text_edit3) #注释1结束</span><br><span class="line">        self.stacked_widget.currentChanged.connect(self.show_text)# 2</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;show edit 1&#x27;)         #注释3开始</span><br><span class="line">        self.btn2 = QPushButton(&#x27;show edit 2&#x27;)</span><br><span class="line">        self.btn3 = QPushButton(&#x27;show edit 3&#x27;)</span><br><span class="line">        self.btn1.clicked.connect(self.change_edit)</span><br><span class="line">        self.btn2.clicked.connect(self.change_edit)</span><br><span class="line">        self.btn3.clicked.connect(self.change_edit)    #注释3结束</span><br><span class="line"></span><br><span class="line">        btn_h_layout = QHBoxLayout()</span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        btn_h_layout.addWidget(self.btn1)</span><br><span class="line">        btn_h_layout.addWidget(self.btn2)</span><br><span class="line">        btn_h_layout.addWidget(self.btn3)</span><br><span class="line">        window_v_layout.addLayout(btn_h_layout)</span><br><span class="line">        window_v_layout.addWidget(self.stacked_widget)</span><br><span class="line">        self.setLayout(window_v_layout)</span><br><span class="line"></span><br><span class="line">    def show_text(self):</span><br><span class="line">        edit = self.stacked_widget.currentWidget()</span><br><span class="line">        print(edit.placeholderText())  #打印占位符</span><br><span class="line"></span><br><span class="line">    def change_edit(self):</span><br><span class="line">        btn = self.sender()</span><br><span class="line">        if btn.text() == &#x27;show edit 1&#x27;:</span><br><span class="line">            self.stacked_widget.setCurrentIndex(1)</span><br><span class="line">        elif btn.text() == &#x27;show edit 2&#x27;:</span><br><span class="line">            self.stacked_widget.setCurrentIndex(0)</span><br><span class="line">        else:</span><br><span class="line">            self.stacked_widget.setCurrentIndex(2)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-3-4-多文档区域控件QMdiArea"><a href="#3-3-4-多文档区域控件QMdiArea" class="headerlink" title="3.3.4 多文档区域控件QMdiArea"></a>3.3.4 多文档区域控件QMdiArea</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">多文档区域控件QMdiArea(Multi-document Interface，MDI)提供了一块可以显示多个窗口的区域。</span><br><span class="line">区域上的每一个窗口都属于QMdiSubWindow类，我们可以在各个窗口上设置各种控件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.mdi_area = QMdiArea()                         #实例化了一个多文档区域控件对象和4个按钮控件对象</span><br><span class="line"></span><br><span class="line">        self.new_btn = QPushButton(&#x27;新建窗口&#x27;)</span><br><span class="line">        self.close_btn = QPushButton(&#x27;关闭全部&#x27;)</span><br><span class="line">        self.tile_btn = QPushButton(&#x27;平铺布局&#x27;)</span><br><span class="line">        self.cascade_btn = QPushButton(&#x27;层叠布局&#x27;)          #注释1结束</span><br><span class="line">        self.new_btn.clicked.connect(self.add_new_edit)    # 2</span><br><span class="line">        self.close_btn.clicked.connect(self.close_all)         # 3</span><br><span class="line">        self.tile_btn.clicked.connect(self.mdi_area.tileSubWindows)#注释4开始</span><br><span class="line">        self.cascade_btn.clicked.connect(self.mdi_area.cascadeSubWindows)#注释4结束</span><br><span class="line">        #多文档区域中的窗口有两种布局方式：</span><br><span class="line">        #  一种是平铺布局，窗口就像瓦片一样铺满整个区域，可以用tileSubWindows()方法实现；</span><br><span class="line">        #  另一种是层叠布局，一个窗口放在另一个窗口上，有遮挡关系，可以用cascadeSubWindows()方法实现。</span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.new_btn)</span><br><span class="line">        v_layout.addWidget(self.close_btn)</span><br><span class="line">        v_layout.addWidget(self.cascade_btn)</span><br><span class="line">        v_layout.addWidget(self.tile_btn)</span><br><span class="line">        v_layout.addWidget(self.mdi_area)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def add_new_edit(self):</span><br><span class="line">        new_edit = QTextEdit()</span><br><span class="line">        sub_window = QMdiSubWindow()</span><br><span class="line">        sub_window.setWidget(new_edit)</span><br><span class="line">        self.mdi_area.addSubWindow(sub_window)</span><br><span class="line">        sub_window.show()</span><br><span class="line"></span><br><span class="line">    def close_all(self):</span><br><span class="line">        self.mdi_area.closeAllSubWindows()  #该方法只是关闭窗口而已，窗口对象还是占内存的，所以要用deleterLater()方法将其彻底销毁</span><br><span class="line">        all_windows = self.mdi_area.subWindowList()</span><br><span class="line">        for window in all_windows:</span><br><span class="line">            window.deleteLater()</span><br><span class="line">            #QMdiArea区域中的所有窗口可以通过subWindowList()获取，该方法返回一个列表，其中的窗口元素默认按照创建时间排序</span><br><span class="line">            </span><br><span class="line">            #QMdiArea.CreationOrder 按照创建时间排序(默认排序方式)</span><br><span class="line">            #QMdiAreaStackingOrder  按照堆叠方式排序，最前面的窗口排在列表最后一位</span><br><span class="line">            #QMdiArea.ActivationHistoryOrder 按照历史激活时间排序</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-4-列表视图控件、树形视图控件、表格视图控件"><a href="#3-4-列表视图控件、树形视图控件、表格视图控件" class="headerlink" title="3.4 列表视图控件、树形视图控件、表格视图控件"></a>3.4 列表视图控件、树形视图控件、表格视图控件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#PyQt的MVC结构。M表示模型(Model)，跟数据定义和处理有关的东西全部由该部分完成。</span><br><span class="line">#V表示视图(View)，用来渲染、呈现数据。C表示控制器(Controller)，这部分由代理（Delegate，也可以叫作委托）完成，它用来调节数据在视图上的呈现方式，可以实现更高级的功能</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#数据模型</span><br><span class="line"></span><br><span class="line"># QStringListModel    存储一个字符串列表</span><br><span class="line"># QStandardltemModel  存储QStandardltem类型的数据，可以将QStandardltem看成一只小蜂·小蜜蜂可能带有花(有数据)，也可能没有·而QStandardltemModel就是蜂巢，是各个小蜜蜂集合工作的场所</span><br><span class="line"># QFileSystemModel    操作文本文件系统·以前用的是QDirModel，它已经被淘太了，建议用QFileSystemModel来代替</span><br><span class="line"># QSqlQueryModel      操作SQL语句</span><br><span class="line"># QSqlTableModel      操作SQL表</span><br><span class="line"># QSqlRelationalTableModel 和QSqlTableModel-样用来操作SQL表，不过该模型还供外键支持</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-4-1-列表视图控件QListView"><a href="#3-4-1-列表视图控件QListView" class="headerlink" title="3.4.1 列表视图控件QListView"></a>3.4.1 列表视图控件QListView</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">QListView将存储在模型中的数据以列表形式呈现出来，列表中的各项内容一行行从上往下进行排列。</span><br><span class="line">在示例代码3-10中，我们将学习如何使用QListView以及它常用的模型QStringListModel。</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.left_model = QStringListModel()               #注释1开始</span><br><span class="line">        self.right_model = QStringListModel()              #注释1结束</span><br><span class="line"></span><br><span class="line">        self.left_list = [f&#x27;item &#123;i&#125;&#x27; for i in range(20)]  #注释2开始</span><br><span class="line">        self.left_model.setStringList(self.left_list)      #只有left_model通过setStringList()方法设置了数据，所以刚开始只有左边的视图有数据显示</span><br><span class="line"></span><br><span class="line">        self.left_list_view = QListView()</span><br><span class="line">        self.right_list_view = QListView()</span><br><span class="line">        self.left_list_view.setModel(self.left_model)</span><br><span class="line">        self.left_list_view.setEditTriggers(QAbstractItemView.SelectedClicked) #左、右两个视图设置列表各项内容的编辑属性</span><br><span class="line">        # QAbstractltemView.NoEditTriggers   不可编辑</span><br><span class="line">        # QAbstractltemView.CurrentChanged   选中项发生变换时可进行编辑</span><br><span class="line">        # QAbstractltemView.DoubleClicked    双击可进行编辑</span><br><span class="line">        # QAbstractltemView.SelectedClicked  单击已选中项时可进行编辑</span><br><span class="line">        # QAbstractltemView.EditKeyPressed   在选中项上按Enter键后可进行编辑</span><br><span class="line">        # OAbstractltemView.AnyKeyPressed    在选中项上按任何键后可进行编辑</span><br><span class="line">        # QAbstractltemView.AllEditTriggers  任何情况下都可进行编辑</span><br><span class="line"></span><br><span class="line">        self.left_list_view.doubleClicked.connect(self.choose)   # 如果双击发生在左边的视图上，被双击项的内容就会显示到右边的视图上；而如果双击发生在右边的视图上，就会删除被双击项。</span><br><span class="line">        self.right_list_view.setModel(self.right_model)</span><br><span class="line">        self.right_list_view.setEditTriggers(QAbstractItemView.NoEditTriggers)</span><br><span class="line">        self.right_list_view.doubleClicked.connect(self.cancel)</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.left_list_view)</span><br><span class="line">        h_layout.addWidget(self.right_list_view)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def choose(self):                         #  QModelIndex就是货架上贴着的商品标签，该标签记录着商品所在的行列位置以及其他的商品信息</span><br><span class="line">        index = self.left_list_view.currentIndex() #获取用户当前双击项的QModelIndex索引对象</span><br><span class="line">        data = index.data()</span><br><span class="line"></span><br><span class="line">        row_count = self.right_model.rowCount() #计算行数</span><br><span class="line">        self.right_model.insertRow(row_count)</span><br><span class="line">        row_index = self.right_model.index(row_count) #用index()获取到该行的QModelIndex索引对象</span><br><span class="line">        self.right_model.setData(row_index, data)</span><br><span class="line"></span><br><span class="line">    def cancel(self):                         # 5</span><br><span class="line">        index = self.right_list_view.currentIndex()  #获取到QModelIndex索引对象</span><br><span class="line">        row_numer = index.row()                      #通过它获取到行号</span><br><span class="line">        self.right_model.removeRow(row_numer)        #再调用removeRow()删除对应的行</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-4-2-树形视图控件QTreeVie"><a href="#3-4-2-树形视图控件QTreeVie" class="headerlink" title="3.4.2 树形视图控件QTreeVie"></a>3.4.2 树形视图控件QTreeVie</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">相较于QListView，QTreeView适合用来呈现有层级关系的数据，比如用来呈现某路径下的各个文件和目录。</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.model = QFileSystemModel()    #注释1开始</span><br><span class="line">        self.model.setRootPath(&#x27;.&#x27;)        #确定目标路径，树形视图显示该路径下的文件和目录</span><br><span class="line">        self.model.setReadOnly(True)       #调用setReadOnly(False)方法后，我们就可以通过双击来进行重命名操作了。</span><br><span class="line"></span><br><span class="line">        self.tree_view = QTreeView()       #用来给路径展开和收缩操作添加动画</span><br><span class="line">        self.tree_view.setModel(self.model)#用来给路径展开和收缩操作添加动画</span><br><span class="line">        self.tree_view.setAnimated(True)   #用来给路径展开和收缩操作添加动画</span><br><span class="line">        self.tree_view.header().setStretchLastSection(True) #header()方法获取树形视图的标题栏，setStretchLastSection(True)方法让标题栏的最后一列拉伸至充满表格</span><br><span class="line">        # setHeaderHidden(True)  隐藏标题栏</span><br><span class="line">        self.tree_view.doubleClicked.connect(self.show_info)# 3</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.tree_view)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_info(self):</span><br><span class="line">        index = self.tree_view.currentIndex()  </span><br><span class="line">        self.tree_view.scrollTo(index)         #scrollTo()用来将滚动条移动到文件或目录的位置，确保它能够显示出来</span><br><span class="line">        self.tree_view.expand(index)           #如果单击的是目录，使用expand()方法就会展开它</span><br><span class="line"></span><br><span class="line">        file_name = self.model.fileName(index) #名称</span><br><span class="line">        file_path = self.model.filePath(index) #路径</span><br><span class="line">        file_size = self.model.size(index)     #大小</span><br><span class="line">        print(file_name, file_path, file_size)</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-4-3-表格视图控件QTableView"><a href="#3-4-3-表格视图控件QTableView" class="headerlink" title="3.4.3 表格视图控件QTableView"></a>3.4.3 表格视图控件QTableView</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">QTableView是一个使用频率非常高的控件，它以表格形式呈现内容，通常和QStandardItemModel搭配使用。</span><br><span class="line">我们可以在QStandardItemModel模型上设置行列数，并在特定行列位置上添加QStandardItem对象，该对象中包含目标数据。</span><br><span class="line">表格视图会根据QStandardItemModel的属性生成同等行列数的表格来显示数据</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.model = QStandardItemModel()   #注释1开始</span><br><span class="line">        self.model.setColumnCount(6) #设置行数和列数</span><br><span class="line">        self.model.setRowCount(6)</span><br><span class="line">        self.model.setHorizontalHeaderLabels([&#x27;第1列&#x27;, &#x27;第2列&#x27;, &#x27;第3列&#x27;,&#x27;第4列&#x27;, &#x27;第5列&#x27;, &#x27;第6列&#x27;])#注释1结束</span><br><span class="line">                  #setVerticalHeaderLabels() 行标题栏文本</span><br><span class="line">        for row in range(6):       #注释2开始</span><br><span class="line">            for column in range(6):</span><br><span class="line">                item = QStandardItem(f&#x27;(&#123;row&#125;, &#123;column&#125;)&#x27;)</span><br><span class="line">                item.setTextAlignment(Qt.AlignCenter) #数据在表格的单元格中居中显示</span><br><span class="line">                self.model.setItem(row, column, item)</span><br><span class="line"></span><br><span class="line">        self.new_items = [QStandardItem(f&#x27;(6, &#123;column&#125;)&#x27;) for column in range(6)]</span><br><span class="line">        self.model.appendRow(self.new_items)#  接受一个QStandardItem对象列表，调用该方法会在表格末尾新增一行，</span><br><span class="line">        #如果要新增一列，则要调用appendColumn()</span><br><span class="line"></span><br><span class="line">        self.table = QTableView()           #表格视图有水平和垂直两种标题栏，分别可用verticalHeader()和horizontalHeader()方法获取到</span><br><span class="line">        self.table.setModel(self.model)</span><br><span class="line">        self.table.verticalHeader().hide() #针对垂直标题栏，我们调用hide()方法将其隐藏。针对水平标题栏，我们让它的最后一列自适应拉伸，不然留出空白不好看。</span><br><span class="line">        self.table.horizontalHeader().setStretchLastSection(True)</span><br><span class="line">        self.table.setEditTriggers(QAbstractItemView.NoEditTriggers) #setEditTriggers()用来设置表格中单元格的编辑属性，这里设置为不可编辑</span><br><span class="line">        self.table.clicked.connect(self.show_cell_info) #注释3结束</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.table)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_cell_info(self):</span><br><span class="line">        index = self.table.currentIndex() #在槽函数中，我们先获取到单元格的索引对象，再调用data()方法获取到单元格上的数据</span><br><span class="line">        data = index.data()</span><br><span class="line">        print(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-5-1-简化版列表视图控件QListWidge"><a href="#3-5-1-简化版列表视图控件QListWidge" class="headerlink" title="3.5.1 简化版列表视图控件QListWidge"></a>3.5.1 简化版列表视图控件QListWidge</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.left_list_widget = QListWidget()  #注释1开始</span><br><span class="line">        self.right_list_widget = QListWidget()</span><br><span class="line">        self.left_list_widget.doubleClicked.connect(self.choose)</span><br><span class="line">        self.right_list_widget.doubleClicked.connect(self.cancel)</span><br><span class="line">        self.left_list_widget.setEditTriggers(QAbstractItemView.NoEditTriggers)</span><br><span class="line">        self.right_list_widget.setEditTriggers(QAbstractItemView.NoEditTriggers)#注释1结束</span><br><span class="line"></span><br><span class="line">        for i in range(20):        #注释2开始</span><br><span class="line">            item = QListWidgetItem(f&#x27;item &#123;i&#125;&#x27;)</span><br><span class="line">            self.left_list_widget.addItem(item)#注释2结束</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.left_list_widget)</span><br><span class="line">        h_layout.addWidget(self.right_list_widget)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def choose(self):              # 3</span><br><span class="line">        item = self.left_list_widget.currentItem()</span><br><span class="line">        new_item = QListWidgetItem(item)</span><br><span class="line">        self.right_list_widget.addItem(new_item)</span><br><span class="line"></span><br><span class="line">    def cancel(self):              # 4</span><br><span class="line">        row = self.right_list_widget.currentRow()</span><br><span class="line">        self.right_list_widget.takeItem(row)</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-5-2-简化版树形视图控件QTreeWidget"><a href="#3-5-2-简化版树形视图控件QTreeWidget" class="headerlink" title="3.5.2 简化版树形视图控件QTreeWidget"></a>3.5.2 简化版树形视图控件QTreeWidget</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.tree = QTreeWidget()</span><br><span class="line">        self.item1 = QTreeWidgetItem()             #注释1开始</span><br><span class="line">        self.item2 = QTreeWidgetItem()</span><br><span class="line">        self.item3 = QTreeWidgetItem()</span><br><span class="line">        self.item1.setText(0, &#x27;第1章&#x27;)</span><br><span class="line">        self.item2.setText(0, &#x27;第1节&#x27;)</span><br><span class="line">        self.item3.setText(0, &#x27;第1段&#x27;)             #注释1结束</span><br><span class="line">        self.item1.setCheckState(0, Qt.Unchecked)  #注 如果一个项调用了setCheckState()方法，那么它前面就会显示一个复选框</span><br><span class="line">        self.item2.setCheckState(0, Qt.Unchecked)</span><br><span class="line">        self.item3.setCheckState(0, Qt.Unchecked)  #注释2结束</span><br><span class="line">        self.item1.addChild(self.item2)            #添加2是1的子类</span><br><span class="line">        self.item2.addChild(self.item3)</span><br><span class="line"></span><br><span class="line">        self.tree.addTopLevelItem(self.item1) #将最顶层的父项添加到树形视图</span><br><span class="line">        self.tree.setHeaderLabel(&#x27;PyQt教程&#x27;)  #setHeaderLabel()用来设置树形视图的标题栏，如果标题栏存在多列，则可以调用setHeaderLabels()方法。</span><br><span class="line">        self.tree.clicked.connect(self.click_slot) #注释3结束</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.tree)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def click_slot(self):                          # 4</span><br><span class="line">        item = self.tree.currentItem() #获取当前单击的项</span><br><span class="line">        print(item.text(0))            #调用text()获取项上的文本</span><br><span class="line"></span><br><span class="line">        if item == self.item1:</span><br><span class="line">            if self.item1.checkState(0) == Qt.Checked:</span><br><span class="line">                self.item2.setCheckState(0, Qt.Checked)</span><br><span class="line">                self.item3.setCheckState(0, Qt.Checked)</span><br><span class="line">            else:</span><br><span class="line">                self.item2.setCheckState(0, Qt.Unchecked)</span><br><span class="line">                self.item3.setCheckState(0, Qt.Unchecked)</span><br><span class="line">        # click_slot()槽函数通过currentItem()方法获取到当前单击的项，然后调用text()获取项上的文本，记得要传入列号。</span><br><span class="line">        # if逻辑判断下的代码实现了全选/全不选的效果，如果用户勾选了最顶层父项左边的复选框，那么子项的复选框也会一并被勾选；</span><br><span class="line">        # 反之，则全部取消勾选。</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-5-3-简化版表格视图控件QTableWidget"><a href="#3-5-3-简化版表格视图控件QTableWidget" class="headerlink" title="3.5.3 简化版表格视图控件QTableWidget"></a>3.5.3 简化版表格视图控件QTableWidget</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.table = QTableWidget()    #注释1开始</span><br><span class="line">        self.table.setColumnCount(6)</span><br><span class="line">        self.table.setRowCount(6)</span><br><span class="line">        self.table.verticalHeader().hide()</span><br><span class="line">        self.table.clicked.connect(self.show_cell_info)</span><br><span class="line">        self.table.horizontalHeader().setStretchLastSection(True)</span><br><span class="line">        self.table.setEditTriggers(QAbstractItemView.NoEditTriggers)</span><br><span class="line">        self.table.setHorizontalHeaderLabels([&#x27;第1列&#x27;, &#x27;第2列&#x27;, &#x27;第3列&#x27;,&#x27;第4列&#x27;, &#x27;第5列&#x27;, &#x27;第6列&#x27;])#注释1结束</span><br><span class="line">        for row in range(6):</span><br><span class="line">            for column in range(6):</span><br><span class="line">                item = QTableWidgetItem(f&#x27;(&#123;row&#125;, &#123;column&#125;)&#x27;)#注释2开始</span><br><span class="line">                item.setTextAlignment(Qt.AlignCenter)</span><br><span class="line">                self.table.setItem(row, column, item)        #注释2结束</span><br><span class="line"></span><br><span class="line">        row_count = self.table.rowCount()                    #获取行数</span><br><span class="line">        self.table.setRowCount(row_count+1)                  #设置总行数</span><br><span class="line">        for column in range(6):</span><br><span class="line">            self.table.setItem(6, column, QTableWidgetItem(f&#x27;(6, &#123;column&#125;)&#x27;))</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.table)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">    def show_cell_info(self):  # 4</span><br><span class="line">        item = self.table.currentItem()</span><br><span class="line">        print(item.text())</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="3-6-1-颜色对话框控件QColorDialog"><a href="#3-6-1-颜色对话框控件QColorDialog" class="headerlink" title="3.6.1 颜色对话框控件QColorDialog"></a>3.6.1 颜色对话框控件QColorDialog</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">颜色对话框控件用来让用户选择颜色，选择完毕后颜色就会被设置在目标内容（比如文本、背景等）上</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.text_edit = QTextEdit()</span><br><span class="line">        self.btn = QPushButton(&#x27;显示颜色对话框&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.set_color)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.text_edit)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def set_color(self):   # QColorDialog调用getColor()方法弹出颜色对话框，返回的值是QColor类型的</span><br><span class="line">        color = QColorDialog.getColor()</span><br><span class="line">        if color.isValid():</span><br><span class="line">            print(color.name())</span><br><span class="line">            print(color.red(), color.green(), color.blue())</span><br><span class="line">            self.text_edit.setTextColor(color)</span><br><span class="line">            # 在将颜色设置到文本编辑框之前，需要先调用isValid()方法判断用户是否选择了颜色，</span><br><span class="line">            # 如果没有选择，而是单击“关闭”按钮或“Cancel”按钮，那么isValid()就会返回False。</span><br><span class="line">            # name()方法用于获取颜色的名称，格式是“#RRGGBB”。red()、green()和blue()分别用来获取红、绿、蓝3个颜色通道的值。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-6-2-字体对话框控件QFontDialog"><a href="#3-6-2-字体对话框控件QFontDialog" class="headerlink" title="3.6.2 字体对话框控件QFontDialog"></a>3.6.2 字体对话框控件QFontDialog</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.text_edit = QTextEdit()</span><br><span class="line">        self.btn = QPushButton(&#x27;显示字体对话框&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.set_font)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.text_edit)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def set_font(self):   # </span><br><span class="line">        font, is_ok = QFontDialog.getFont()  #  QFontDialog调用getFont()方法弹出字体对话框</span><br><span class="line">        if is_ok:                            #  返回元组，元组中的第一个元素是QFont类型的，第二个元素是布尔类型的</span><br><span class="line">            print(font.family())</span><br><span class="line">            print(font.pointSize())</span><br><span class="line">            self.text_edit.setFont(font)     #  如果值为True，表明用户选择了一种字体，如果没有选择，而是单击“关闭”按钮或“Cancel”按钮，那么is_ok的值就是False。</span><br><span class="line">            #  family()和pointSize()方法分别用来返回字体的名称和大小</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-6-3-输入对话框控件QInputDialog"><a href="#3-6-3-输入对话框控件QInputDialog" class="headerlink" title="3.6.3 输入对话框控件QInputDialog"></a>3.6.3 输入对话框控件QInputDialog</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.name_line_edit = QLineEdit()      #注释1开始</span><br><span class="line">        self.gender_line_edit = QLineEdit()</span><br><span class="line">        self.age_line_edit = QLineEdit()</span><br><span class="line">        self.score_line_edit = QLineEdit()</span><br><span class="line">        self.note_text_edit = QTextEdit()</span><br><span class="line"></span><br><span class="line">        self.name_btn = QPushButton(&#x27;姓名&#x27;)</span><br><span class="line">        self.gender_btn = QPushButton(&#x27;性别&#x27;)</span><br><span class="line">        self.age_btn = QPushButton(&#x27;年龄&#x27;)</span><br><span class="line">        self.score_btn = QPushButton(&#x27;分数&#x27;)</span><br><span class="line">        self.note_btn = QPushButton(&#x27;备注&#x27;)     #注释1结束</span><br><span class="line">        self.name_btn.clicked.connect(self.get_name)</span><br><span class="line">        self.gender_btn.clicked.connect(self.get_gender)</span><br><span class="line">        self.age_btn.clicked.connect(self.get_age)</span><br><span class="line">        self.score_btn.clicked.connect(self.get_score)</span><br><span class="line">        self.note_btn.clicked.connect(self.get_note)</span><br><span class="line"></span><br><span class="line">        g_layout = QGridLayout()</span><br><span class="line">        g_layout.addWidget(self.name_btn, 0, 0)</span><br><span class="line">        g_layout.addWidget(self.name_line_edit, 0, 1)</span><br><span class="line">        g_layout.addWidget(self.gender_btn, 1, 0)</span><br><span class="line">        g_layout.addWidget(self.gender_line_edit, 1, 1)</span><br><span class="line">        g_layout.addWidget(self.age_btn, 2, 0)</span><br><span class="line">        g_layout.addWidget(self.age_line_edit, 2, 1)</span><br><span class="line">        g_layout.addWidget(self.score_btn, 3, 0)</span><br><span class="line">        g_layout.addWidget(self.score_line_edit, 3, 1)</span><br><span class="line">        g_layout.addWidget(self.note_btn, 4, 0)</span><br><span class="line">        g_layout.addWidget(self.note_text_edit, 4, 1)</span><br><span class="line">        self.setLayout(g_layout)</span><br><span class="line"></span><br><span class="line">    def get_name(self):    # 2</span><br><span class="line">        name, is_ok = QInputDialog.getText(self, &#x27;姓名&#x27;, &#x27;请输入姓名&#x27;)</span><br><span class="line">        if is_ok:</span><br><span class="line">            self.name_line_edit.setText(name)</span><br><span class="line"></span><br><span class="line">    def get_gender(self):  # 传入一个列表作为下拉列表框的内容选项</span><br><span class="line">        gender_list = [&#x27;Female&#x27;, &#x27;Male&#x27;]</span><br><span class="line">        gender, is_ok = QInputDialog.getItem(self, &#x27;性别&#x27;, &#x27;请选择性别&#x27;,gender_list , 1 ,True) </span><br><span class="line">        # 数值1表示最初显示下拉列表框中索引为1的选项，也就是&#x27;Male&#x27;。False表示下拉列表框中的选项不可被编辑。</span><br><span class="line">        if is_ok:</span><br><span class="line">            self.gender_line_edit.setText(gender)</span><br><span class="line"></span><br><span class="line">    def get_age(self):   </span><br><span class="line">        age, is_ok = QInputDialog.getInt(self, &#x27;年龄&#x27;, &#x27;请输入年龄&#x27;, 18 ,0 ,120 )</span><br><span class="line">        # 数值18是初始值，0是最小值，120是最大值。</span><br><span class="line">        if is_ok:</span><br><span class="line">            self.age_line_edit.setText(str(age))</span><br><span class="line"></span><br><span class="line">    def get_score(self):  # 5</span><br><span class="line">        score, is_ok = QInputDialog.getDouble(self, &#x27;分数&#x27;, &#x27;请输入分数&#x27;)</span><br><span class="line">        # getDouble()方法也可以设置当前值、最小值和最大值，不过需要传入浮点数。</span><br><span class="line">        if is_ok:</span><br><span class="line">            self.score_line_edit.setText(str(score))</span><br><span class="line"></span><br><span class="line">    def get_note(self):</span><br><span class="line">        note, is_ok = QInputDialog.getMultiLineText(self, &#x27;备注&#x27;, &#x27;请输入备注&#x27;)</span><br><span class="line">        if is_ok:</span><br><span class="line">            self.note_text_edit.setText(note)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="3-6-4-文件对话框控件QFileDialog"><a href="#3-6-4-文件对话框控件QFileDialog" class="headerlink" title="3.6.4 文件对话框控件QFileDialog"></a>3.6.4 文件对话框控件QFileDialog</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">文件对话框控件可以帮助我们快速实现打开文件和保存文件的功能，一般桌面应用都会用到文件对话框控件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.open_folder_btn = QPushButton(&#x27;打开文件夹&#x27;)</span><br><span class="line">        self.open_file_btn = QPushButton(&#x27;打开文件&#x27;)</span><br><span class="line">        self.save_as_btn = QPushButton(&#x27;另存为&#x27;)</span><br><span class="line">        self.open_folder_btn.clicked.connect(self.open_folder)</span><br><span class="line">        self.open_file_btn.clicked.connect(self.open_file)</span><br><span class="line">        self.save_as_btn.clicked.connect(self.save_as)</span><br><span class="line"></span><br><span class="line">        btn_h_layout = QHBoxLayout()</span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        btn_h_layout.addWidget(self.open_folder_btn)</span><br><span class="line">        btn_h_layout.addWidget(self.open_file_btn)</span><br><span class="line">        btn_h_layout.addWidget(self.save_as_btn)</span><br><span class="line">        window_v_layout.addWidget(self.edit)</span><br><span class="line">        window_v_layout.addLayout(btn_h_layout)</span><br><span class="line">        self.setLayout(window_v_layout)</span><br><span class="line"></span><br><span class="line">    def open_folder(self):   # 用来选择一个文件夹，返回值是文件夹路径</span><br><span class="line">        folder_path = QFileDialog.getExistingDirectory(self, &#x27;打开文件夹&#x27;, &#x27;./&#x27;)</span><br><span class="line">        self.edit.setText(folder_path)</span><br><span class="line"></span><br><span class="line">    def open_file(self):     # 2</span><br><span class="line">        file_path, filter = QFileDialog.getOpenFileName(self, &#x27;打开文件&#x27;, &#x27;./&#x27;, &#x27;格式 (*.txt *.log)&#x27;)# 用来选择单个文件，我们可以往该方法中传入一个过滤器。</span><br><span class="line">        if file_path:  # 用户无法选择被过滤掉的文件。“格式 (*.txt *.log)”表示用户只能在对话框中选择.txt和.log格式的文件。</span><br><span class="line">            with open(file_path, &#x27;r&#x27;) as f:  # 如果要设置多个过滤器，可以用“;;”来进行连接，比如：“格式 (*.txt *.log);;Images (*.png *.jpg)”。</span><br><span class="line">                self.edit.setText(f.read())</span><br><span class="line">                # getOpenFileName()方法的返回值是一个元组，它的第一个元素是用户选择的文件路径，第二个元素是过滤器。</span><br><span class="line">                # 如果要打开多个文件，可以使用getOpenFileNames()。</span><br><span class="line">                </span><br><span class="line">    def save_as(self):     # 3</span><br><span class="line">        save_path, filter = QFileDialog.getSaveFileName(self, &#x27;另存为&#x27;, &#x27;./&#x27;,&#x27;格式 (*.txt *.log)&#x27;)</span><br><span class="line">        if save_path:</span><br><span class="line">            with open(save_path, &#x27;w&#x27;) as f:</span><br><span class="line">                f.write(self.edit.toPlainText())</span><br><span class="line">                # getSaveFileName()方法用来获取用户设置的文件保存路径，传入的过滤器“格式 (*.txt *.log)”表示用户只能将文件保存为.txt和.log格式。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="第4章-深入窗口"><a href="#第4章-深入窗口" class="headerlink" title="第4章　深入窗口"></a>第4章　深入窗口</h2><p>在之前的章节中，所有的窗口都是基于QWidget类的。其实在PyQt中，任何一个控件都可以看作一个窗口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QLineEdit):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;)</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-1-1-窗口标题和图标"><a href="#4-1-1-窗口标题和图标" class="headerlink" title="4.1.1 窗口标题和图标"></a>4.1.1 窗口标题和图标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.setWindowTitle(&#x27;我的软件&#x27;)         # 设置窗口标题</span><br><span class="line">        self.setWindowIcon(QIcon(&#x27;code.png&#x27;))  # 设置窗口图标，传入的是一个Qicon对象</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-1-2-窗口大小和位置-1"><a href="#4-1-2-窗口大小和位置-1" class="headerlink" title="4.1.2 窗口大小和位置-1"></a>4.1.2 窗口大小和位置-1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(600, 400)      # 传入宽度值和高度值就可以设置窗口的初始显示大小</span><br><span class="line">        self.move(0, 0)            # 坐标(0, 0)表示窗口显示在计算机桌面左上角</span><br><span class="line">        self.setGeometry(0, 0, 600, 400) # resize()和move()方法合并后等效于setGeometry()</span><br><span class="line">        # setMinimumwidth() 设置最小宽度</span><br><span class="line">        # setMaximumWidth() 设置最大宽度</span><br><span class="line">        # setMinimumHeight()设置最小高度</span><br><span class="line">        # setMaximumHeight()设置最大高度</span><br><span class="line">        # setMinimumSize()  设置最小尺寸</span><br><span class="line">        # setMaximumSize()  设置最大尺寸</span><br><span class="line">        # width()           宽度</span><br><span class="line">        # height()          获取高度</span><br><span class="line">        # size()            获取尺寸</span><br><span class="line">        # minimumWidth()    获取最小宽度</span><br><span class="line">        # maximumWidth()    获取最大宽度</span><br><span class="line">        # minimumHeight()   获取最小高度</span><br><span class="line">        # maximumHeight()   获取最大高度</span><br><span class="line">        # minimumSize()     获取最小尺寸</span><br><span class="line">        # maximumSize()     获取最大尺寸</span><br><span class="line">        # x()               获取x坐标</span><br><span class="line">        # y()               取y坐标</span><br><span class="line">        # pos()             获取X和y坐标，返回一个QPoin类型的对象</span><br><span class="line">        # geometry()        获取坐标和尺寸，返回一个QRec类型的对象</span><br><span class="line">        # frameSize()       获取尺寸 (包含窗口边框)</span><br><span class="line">        # frameGeometry()   获取坐标和尺寸(包含窗口边框)，返回一个QRec类型的对象</span><br><span class="line">        # setFixedSize()    窗口大小固定</span><br><span class="line">        # setFixedWidth()   固定窗口宽度</span><br><span class="line">        # setFixedHeight()  固定窗口高度</span><br><span class="line">        # setFixedSize()    窗口大小固定</span><br><span class="line">        # setFixedWidth()   固定窗口宽度</span><br><span class="line">        # setFixedHeight()  固定窗口高度</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-1-2-窗口大小和位置-2"><a href="#4-1-2-窗口大小和位置-2" class="headerlink" title="4.1.2 窗口大小和位置-2"></a>4.1.2 窗口大小和位置-2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(200, 200)                  #注释1开始</span><br><span class="line"></span><br><span class="line">        desktop = QApplication.desktop()       # 获取桌面对象desktop，通过width()和height()方法获取计算机屏幕的宽度和高度</span><br><span class="line">        desktop_width = desktop.width()</span><br><span class="line">        desktop_height = desktop.height()      #注释1结束</span><br><span class="line"></span><br><span class="line">        window_width = self.frameSize().width()#注释2开始</span><br><span class="line">        window_height = self.frameSize().height()</span><br><span class="line"></span><br><span class="line">        x = desktop_width // 2 - window_width // 2   #之所以用整除运算符“//”，是因为move()方法接收整型值，而不是浮点数。</span><br><span class="line">        y = desktop_height // 2 - window_height // 2</span><br><span class="line">        self.move(x, y)                       #注释2结束</span><br><span class="line">        # setMinimumwidth() 设置最小宽度</span><br><span class="line">        # setMaximumWidth() 设置最大宽度</span><br><span class="line">        # setMinimumHeight()设置最小高度</span><br><span class="line">        # setMaximumHeight()设置最大高度</span><br><span class="line">        # setMinimumSize()  设置最小尺寸</span><br><span class="line">        # setMaximumSize()  设置最大尺寸</span><br><span class="line">        # width()           取度</span><br><span class="line">        # height()          获取高度</span><br><span class="line">        # size()            获取尺寸</span><br><span class="line">        # minimumWidth()    获取最小宽度</span><br><span class="line">        # maximumWidth()    获取最大宽度</span><br><span class="line">        # minimumHeight()   获取最小高度</span><br><span class="line">        # maximumHeight()   获取最大高度</span><br><span class="line">        # minimumSize()     获取最小尺寸</span><br><span class="line">        # maximumSize()     获取最大尺寸</span><br><span class="line">        # x()               获取x坐标</span><br><span class="line">        # y()               取y坐标</span><br><span class="line">        # pos()             获取X和y坐标，返回一个QPoin类型的对象</span><br><span class="line">        # geometry()        获取坐标和尺寸，返回一个QRec类型的对象</span><br><span class="line">        # frameSize()       获取尺寸 (包含窗口边框)</span><br><span class="line">        # frameGeometry()   获取坐标和尺寸(包含窗口边框)，返回一个QRec类型的对象</span><br><span class="line">        # setFixedSize()    窗口大小固定</span><br><span class="line">        # setFixedWidth()   固定窗口宽度</span><br><span class="line">        # setFixedHeight()  固定窗口高度</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-1-3-其他窗口属性"><a href="#4-1-3-其他窗口属性" class="headerlink" title="4.1.3 其他窗口属性"></a>4.1.3 其他窗口属性</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.setWindowOpacity(0.8)                     # 设置窗口的透明度，传入0～1的数，1表示不透明</span><br><span class="line">        self.setWindowFlag(Qt.FramelessWindowHint)     # 将窗口的标题栏和边框都去掉</span><br><span class="line">        self.setAttribute(Qt.WA_TranslucentBackground) # 让窗口背景完全透明（不会影响到窗口上的控件）</span><br><span class="line"></span><br><span class="line">        self.another_window = AnotherWindow()</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;显示另一个窗口&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.another_window.show)</span><br><span class="line"></span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(h_layout)</span><br><span class="line"></span><br><span class="line">class AnotherWindow(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(AnotherWindow, self).__init__()</span><br><span class="line">        self.setWindowModality(Qt.ApplicationModal) # 模态类型</span><br><span class="line">        # Qt.NonModal         设置为非棋态，这是窗口的默认模态类型，表示用户可以在应用中的各个窗口之间随意切换</span><br><span class="line">        # Qt.WindowModal      窗口级棋态，  阻塞当前窗口的所有父窗口和祖父窗口，包括与父窗口和祖父窗口同级的其他窗口</span><br><span class="line">        # Qt.ApplicationModal 应用级模态，  阻除当前窗口外的所有窗口，用户只有关闭了当前窗口，才能切换到其他的窗口</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="4-2-1-理解坐标体系"><a href="#4-2-1-理解坐标体系" class="headerlink" title="4.2.1 理解坐标体系"></a>4.2.1 理解坐标体系</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PyQt的坐标体系是统一的。不管是计算机屏幕，还是窗口本身，抑或是窗口上的控件，其</span><br><span class="line">坐标原点(0, 0)都在左上角，且向右为x轴正方向，向下为y轴正方向。另外，锚点也统一位于左上角</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(400, 400)</span><br><span class="line">        self.move(0, 0)            # 窗口位于屏幕的坐标原点</span><br><span class="line"></span><br><span class="line">        self.edit = QTextEdit(self)</span><br><span class="line">        self.edit.move(0, 0)       # 文本编辑框位于窗口的坐标原点</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;, self.edit)</span><br><span class="line">        self.btn.move(20, 20)      # 按钮则位于文本编辑框上坐标为(20, 20)的位置</span><br><span class="line"></span><br><span class="line">        # width()           宽度</span><br><span class="line">        # height()          获取高度</span><br><span class="line">        # size()            获取尺寸</span><br><span class="line">        # minimumWidth()    获取最小宽度</span><br><span class="line">        # maximumWidth()    获取最大宽度</span><br><span class="line">        # minimumHeight()   获取最小高度</span><br><span class="line">        # maximumHeight()   获取最大高度</span><br><span class="line">        # minimumSize()     获取最小尺寸</span><br><span class="line">        # maximumSize()     获取最大尺寸</span><br><span class="line">        # x()               获取x坐标</span><br><span class="line">        # y()               取y坐标</span><br><span class="line">        # pos()             获取X和y坐标，返回一个QPoin类型的对象</span><br><span class="line">        # geometry()        获取坐标和尺寸，返回一个QRec类型的对象</span><br><span class="line">        # frameSize()       获取尺寸 (包含窗口边框)</span><br><span class="line">        # frameGeometry()   获取坐标和尺寸(包含窗口边框)，返回一个QRec类型的对象</span><br><span class="line">        # setFixedSize()    窗口大小固定</span><br><span class="line">        # setFixedWidth()   固定窗口宽度</span><br><span class="line">        # setFixedHeight()  固定窗口高度</span><br><span class="line">        # setFixedSize()    窗口大小固定</span><br><span class="line">        # setFixedWidth()   固定窗口宽度</span><br><span class="line">        # setFixedHeight()  固定窗口高度</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        # 窗口坐标原点并不在标题栏的左上角，而是处于放置控件区域（客户区）的左上角，但是窗口锚点在标题栏的左上角。</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="4-3-1-窗口关闭事件"><a href="#4-3-1-窗口关闭事件" class="headerlink" title="4.3.1 窗口关闭事件"></a>4.3.1 窗口关闭事件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.is_saved = True   # 用来存储当前的保存状态，如果edit文本编辑框内容有更新且文本存在，那么is_saved为False</span><br><span class="line">        #当我们单击“保存”按钮后，is_saved变量被设置为True，且项目路径下会出现一个saved.txt文件</span><br><span class="line"></span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.edit.textChanged.connect(self.update_save_status)</span><br><span class="line">        self.save_btn = QPushButton(&#x27;保存&#x27;)</span><br><span class="line">        self.save_btn.clicked.connect(self.save)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.edit)</span><br><span class="line">        v_layout.addWidget(self.save_btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def update_save_status(self):</span><br><span class="line">        if self.edit.toPlainText():</span><br><span class="line">            self.is_saved = False</span><br><span class="line">        else:</span><br><span class="line">            self.is_saved = True</span><br><span class="line"></span><br><span class="line">    def save(self):</span><br><span class="line">        self.is_saved = True</span><br><span class="line">        with open(&#x27;saved.txt&#x27;, &#x27;w&#x27;) as f:</span><br><span class="line">            f.write(self.edit.toPlainText())</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):            # 重点是closeEvent()，注意因为是重写，所以函数名称必须一样。</span><br><span class="line">        if not self.is_saved:</span><br><span class="line">            choice = QMessageBox.question(self, &#x27;&#x27;, &#x27;是否保存文本内容？&#x27;,QMessageBox.Yes | QMessageBox.No | QMessageBox.Cancel)</span><br><span class="line">        # 首先判断当前内容是否被保存，如果没有的话，则弹出一个消息框进行询问</span><br><span class="line">        if choice == QMessageBox.Yes:</span><br><span class="line">            self.save()</span><br><span class="line">            event.accept()  # 调用event.accept()接受这次关闭操作</span><br><span class="line">        elif choice == QMessageBox.No:</span><br><span class="line">            event.accept()  </span><br><span class="line">        else:</span><br><span class="line">            event.ignore()  # 调用event.ignore()忽略关闭操作</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-2-窗口大小调整事件"><a href="#4-3-2-窗口大小调整事件" class="headerlink" title="4.3.2 窗口大小调整事件"></a>4.3.2 窗口大小调整事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">    def resizeEvent(self, event):        # 1</span><br><span class="line">        print(&#x27;调整前大小:&#x27;, event.oldSize())</span><br><span class="line">        print(&#x27;调整后大小:&#x27;, event.size())</span><br><span class="line">        </span><br><span class="line"># 代码很简单，该事件主要有两个方法：oldSize()和size()。</span><br><span class="line"># 前者用来获取窗口调整前的大小，后者用来获取窗口调整后的大小，两个方法返回的都是QSize对象。</span><br><span class="line"># 窗口只要开始显示，就会触发窗口大小调整事件。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-3-键盘事件"><a href="#4-3-3-键盘事件" class="headerlink" title="4.3.3 键盘事件"></a>4.3.3 键盘事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">键盘事件分为两种：</span><br><span class="line">键盘按下事件和键盘释放事件，各个事件函数的名称和解释罗列如下。</span><br><span class="line">● keyPressEvent：键盘上的任意键被按下时触发。</span><br><span class="line">● keyReleaseEvent：键盘上的任意键被释放时触发。</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">    def keyPressEvent(self, event):     # 1</span><br><span class="line">        if event.key() == Qt.Key_A:</span><br><span class="line">            print(&#x27;a&#x27;)</span><br><span class="line">        if event.text().lower() == &#x27;b&#x27;:  # 如果要获取按键名称，则需要调用text()方法 </span><br><span class="line">            print(&#x27;b&#x27;)                   # 注意，如果开启了大写字母锁定功能，text()方法会返回大写键名</span><br><span class="line">        if event.modifiers()==Qt.ShiftModifier and event.key()==Qt.Key_Q:</span><br><span class="line">            print(&#x27;shift+q&#x27;)</span><br><span class="line">            # modifiers()方法用来获取辅助按键</span><br><span class="line">            </span><br><span class="line">            # QtNoModifier        没有按下辅助按键</span><br><span class="line">            # QtShiftModifier     Shift键</span><br><span class="line">            # Qt.ControlModifier  “Ctrl键(macoS系统上是Command键)</span><br><span class="line">            # Qt.AltModifier      “Alt键(macoS系统上是&quot;option”键)</span><br><span class="line"></span><br><span class="line">    def keyReleaseEvent(self, event):</span><br><span class="line">        print(event.key())</span><br><span class="line">        print(event.text())</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-4-鼠标事件-1"><a href="#4-3-4-鼠标事件-1" class="headerlink" title="4.3.4 鼠标事件-1"></a>4.3.4 鼠标事件-1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">鼠标事件分为鼠标按下事件、鼠标移动事件、鼠标释放事件和鼠标双击事件。</span><br><span class="line">在每个鼠标事件中我们都可以获取到鼠标指针在窗口或屏幕上的坐标。</span><br><span class="line"></span><br><span class="line">● mousePressEvent：鼠标按键被按下时触发。</span><br><span class="line">● mouseMoveEvent：鼠标指针在窗口上移动时触发（鼠标需要被追踪到）。</span><br><span class="line">● mouseReleaseEvent：鼠标按键被释放时触发。</span><br><span class="line">● mouseDoubleClickEvent：在窗口上双击时触发。</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.setMouseTracking(True)        # 让窗口始终追踪鼠标</span><br><span class="line">        #如果不调用该方法，那么只有在鼠标按键被按下后，窗口才会开始记录鼠标的移动操作，而按键被释放后，窗口就不会进行记录了</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      # button()方法获取到当前被按下的鼠标按键。</span><br><span class="line">                                           # 如果用户同时按下多个鼠标按键，可以用buttons()方法获取。</span><br><span class="line">        if event.button() == Qt.LeftButton:  </span><br><span class="line">            print(&#x27;鼠标左键&#x27;)</span><br><span class="line">        elif event.button() == Qt.MiddleButton:</span><br><span class="line">            print(&#x27;鼠标中键&#x27;)</span><br><span class="line">        elif event.button() == Qt.RightButton:</span><br><span class="line">            print(&#x27;鼠标右键&#x27;)</span><br><span class="line"></span><br><span class="line">    def mouseMoveEvent(self, event):   # 3</span><br><span class="line">        print(event.pos())             # 鼠标指针在窗口位置</span><br><span class="line">        print(event.globalPos())       # 鼠标指针在屏幕的坐标位置</span><br><span class="line"></span><br><span class="line">    def mouseReleaseEvent(self, event):# 注释4开始</span><br><span class="line">        print(&#x27;释放&#x27;)</span><br><span class="line"></span><br><span class="line">    def mouseDoubleClickEvent(self, event):# 注释4结束</span><br><span class="line">        print(&#x27;双击&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-4-鼠标事件-2"><a href="#4-3-4-鼠标事件-2" class="headerlink" title="4.3.4 鼠标事件-2"></a>4.3.4 鼠标事件-2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.setWindowFlag(Qt.FramelessWindowHint)</span><br><span class="line">        self.start_x = None                         # 设置两个变量分别用来保存鼠标按键被按下时鼠标指针对应的x和y坐标</span><br><span class="line">        self.start_y = None</span><br><span class="line">        # 当不释放鼠标左键，并且鼠标指针开始移动时，mouseMoveEvent()事件函数就会不断执行</span><br><span class="line">        # 而鼠标指针离窗口左上角的位置也会不断更新并保存在event.x()和event.y()中。</span><br><span class="line">        </span><br><span class="line">    def mousePressEvent(self, event):      # 1</span><br><span class="line">        if event.button() == Qt.LeftButton:</span><br><span class="line">            self.start_x = event.x()</span><br><span class="line">            self.start_y = event.y()</span><br><span class="line"></span><br><span class="line">    def mouseMoveEvent(self, event):       # 2</span><br><span class="line">        dis_x = event.x() - self.start_x</span><br><span class="line">        dis_y = event.y() - self.start_y</span><br><span class="line">        self.move(self.x()+dis_x, self.y()+dis_y)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-5-拖放事件"><a href="#4-3-5-拖放事件" class="headerlink" title="4.3.5 拖放事件"></a>4.3.5 拖放事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">● DragEnterEvent：拖动目标进入窗口时触发。</span><br><span class="line">● DragMoveEvent：在窗口上继续拖动目标时触发。</span><br><span class="line">● DragLeaveEvent：拖动目标离开窗口时触发。</span><br><span class="line">● DropEvent：放下目标时触发。</span><br><span class="line"></span><br><span class="line">QMimeData类与MIME（Multipurpose Internet Mail Extension，多用途互联网邮件扩展）相关，</span><br><span class="line">MIME是描述消息内容类型的互联网标准，可以简单理解为对文件扩展名的详细解释。通过该解释，程序就可以知道以何种方式来处理数据。</span><br><span class="line">每个MIME类型由两部分组成，前面是数据的大类，后面定义具体的类，例如扩展名为.png的MIME类型为image/png。</span><br><span class="line">QMimeData类给记录自身MIME类型的数据提供了一个容器，用于专门处理MIME类型的数据。</span><br><span class="line">针对常见的MIME类型，QMimeData类提供了很多方法</span><br><span class="line"></span><br><span class="line">判断方法        获取方法      设置方法           MIME类型</span><br><span class="line">hasText()      text()        setText()         text/plain</span><br><span class="line">hasHtml()      html()        setHtml()         text/html</span><br><span class="line">hasUrls()      urls()        setUrls()         text/uri-list</span><br><span class="line">haslmage()     imageData()   setlmageData()    image/*</span><br><span class="line">hasColor()     colorData()   setColorData()    applicationx-color</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QLabel):                  # 继承QLabel，并重写了它的拖放事件</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        self.setAcceptDrops(True)      # 让窗口或控件接受拖放操作</span><br><span class="line"></span><br><span class="line">    def dragEnterEvent(self, event):   # 3</span><br><span class="line">        print(&#x27;进入&#x27;)</span><br><span class="line">        if event.mimeData().hasUrls(): # event.mimeData()方法获取到当前拖动目标的数据信息</span><br><span class="line">                                       # hasUrls()用来判断数据是否符合text/uri-list类型（即是否为文件）</span><br><span class="line">            event.accept()             # 符合的话，调用accept()方法接受这次拖放操作</span><br><span class="line"></span><br><span class="line">    def dragMoveEvent(self, event):    # 如果拖动目标继续在窗口中移动的话，控制台就会不断输出“移动”文本。</span><br><span class="line">        print(&#x27;移动&#x27;)</span><br><span class="line"></span><br><span class="line">    def dragLeaveEvent(self, event):</span><br><span class="line">        print(&#x27;离开&#x27;)</span><br><span class="line"></span><br><span class="line">    def dropEvent(self, event):        # 5</span><br><span class="line">        print(&#x27;放下&#x27;)</span><br><span class="line">        url = event.mimeData().urls()[0] # 调用urls()方法获取文件的路径信息，返回一个列表，列表元素都是QUrl类型的对象</span><br><span class="line">        file_path = url.toLocalFile()    # 通过QUrl对象的toLocalFile()方法可以获取该文件在当前系统上的路径字符串</span><br><span class="line">        if file_path.endswith(&#x27;.png&#x27;):   # 如果该文件是.png格式的图片，就将它设置在QLabel上</span><br><span class="line">            self.setPixmap(QPixmap(file_path))</span><br><span class="line">            self.setAlignment(Qt.AlignCenter)</span><br><span class="line">            self.setScaledContents(True)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-3-6-绘制事件"><a href="#4-3-6-绘制事件" class="headerlink" title="4.3.6 绘制事件"></a>4.3.6 绘制事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;移动&#x27;, self)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;更新&#x27;, self)</span><br><span class="line">        self.btn1.move(0, 0)</span><br><span class="line">        self.btn2.move(50, 50)</span><br><span class="line">        self.btn1.clicked.connect(lambda: self.btn1.move(100, 100)) # 按钮移动到(100, 100)</span><br><span class="line">        self.btn2.clicked.connect(self.update) # 单击“更新”按钮后，窗口会调用update()方法重绘整个窗口。</span><br><span class="line">        # 绘制事件通过rect()方法获取窗口上重绘的矩形区域，返回值是QRect类型的</span><br><span class="line"></span><br><span class="line">    def paintEvent(self, event):            # 3</span><br><span class="line">        print(&#x27;paint&#x27;)</span><br><span class="line">        print(event.rect())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="4-4-1-主窗口的组成部分"><a href="#4-4-1-主窗口的组成部分" class="headerlink" title="4.4.1 主窗口的组成部分"></a>4.4.1 主窗口的组成部分</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.widget = QWidget()            #注释1开始</span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.btn = QPushButton(&#x27;Button&#x27;)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.edit)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.widget.setLayout(v_layout)    #注释1结束</span><br><span class="line"></span><br><span class="line">        self.setCentralWidget(self.widget) # 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-2-停靠窗口类QDockWidget"><a href="#4-4-2-停靠窗口类QDockWidget" class="headerlink" title="4.4.2 停靠窗口类QDockWidget"></a>4.4.2 停靠窗口类QDockWidget</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">从图4-17可以看出停靠窗口一共有4块，即顶部、底部、左侧、右侧。</span><br><span class="line"></span><br><span class="line">每块区域上都可以放置一个QDockWidget类型的停靠窗口，我们可以在这些停靠窗口上添加任意控件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.edit1 = QTextEdit()           #注释1开始</span><br><span class="line">        self.edit2 = QTextEdit()</span><br><span class="line">        self.center_edit = QTextEdit()     #注释1结束</span><br><span class="line"></span><br><span class="line">        self.dock1 = QDockWidget(&#x27;停靠区域1&#x27;)</span><br><span class="line">        self.dock2 = QDockWidget(&#x27;停靠区域2&#x27;)</span><br><span class="line">        self.dock1.setWidget(self.edit1)</span><br><span class="line">        self.dock2.setWidget(self.edit2)</span><br><span class="line">        self.dock1.setAllowedAreas(Qt.RightDockWidgetArea) #注释2开始</span><br><span class="line">        self.dock2.setAllowedAreas(Qt.AllDockWidgetAreas)</span><br><span class="line">        # setAllowedAreas()用来设置停靠窗口在停靠区域上允许停靠的位置</span><br><span class="line">        # 可以传入setAllowedAreas()中的参数：</span><br><span class="line">        # Qt.LeftDockWidgetArea   左侧停靠区域</span><br><span class="line">        # QtRightDockWidgetArea   右侧停靠区域</span><br><span class="line">        # Qt.TopDockWidgetArea    顶部停靠区域</span><br><span class="line">        # QtBottomDockWidgetArea  底部停靠区域</span><br><span class="line">        # QtAllDockWidgetAreas    全部停靠区域</span><br><span class="line">        # QtNoDockWidgetArea      不可停靠区域(不显示)</span><br><span class="line"></span><br><span class="line">        self.dock1.setFeatures(QDockWidget.DockWidgetFloatable)</span><br><span class="line">        self.dock2.setFeatures(QDockWidget.DockWidgetMovable)#注释2结束</span><br><span class="line">        # setFeatures()方法用来设置停靠窗口的属性特征。</span><br><span class="line"></span><br><span class="line">        self.addDockWidget(Qt.RightDockWidgetArea, self.dock1)#注释3开始</span><br><span class="line">        self.addDockWidget(Qt.TopDockWidgetArea, self.dock2)#注释3结束</span><br><span class="line">        #  QMainWindow调用addDockWidget()方法将停靠窗口添加到主窗口的停靠区域上，该方法需要传入停靠位置和停靠窗口对象这两个参数值。</span><br><span class="line">        # 同一块停靠区域可以放置多块停靠窗口，此时该区域会显示标签用来切换窗口</span><br><span class="line">        self.setCentralWidget(self.center_edit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-3-菜单栏类QMenuBar"><a href="#4-4-3-菜单栏类QMenuBar" class="headerlink" title="4.4.3 菜单栏类QMenuBar"></a>4.4.3 菜单栏类QMenuBar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">应用中的所有功能不可能全部显示在窗口上，不然会显得非常拥挤，我们应该把部分功能存放在菜单中。</span><br><span class="line">主窗口的菜单栏区域就是用来放置各个菜单的，我们可以通过menuBar()方法获取到菜单栏实例，并调用该实例的addMenu()方法添加菜单。</span><br><span class="line">菜单上的每个命令则通过QAction来添加</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        menu_bar = self.menuBar()</span><br><span class="line">        file_menu = menu_bar.addMenu(&#x27;文件&#x27;)</span><br><span class="line"></span><br><span class="line">        open_action = QAction(QIcon(&#x27;open.ico&#x27;), &#x27;打开&#x27;, self)# 程序实例化了3个QAction对象作为文件菜单下的命令，它们的功能分别是打开文件、保存文件和退出程序</span><br><span class="line">        save_action = QAction(QIcon(&#x27;save.ico&#x27;), &#x27;保存&#x27;, self)</span><br><span class="line">        quit_action = QAction(QIcon(&#x27;quit.ico&#x27;), &#x27;退出&#x27;, self)#注释1结束</span><br><span class="line">        open_action.triggered.connect(self.open)   # 当用户单击一个QAction对象时，triggered信号会被发射出来。</span><br><span class="line">        save_action.triggered.connect(self.save)</span><br><span class="line">        quit_action.triggered.connect(self.quit)   #注释2结束</span><br><span class="line"></span><br><span class="line">        file_menu.addAction(open_action)           #注释3开始</span><br><span class="line">        file_menu.addAction(save_action)</span><br><span class="line">        file_menu.addSeparator()    # addSeparator()方法用来在菜单中上添加一条分隔线，将部分命令分隔开来，这样在视觉上显得更有条理</span><br><span class="line">        # 如果想要添加子菜单，可以对file_menu菜单对象调用addMenu()方法，我们只需要在返回的子菜单对象上添加QAction对象即可，代码如下所示</span><br><span class="line">        # sub_menu = file_menu.addMenu(&#x27;子菜单&#x27;)</span><br><span class="line">        # sub_menu.addAction(QAction(QIcon(&#x27;xxx.ico&#x27;), &#x27;xxx&#x27;, self))</span><br><span class="line">        </span><br><span class="line">        # 在macOS系统上，菜单栏不在窗口中，而在屏幕左上方。可以调用menu_bar.setNativeMenuBar(False)禁用原生功能，</span><br><span class="line">        # 将菜单栏全部显示在标题栏下方。</span><br><span class="line">        file_menu.addAction(quit_action)           #注释3结束</span><br><span class="line"></span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.setCentralWidget(self.edit)</span><br><span class="line"></span><br><span class="line">    def open(self):</span><br><span class="line">        file_path, _ = QFileDialog.getOpenFileName(self, &#x27;打开&#x27;, &#x27;./&#x27;, &#x27;*.txt&#x27;)</span><br><span class="line">        if file_path:</span><br><span class="line">            with open(file_path, &#x27;r&#x27;) as f:</span><br><span class="line">                self.edit.setText(f.read())</span><br><span class="line"></span><br><span class="line">    def save(self):</span><br><span class="line">        text = self.edit.toPlainText()</span><br><span class="line">        if text:</span><br><span class="line">            with open(&#x27;saved.txt&#x27;, &#x27;w&#x27;) as f:</span><br><span class="line">                f.write(text)</span><br><span class="line"></span><br><span class="line">    def quit(self):</span><br><span class="line">        self.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-4-工具栏类QToolbar"><a href="#4-4-4-工具栏类QToolbar" class="headerlink" title="4.4.4 工具栏类QToolbar"></a>4.4.4 工具栏类QToolbar</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">我们可以把菜单中的一些常用命令选出来，用图标的方式将其显示在工具栏上，方便用户快速使用。</span><br><span class="line"></span><br><span class="line">我们也可以发现工具栏跟停靠区域一样有多个位置可以使用</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        toolbar1 = QToolBar(&#x27;工具栏1&#x27;)            # 实例化两个QToolBar对象，然后将QAction对象添加到QToolBar对象上</span><br><span class="line">        toolbar2 = QToolBar(&#x27;工具栏2&#x27;)</span><br><span class="line"></span><br><span class="line">        open_action = QAction(QIcon(&#x27;open.ico&#x27;), &#x27;打开&#x27;, self)</span><br><span class="line">        save_action = QAction(QIcon(&#x27;save.ico&#x27;), &#x27;保存&#x27;, self)</span><br><span class="line">        quit_action = QAction(QIcon(&#x27;quit.ico&#x27;), &#x27;退出&#x27;, self)</span><br><span class="line"></span><br><span class="line">        toolbar1.addAction(open_action)</span><br><span class="line">        toolbar1.addAction(save_action)</span><br><span class="line">        toolbar1.addSeparator()</span><br><span class="line">        toolbar1.addAction(quit_action)</span><br><span class="line">        toolbar2.addAction(open_action)</span><br><span class="line">        toolbar2.addAction(save_action)</span><br><span class="line">        toolbar2.addSeparator()</span><br><span class="line">        toolbar2.addAction(quit_action)          #注释1结束</span><br><span class="line"></span><br><span class="line">        toolbar1.setAllowedAreas(Qt.TopToolBarArea|Qt.BottomToolBarArea)</span><br><span class="line">        # 可以传入setAllowedAreas()的参数</span><br><span class="line">        # Qt.LeftToolBarArea      左侧工具栏</span><br><span class="line">        # Qt.RightToolBarArea      右侧工具栏</span><br><span class="line">        # Qt.TopToolBarArea       顶工具栏</span><br><span class="line">        # Qt.BottomToolBarArea    底部工具栏</span><br><span class="line">        # Qt.AllToolBarAreas       全部区域</span><br><span class="line">        # Qt.NoToolBarArea         不显示工具栏</span><br><span class="line">        toolbar2.setMovable(False)               # 用来设置工具栏是否可以移动（默认是可以移动的</span><br><span class="line"></span><br><span class="line">        self.addToolBar(Qt.TopToolBarArea, toolbar1) # 调用QMainWindow的addToolBar()方法将工具栏添加到指定区域上</span><br><span class="line">        self.addToolBar(Qt.BottomToolBarArea, toolbar2) #注释3结束</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-5-状态栏类QStatusBar-1"><a href="#4-4-5-状态栏类QStatusBar-1" class="headerlink" title="4.4.5 状态栏类QStatusBar-1"></a>4.4.5 状态栏类QStatusBar-1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        self.status_bar = QStatusBar()         # 实例化一个QStatusBar对象，然后通过setStatusBar()方法将其设置到窗口上</span><br><span class="line">        self.setStatusBar(self.status_bar)     #注释1结束</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;保存&#x27;, self)</span><br><span class="line">        self.btn.clicked.connect(self.save)</span><br><span class="line"></span><br><span class="line">    def save(self):</span><br><span class="line">        self.status_bar.showMessage(&#x27;已保存&#x27;)   # 当用户单击“保存”按钮后，状态栏通过showMessage()方法显示“已保存”文本提示用户</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-5-状态栏类QStatusBar-2"><a href="#4-4-5-状态栏类QStatusBar-2" class="headerlink" title="4.4.5 状态栏类QStatusBar-2"></a>4.4.5 状态栏类QStatusBar-2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        self.status_bar = QStatusBar()</span><br><span class="line">        self.progress_bar = QProgressBar()</span><br><span class="line">        self.status_bar.addWidget(self.progress_bar)     # 实例化了一个QStatusBar对象后，调用addWidget()方法将进度条控件添加到状态栏上</span><br><span class="line">        self.setStatusBar(self.status_bar)</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;计数&#x27;, self)</span><br><span class="line">        self.btn.clicked.connect(self.count)</span><br><span class="line"></span><br><span class="line">        self.value = 0</span><br><span class="line">        self.timer = QTimer()</span><br><span class="line">        self.timer.timeout.connect(self.update_progress_bar)</span><br><span class="line"></span><br><span class="line">    def count(self):</span><br><span class="line">        self.value = 0</span><br><span class="line">        self.timer.start(50)</span><br><span class="line">        self.progress_bar.setValue(0)</span><br><span class="line">        self.status_bar.clearMessage()</span><br><span class="line"></span><br><span class="line">    def update_progress_bar(self): # 单击“计数”按钮后，计时器会每隔50ms更新一次进度条，当value的值为100时，停止计时器，并在状态栏上显示“结束”文本。</span><br><span class="line">        self.value += 1</span><br><span class="line">        self.progress_bar.setValue(self.value)</span><br><span class="line"></span><br><span class="line">        if self.value == 100:</span><br><span class="line">            self.timer.stop()</span><br><span class="line">            self.status_bar.showMessage(&#x27;结束&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="4-4-6-程序启动画面类QSplashScreen"><a href="#4-4-6-程序启动画面类QSplashScreen" class="headerlink" title="4.4.6 程序启动画面类QSplashScreen"></a>4.4.6 程序启动画面类QSplashScreen</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">许多大型程序（例如Photoshop）在打开前都会先展示一个启动画面，这是因为程序运行需要一定时间来准备。</span><br><span class="line">用启动画面来显示模块加载进度，这种方式可以提升用户体验。</span><br><span class="line">如果没有启动画面，且双击程序之后很长一段时间窗口都没有出现，用户可能会觉得哪里有问题。</span><br><span class="line">通常我们会将程序启动画面的代码放在程序入口处，位于sys.exit(app.exec())之前</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line"></span><br><span class="line">class Window(QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">    def load(self, splash):</span><br><span class="line">        for i in range(101):</span><br><span class="line">            time.sleep(0.05)</span><br><span class="line">            splash.showMessage(f&#x27;加载 &#123;i&#125;%&#x27;, Qt.AlignBottom|Qt.AlignCenter)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line"></span><br><span class="line">    splash = QSplashScreen()      </span><br><span class="line">    splash.setPixmap(QPixmap(&#x27;qt.png&#x27;)) # setPixmap()方法用来设置启动画面上的图片，showMessage()方法用来在启动画面上显示文本</span><br><span class="line">    splash.show()</span><br><span class="line">    splash.showMessage(&#x27;加载 0%&#x27;, Qt.AlignBottom|Qt.AlignCenter)#注释1结束</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.load(splash)   # window窗口对象有一个自定义的load()方法，</span><br><span class="line">                          # 我们在其中调用time.sleep()模拟窗口加载数据和配置的耗时过程。</span><br><span class="line">    window.show()</span><br><span class="line">    splash.finish(window) # 当窗口对象调用show()显示后，splash对象调用finish(window)关闭启动画面。</span><br><span class="line">    sys.exit(app.exec())</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    # 不过这个程序有个小bug：当启动画面还存在时，如果直接单击的话会将它隐藏起来。</span><br><span class="line">    # 我们应该自定义一个MySplashScreen类并重写鼠标事件。</span><br><span class="line">    # class MySplashScreen(QSplashScreen):</span><br><span class="line">    # def mousePressEvent(self,event):</span><br><span class="line">        # pass</span><br><span class="line">    # 最后将splash = QSplashScreen()替换成splash = MySplashScreen()就可以了。</span><br></pre></td></tr></table></figure><h2 id="6-1-数据库"><a href="#6-1-数据库" class="headerlink" title="6.1 数据库"></a>6.1 数据库</h2><p>目前市面上数据库的类型有很多，针对不同类型的数据库，PyQt为我们提供了相应的驱动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QDB2          IBM DB2</span><br><span class="line">QIBASE        Borland InterBase</span><br><span class="line">QMYSQL        MysQL</span><br><span class="line">Qoci          Oracle调用接口驱动</span><br><span class="line">QODBC         ODBC(包括微软SQLServer)</span><br><span class="line">QPSQL         PostgresQL</span><br><span class="line">QSQLITE       SQLite3或更高版本</span><br><span class="line">QSQLITE2      sQLite2</span><br><span class="line">QTDs          Sybase自适应服务器</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-1-1-数据库连接和关闭"><a href="#6-1-1-数据库连接和关闭" class="headerlink" title="6.1.1 数据库连接和关闭"></a>6.1.1 数据库连接和关闭</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.db = QSqlDatabase.addDatabase(&#x27;QSQLITE&#x27;)  # 调用QSqlDatabase类的addDatabase()方法添加QSQLITE数据库驱动，将返回的数据库对象保存在db变量中</span><br><span class="line">        self.connect_db()</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    def connect_db(self):                              </span><br><span class="line">        self.db.setDatabaseName(&#x27;./info.db&#x27;)           # 调用setDatabaseName()方法选择要使用的数据库。</span><br><span class="line">        # 如果数据库文件不存在，则会创建一个。</span><br><span class="line">        if not self.db.open():# open()方法打开数据库，如果打开失败，可以使用lastError()获取失败原因并将其显示在消息框上。</span><br><span class="line">            error = self.db.lastError().text()</span><br><span class="line">            QMessageBox.critical(self, &#x27;Database Connection&#x27;, error)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):    # 在closeEvent()事件函数中，我们在关闭窗口前先调用close()方法关闭数据库。</span><br><span class="line">        self.db.close()</span><br><span class="line">        event.accept()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-1-1-数据库连接和关闭-MySQL"><a href="#6-1-1-数据库连接和关闭-MySQL" class="headerlink" title="6.1.1 数据库连接和关闭-MySQL"></a>6.1.1 数据库连接和关闭-MySQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.db = QSqlDatabase.addDatabase(&#x27;QMYSQL&#x27;)</span><br><span class="line">        self.connect_db()</span><br><span class="line"></span><br><span class="line">    def connect_db(self):</span><br><span class="line">        self.db.setHostName(&#x27;localhost&#x27;)</span><br><span class="line">        self.db.setUserName(&#x27;root&#x27;)</span><br><span class="line">        self.db.setPassword(&#x27;password&#x27;)</span><br><span class="line">        self.db.setDatabaseName(&#x27;info&#x27;)</span><br><span class="line">        if not self.db.open():</span><br><span class="line">            error = self.db.lastError().text()</span><br><span class="line">            QMessageBox.critical(self, &#x27;Database Connection&#x27;, error)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):</span><br><span class="line">        self.db.close()</span><br><span class="line">        event.accept()</span><br></pre></td></tr></table></figure><h2 id="6-2-多线程"><a href="#6-2-多线程" class="headerlink" title="6.2 多线程"></a>6.2 多线程</h2><p>在PyQt中，主线程（也可以称为UI线程）负责界面绘制和更新。<br>当执行某些复杂且耗时的操作时，如果将执行这些操作的代码放在主线程中，界面就会出现停止响应（或卡顿）的情况</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.label = QLabel(&#x27;0&#x27;)</span><br><span class="line">        self.label.setAlignment(Qt.AlignCenter)</span><br><span class="line">        self.btn = QPushButton(&#x27;计数&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.count)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def count(self):           # 我们用while循环来模拟耗时操作。</span><br><span class="line">    # 单击“计数”按钮后，可以发现QLabel标签控件没有更新数字，界面停止响应。</span><br><span class="line">    # 持续了较长一段时间之后，界面才响应，更新了数字。</span><br><span class="line">        num = 0</span><br><span class="line">        while num &lt; 10000000:</span><br><span class="line">            num += 1</span><br><span class="line">            self.label.setText(str(num))</span><br><span class="line">            </span><br><span class="line">    # 针对这种简单的耗时程序，PyQt提供了一种让界面快速响应的方法，</span><br><span class="line">    # 我们只需要在while循环中加入这行代码：QApplication.processEvents()。</span><br><span class="line">    # 该方法会自动处理线程中一些待处理的事件，比方说用来更新界面的绘制事件。</span><br><span class="line">    # 再次运行程序，可以发现界面上的数字是正常更新的。</span><br><span class="line">    # 当然，耗时程序还是放在Qthread子线程中比较好，不要放在主线程中。</span><br><span class="line">    # 这样不仅方便我们管理代码，而且QThread所提供的多种方法也能让我们实现更好的控制。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-2-1-使用QThread线程类-1"><a href="#6-2-1-使用QThread线程类-1" class="headerlink" title="6.2.1 使用QThread线程类-1"></a>6.2.1 使用QThread线程类-1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.label = QLabel(&#x27;0&#x27;)</span><br><span class="line">        self.label.setAlignment(Qt.AlignCenter)</span><br><span class="line">        self.btn = QPushButton(&#x27;计数&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.count)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.count_thread = CountThread()# 实例化了一个CountThread线程对象，并将它的自定义信号和update_label()槽函数相连接。</span><br><span class="line">        self.count_thread.count_signal.connect(self.update_label)</span><br><span class="line"></span><br><span class="line">    def count(self):</span><br><span class="line">        self.count_thread.start() # 当我们单击“计数”按钮后，count_thread线程对象就会调用start()方法开启线程。</span><br><span class="line">        # 接着count_signal信号不断将数字发送过来，update_label()槽函数将数字设置到标签控件上。</span><br><span class="line">    def update_label(self, num):</span><br><span class="line">        self.label.setText(str(num))   #注释1结束</span><br><span class="line"></span><br><span class="line">class CountThread(QThread):            # 继承了QThread类，并重写了run()函数。</span><br><span class="line">    count_signal = pyqtSignal(int)     # 这是编写一个线程类的基本操作。在run()函数中。</span><br><span class="line">    # 我们通过count_signal自定义信号将当前数据发送出来至 update_label函数中。</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(CountThread, self).__init__()</span><br><span class="line"></span><br><span class="line">    def run(self):</span><br><span class="line">        num = 0</span><br><span class="line">        while num &lt; 10000000:</span><br><span class="line">            num += 1</span><br><span class="line">            self.count_signal.emit(num)#注释2结束</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-2-1-使用QThread线程类-2"><a href="#6-2-1-使用QThread线程类-2" class="headerlink" title="6.2.1 使用QThread线程类-2"></a>6.2.1 使用QThread线程类-2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.label = QLabel(&#x27;0&#x27;)</span><br><span class="line">        self.label.setAlignment(Qt.AlignCenter)</span><br><span class="line">        self.btn1 = QPushButton(&#x27;计数&#x27;)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;停止&#x27;)</span><br><span class="line">        self.btn1.clicked.connect(self.start_counting)</span><br><span class="line">        self.btn2.clicked.connect(self.stop_counting)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        v_layout.addWidget(self.btn1)</span><br><span class="line">        v_layout.addWidget(self.btn2)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.count_thread = CountThread()      # 注释1开始</span><br><span class="line">        self.count_thread.count_signal.connect(self.update_label)</span><br><span class="line"></span><br><span class="line">    def start_counting(self):</span><br><span class="line">        if not self.count_thread.isRunning(): # 判断count_thread线程是否还在运行，这样可以避免重复启动该线程。</span><br><span class="line">            self.count_thread.start()         # 注释1结束</span><br><span class="line">            # 当“停止”按钮被单击后，线程对象调用自定义的stop()方法将flag值变为了False </span><br><span class="line">            # 这样程序就会跳出while循环，run()函数也就运行结束了，此时线程也会自动关闭。</span><br><span class="line"></span><br><span class="line">    def stop_counting(self):</span><br><span class="line">        self.count_thread.stop()</span><br><span class="line"></span><br><span class="line">    def update_label(self, num):</span><br><span class="line">        self.label.setText(str(num))</span><br><span class="line"></span><br><span class="line">class CountThread(QThread):</span><br><span class="line">    count_signal = pyqtSignal(int)</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(CountThread, self).__init__()</span><br><span class="line">        self.flag = True</span><br><span class="line"></span><br><span class="line">    def run(self):</span><br><span class="line">        num = 0</span><br><span class="line">        self.flag = True</span><br><span class="line"></span><br><span class="line">        while num &lt; 10000000:</span><br><span class="line">            if not self.flag:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">            num += 1</span><br><span class="line">            self.count_signal.emit(num)</span><br><span class="line">            self.msleep(100)      #  sleep()方法可以让线程休眠，需要传入整型值，传入1表示休眠1s。</span><br><span class="line">            # 果要进行毫秒级休眠，可以使用msleep()。如果要进行微秒级休眠，则可以使用usleep()。</span><br><span class="line">    def stop(self):               # 2</span><br><span class="line">        self.flag = False</span><br><span class="line">        # 其实QThread线程类本身有让线程停止的方法：exit()、quit()和terminate()。</span><br><span class="line">        # 但是前两个方法经常不起作用，第三个办法则不推荐使用，因为它会强制停止线程。</span><br><span class="line">        # 如果线程正在保存一些数据的话，那使用terminate()可能会导致数据丢失。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-2-2-在线程中获取窗口数据信息"><a href="#6-2-2-在线程中获取窗口数据信息" class="headerlink" title="6.2.2 在线程中获取窗口数据信息"></a>6.2.2 在线程中获取窗口数据信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.label = QLabel(&#x27;0&#x27;)</span><br><span class="line">        self.label.setAlignment(Qt.AlignCenter)</span><br><span class="line">        self.btn1 = QPushButton(&#x27;计数&#x27;)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;停止&#x27;)</span><br><span class="line">        self.btn1.clicked.connect(self.start_counting)</span><br><span class="line">        self.btn2.clicked.connect(self.stop_counting)</span><br><span class="line"></span><br><span class="line">        self.spin_box = QSpinBox() # 程序会从这个控件中的数字开始计数</span><br><span class="line">        self.spin_box.setRange(0, 10000000)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        v_layout.addWidget(self.spin_box)</span><br><span class="line">        v_layout.addWidget(self.btn1)</span><br><span class="line">        v_layout.addWidget(self.btn2)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.count_thread = CountThread(self)    # 要想在线程中获取QSpinBox控件上的数据，</span><br><span class="line">        # 我们需要在线程实例化时将窗口实例self传入，这样就能在线程中通过该实例获取到窗口上的任何一个控件，</span><br><span class="line">        # 最后调用QSpinBox控件的value()方法。</span><br><span class="line">        self.count_thread.count_signal.connect(self.update_label)</span><br><span class="line"></span><br><span class="line">    def start_counting(self):</span><br><span class="line">        if not self.count_thread.isRunning():</span><br><span class="line">            self.count_thread.start()</span><br><span class="line"></span><br><span class="line">    def stop_counting(self):</span><br><span class="line">        self.count_thread.stop()</span><br><span class="line"></span><br><span class="line">    def update_label(self, num):</span><br><span class="line">        self.label.setText(str(num))</span><br><span class="line"></span><br><span class="line">class CountThread(QThread):</span><br><span class="line">    count_signal = pyqtSignal(int)</span><br><span class="line">    def __init__(self, window):         #注释1开始</span><br><span class="line">        super(CountThread, self).__init__()</span><br><span class="line">        self.flag = True</span><br><span class="line">        self.window = window</span><br><span class="line"></span><br><span class="line">    def run(self):</span><br><span class="line">        num = self.window.spin_box.value()#注释1结束</span><br><span class="line">        self.flag = True</span><br><span class="line"></span><br><span class="line">        while num &lt; 10000000:</span><br><span class="line">            if not self.flag:</span><br><span class="line">                break</span><br><span class="line">            num += 1</span><br><span class="line">            self.count_signal.emit(num)</span><br><span class="line">            self.msleep(100)</span><br><span class="line"></span><br><span class="line">    def stop(self):</span><br><span class="line">        self.flag = False</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-2-3-编写一个简单的爬程序"><a href="#6-2-3-编写一个简单的爬程序" class="headerlink" title="6.2.3 编写一个简单的爬程序"></a>6.2.3 编写一个简单的爬程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">import requests    # 本程序要导入requests模块用于发送网络请求</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.line_edit = QLineEdit()   # 输入待爬取的网址</span><br><span class="line">        self.text_browser = QTextBrowser() # 用来显示爬取结果</span><br><span class="line">        self.btn = QPushButton(&#x27;爬取&#x27;)  # 用来开启CrawlThread线程</span><br><span class="line"></span><br><span class="line">        self.line_edit.setPlaceholderText(&#x27;待爬取的网址&#x27;)</span><br><span class="line">        self.text_browser.setPlaceholderText(&#x27;爬取结果&#x27;)</span><br><span class="line">        self.btn.clicked.connect(self.crawl)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.line_edit)</span><br><span class="line">        v_layout.addWidget(self.text_browser)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.crawl_thread = CrawlThread(self)</span><br><span class="line">        self.crawl_thread.result_signal.connect(self.show_result)</span><br><span class="line"></span><br><span class="line">    def crawl(self):</span><br><span class="line">        if not self.line_edit.text().strip():  # 如果用户没有输入任何网址，就单击了“爬取”按钮，</span><br><span class="line">        # 那窗口会弹出一个消息框提示用户先输入网址。</span><br><span class="line">            QMessageBox.critical(self, &#x27;错误&#x27;, &quot;请输入网址！&quot;)</span><br><span class="line">            return                             #注释2结束</span><br><span class="line"></span><br><span class="line">        if not self.crawl_thread.isRunning():</span><br><span class="line">            self.crawl_thread.start()</span><br><span class="line"></span><br><span class="line">    def show_result(self, text):               # 3</span><br><span class="line">        self.text_browser.setPlainText(text)</span><br><span class="line"></span><br><span class="line">class CrawlThread(QThread):</span><br><span class="line">    result_signal = pyqtSignal(str) # 这是编写一个线程类的基本操作。在run()函数中。</span><br><span class="line">    # 我们通过count_signal将数据通过self.crawl_thread.result_signal.connect(self.show_result)发送出来至 show_result 函数中</span><br><span class="line">    def __init__(self, window):</span><br><span class="line">        super(CrawlThread, self).__init__()</span><br><span class="line">        self.window = window</span><br><span class="line"></span><br><span class="line">    def run(self):                             # 3</span><br><span class="line">        url= self.window.line_edit.text().strip() # 获取用户输入的网址</span><br><span class="line">        result = requests.get(url) # 获取该网址的网页源码</span><br><span class="line">        self.result_signal.emit(result.text) # 将源码文本发送出去，最后在show_result()槽函数中将源码文本显示到文本浏览框上</span><br></pre></td></tr></table></figure><h2 id="6-3-1-画笔类QPen"><a href="#6-3-1-画笔类QPen" class="headerlink" title="6.3.1 画笔类QPen"></a>6.3.1 画笔类QPen</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line"></span><br><span class="line">        self.pen = QPen()          # 实例化一个QPen对象</span><br><span class="line">        self.pen.setWidth(5)       # 设置画笔宽度</span><br><span class="line">        self.pen.setColor(Qt.black)  # 设置画笔颜色</span><br><span class="line">        self.pen.setStyle(Qt.DashLine) # 设置笔线风格</span><br><span class="line">        self.pen.setCapStyle(Qt.RoundCap) # 设置笔帽风格</span><br><span class="line">        self.pen.setJoinStyle(Qt.MiterJoin)  # 设置笔线转折风格</span><br><span class="line"></span><br><span class="line">    def paintEvent(self, event):   # 绘图是在paintEvent()绘制事件函数中进行的。</span><br><span class="line">        painter = QPainter(self)  # 在实例化一个QPainter对象时，我们传入窗口实例self，</span><br><span class="line">        # 表示我们将在当前窗口上进行绘制，窗口这时候就是一个绘制设备。</span><br><span class="line">        painter.setPen(self.pen)  # 设置好画笔</span><br><span class="line">        painter.drawLine(20, 20, 280, 280)   # 通过drawLine()和drawRect()方法分别绘制线段和矩形</span><br><span class="line">        painter.drawRect(20, 20, 260, 260)</span><br><span class="line">        # QPainter类提供了几种常用的绘制方法</span><br><span class="line">        # drawArc()       绘制弧</span><br><span class="line">        # drawChord()     绘制弦</span><br><span class="line">        # drawConvexPolygon() 绘制凸多边形</span><br><span class="line">        # drawEllipse()   绘制椭圆</span><br><span class="line">        # drawLine()      绘制线段</span><br><span class="line">        # drawPath()      绘制自定义路径</span><br><span class="line">        # drawPie()       绘制扇形</span><br><span class="line">        # drawPixmap()    绘制图月</span><br><span class="line">        # drawPoint()     绘制一个点</span><br><span class="line">        # drawPolygon()   绘制多边形</span><br><span class="line">        # drawPolyline()  绘制多段线</span><br><span class="line">        # drawRect()      绘制矩形</span><br><span class="line">        # drawRoundedRect() 绘制圆角矩形</span><br><span class="line">        # drawText()      绘制文本</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-3-2-画刷类QBrush"><a href="#6-3-2-画刷类QBrush" class="headerlink" title="6.3.2 画刷类QBrush"></a>6.3.2 画刷类QBrush</h3><p>画刷就跟油漆桶工具一样，是用来填充的。我们可以设置它的填充颜色和填充风格，也可以设置其用来填充图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line"></span><br><span class="line">        self.brush1 = QBrush()                         #注释1开始</span><br><span class="line">        self.brush1.setColor(Qt.red)                   # 设置画刷的填充颜色</span><br><span class="line">        self.brush1.setStyle(Qt.Dense6Pattern)         # 设置画刷的填充风格</span><br><span class="line"></span><br><span class="line">        gradient = QLinearGradient(100, 100, 200, 200) # 线性渐变类</span><br><span class="line">        gradient.setColorAt(0.3, QColor(255, 0, 0))    # setColorAt()方法传入两个参数，第一个参数代表颜色开始渐变的位置（大小范围为0～1），第二个参数代表颜色值。</span><br><span class="line">        gradient.setColorAt(0.6, QColor(0, 255, 0))</span><br><span class="line">        gradient.setColorAt(1.0, QColor(0, 0, 255))</span><br><span class="line">        self.brush2 = QBrush(gradient)                 #注释2结束</span><br><span class="line">        # PyQt提供了3种渐变类：线性渐变类QLinearGradient、辐射渐变类QRadialGradient和角度渐变类QConicalGradient。</span><br><span class="line"></span><br><span class="line">        self.brush3 = QBrush() #注释3开始</span><br><span class="line">        self.brush3.setTexture(QPixmap(&#x27;smile.png&#x27;))                    </span><br><span class="line">        # setTexture()方法设置用于填充的图片，此时填充风格自动变为Qt.TexturePattern。</span><br><span class="line"></span><br><span class="line">    def paintEvent(self, event):   # 4</span><br><span class="line">        painter = QPainter(self)</span><br><span class="line">        painter.setBrush(self.brush1)</span><br><span class="line">        painter.drawRect(0, 0, 100, 100)</span><br><span class="line"></span><br><span class="line">        painter.setBrush(self.brush2)</span><br><span class="line">        painter.drawRect(100, 100, 100, 100)</span><br><span class="line"></span><br><span class="line">        painter.setBrush(self.brush3)</span><br><span class="line">        painter.drawRect(200, 200, 100, 100)</span><br><span class="line">        # 4 在paintEvent()事件函数中，我们绘制了3个矩形，每绘制完一个后就调用setBrush()方法更换画刷。</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-3-3-用鼠标在窗口上绘制矩形"><a href="#6-3-3-用鼠标在窗口上绘制矩形" class="headerlink" title="6.3.3 用鼠标在窗口上绘制矩形"></a>6.3.3 用鼠标在窗口上绘制矩形</h3><p>绘图软件的一项基本功能是让用户在画板上自由绘图。<br>在本小节，我们会用鼠标在窗口上绘制任意数量的矩形，好让大家巩固QPainter类的用法并了解用鼠标绘图的原理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtPrintSupport import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.x1 = None</span><br><span class="line">        self.y1 = None</span><br><span class="line">        self.x2 = None</span><br><span class="line">        self.y2 = None</span><br><span class="line">        self.rect_list = []</span><br><span class="line"></span><br><span class="line">        self.pen = QPen()</span><br><span class="line">        self.pen.setWidth(2)</span><br><span class="line">        self.pen.setColor(Qt.green)</span><br><span class="line"></span><br><span class="line">        self.undo_btn = QPushButton(&#x27;撤销&#x27;, self)          #注释1开始</span><br><span class="line">        self.undo_btn.clicked.connect(self.undo_drawing)   #注释1结束</span><br><span class="line">        self.undo_btn.move(20, 20)</span><br><span class="line">        </span><br><span class="line">        ######  打印   ######</span><br><span class="line">        self.printer = QPrinter()                  # 实例化一个QPrinter打印机对象</span><br><span class="line"></span><br><span class="line">        self.print_btn = QPushButton(&#x27;打印&#x27;, self) # 放置一个“打印”按钮，当用户单击按钮后，print_drawing()槽函数就会启动</span><br><span class="line">        self.print_btn.clicked.connect(self.print_drawing)</span><br><span class="line">        self.print_btn.move(20, 50)                #注释1结束</span><br><span class="line"></span><br><span class="line">    def undo_drawing(self):</span><br><span class="line">        if self.rect_list:</span><br><span class="line">            self.rect_list.pop() # 删除rect_list的最后一个元素，也就是最新绘制的矩形。</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):          # 用x1和y1记录单击时的坐标，也就是当前所绘制矩形左上角的坐标。</span><br><span class="line">        if event.button() == Qt.LeftButton:</span><br><span class="line">            self.x1 = event.pos().x()</span><br><span class="line">            self.y1 = event.pos().y()</span><br><span class="line"></span><br><span class="line">    def mouseMoveEvent(self, event): #在mouseMoveEvent()事件函数中，用x2和y2记录鼠标指针当前的坐标，将其作为所绘制矩形右下角的坐标。</span><br><span class="line">        self.x2 = event.pos().x()</span><br><span class="line">        self.y2 = event.pos().y()</span><br><span class="line"></span><br><span class="line">    def mouseReleaseEvent(self, event): # 将矩形的左上角坐标和宽度、高度添加到了rect_list列表变量中。</span><br><span class="line">        if self.x1 and self.y1 and self.x2 and self.y2:</span><br><span class="line">            self.rect_list.append((self.x1, self.y1,self.x2-self.x1, self.y2-self.y1))</span><br><span class="line"></span><br><span class="line">        self.x1 = None</span><br><span class="line">        self.y1 = None</span><br><span class="line">        self.x2 = None</span><br><span class="line">        self.y2 = None</span><br><span class="line">       # 添加完毕后，我们要重置x1、y1、x2和y2，否则绘制下一个矩形时，就会使用之前的坐标。</span><br><span class="line">       </span><br><span class="line">    def paintEvent(self, event):               # 5</span><br><span class="line">        painter = QPainter(self)</span><br><span class="line">        painter.setPen(self.pen)  # 实例化一个QPainter对象并设置好画笔</span><br><span class="line"></span><br><span class="line">        if self.x1 and self.y1 and self.x2 and self.y2:</span><br><span class="line">            painter.drawText(self.x2, self.y2, &#x27;矩形&#x27;) # 矩形右下角绘制“矩形”文本</span><br><span class="line">            painter.drawRect(self.x1, self.y1,self.x2-self.x1, self.y2-self.y1) # 在窗口上实时显示用户当前正在绘制的矩形</span><br><span class="line"></span><br><span class="line">        for rect in self.rect_list: # 循环rect_list列表，显示之前已经画好的各个矩形</span><br><span class="line">            painter.drawRect(rect[0], rect[1], rect[2], rect[3])  </span><br><span class="line">        self.update()</span><br><span class="line">        </span><br><span class="line">        ######  打印   ######</span><br><span class="line">    def print_drawing(self):                      </span><br><span class="line">        print_dialog = QPrintDialog(self.printer)  # 将打印机对象传入QPrinterDialog打印对话框中</span><br><span class="line">        if print_dialog.exec():</span><br><span class="line">            painter = QPainter(self.printer)</span><br><span class="line">            painter.setPen(self.pen)</span><br><span class="line">            for rect in self.rect_list:</span><br><span class="line">                painter.drawRect(rect[0], rect[1], rect[2], rect[3])</span><br><span class="line"># 显示对话框，如果该方法返回值是1，则表示用户单击了对话框上的“打印”按钮；如果该方法返回值是0，则表示用户单击了“撤销”按钮。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-3-4-打印"><a href="#6-3-4-打印" class="headerlink" title="6.3.4 打印"></a>6.3.4 打印</h3><p>有些文本类控件，如QTextEdit和QTextBrowser，本身就提供了print()方法，<br>我们只需要往该方法中传入QPrinter对象就能够快速绘制要打印的文本内容，不需要使用QPainter</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtPrintSupport import *  # 打印控件</span><br><span class="line"> </span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.print_btn = QPushButton(&#x27;打印&#x27;)</span><br><span class="line">        self.print_btn.clicked.connect(self.print_text)</span><br><span class="line"></span><br><span class="line">        self.printer = QPrinter()</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.edit)</span><br><span class="line">        v_layout.addWidget(self.print_btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def print_text(self):</span><br><span class="line">        print_dialog = QprintDialog(self.printer)</span><br><span class="line">        if print_dialog.exec():</span><br><span class="line">            self.edit.print(self.printer)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="6-4-1-属性动画类QPropertyAnimation"><a href="#6-4-1-属性动画类QPropertyAnimation" class="headerlink" title="6.4.1 属性动画类QPropertyAnimation"></a>6.4.1 属性动画类QPropertyAnimation</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(500, 500)</span><br><span class="line"></span><br><span class="line">        self.size_btn = QPushButton(&#x27;大小&#x27;, self)</span><br><span class="line">        self.pos_btn = QPushButton(&#x27;位置&#x27;, self)</span><br><span class="line">        self.color_btn = QPushButton(&#x27;颜色&#x27;, self)</span><br><span class="line">        self.size_btn.move(100, 20)</span><br><span class="line">        self.pos_btn.move(200, 20)</span><br><span class="line">        self.color_btn.move(300, 20)</span><br><span class="line">        self.size_btn.clicked.connect(self.start_anim)</span><br><span class="line">        self.pos_btn.clicked.connect(self.start_anim)</span><br><span class="line">        self.color_btn.clicked.connect(self.start_anim)</span><br><span class="line">        self.size_anim = QPropertyAnimation(self.size_btn, b&#x27;size&#x27;)# 传入动画作用的目标对象和属性名称</span><br><span class="line">        # 注意，属性名称要用字节类型数据，所以要在字符串前面添加b。</span><br><span class="line">        # 读者如果想要使用其他的属性，可以使用Python内置的dir()方法，通过它我们能获取到某对象所有的属性和方法。</span><br><span class="line">        self.size_anim.setDuration(6000) # 设置动画时长（单位为毫秒）。</span><br><span class="line">        self.size_anim.setStartValue(QSize(10, 10)) # 设置动画作用对象的属性初始值</span><br><span class="line">        self.size_anim.setEndValue(QSize(100, 300)) # 设置动画作用对象的属性结束值</span><br><span class="line">        # 如果是改变大小，则传入QSize类型的值；如果是改变坐标位置，则传入QPoint类型的值；如果是改变颜色，则传入QColor类型的值。</span><br><span class="line">        self.size_anim.setLoopCount(2)</span><br><span class="line">        # setLoopCount()方法用来设置动画的循环次数。当动画结束后，finished信号就会发射出来。</span><br><span class="line">        # 我们将这个信号与delete()槽函数进行连接，相应按钮会在动画结束时被删除。</span><br><span class="line">        self.size_anim.finished.connect(self.delete)</span><br><span class="line"></span><br><span class="line">        self.pos_anim = QPropertyAnimation(self.pos_btn, b&#x27;pos&#x27;)</span><br><span class="line">        self.pos_anim.setDuration(5000)</span><br><span class="line">        self.pos_anim.setKeyValueAt(0.1, QPoint(200, 100))</span><br><span class="line">        self.pos_anim.setKeyValueAt(0.5, QPoint(200, 200))</span><br><span class="line">        self.pos_anim.setKeyValueAt(1.0, QPoint(200, 400))</span><br><span class="line">        # 使用setKeyValueAt()能够实现更细化的动画控制，第一个传入的参数值为浮点数，范围为0.0～1.0，表示在动画的相应时刻插入一帧</span><br><span class="line">        # 假如动画时长为5000ms，那传入0.5就表示在第2500ms时插入一帧，该帧的属性值就是我们传入的第二个参数值。</span><br><span class="line">        self.pos_anim.finished.connect(self.delete)</span><br><span class="line"></span><br><span class="line">        self.color_anim = QPropertyAnimation(self.color_btn, b&#x27;color&#x27;)</span><br><span class="line">        self.color_anim.setDuration(5000)</span><br><span class="line">        self.color_anim.setStartValue(QColor(0, 0, 0))</span><br><span class="line">        self.color_anim.setEndValue(QColor(255, 255, 255))</span><br><span class="line">        self.color_anim.finished.connect(self.delete)     #注释1结束</span><br><span class="line"># “大小”按钮和“位置”按钮被单击后都是正常运行动画的，但是对“颜色”按钮来说就不行，</span><br><span class="line"># 单击后控制台会提示“you’re trying to animate a non-existing property color of your QObject”。</span><br><span class="line"># 这句话告诉我们QPushButton按钮控件没有颜色属性！</span><br><span class="line"># 我们可以用print(dir(self. color_btn))这行代码输出“颜色”按钮的所有属性，会发现没有“color”</span><br><span class="line"></span><br><span class="line">    def start_anim(self):               # 2</span><br><span class="line">        if self.sender() == self.size_btn:</span><br><span class="line">            self.size_anim.start()</span><br><span class="line">        elif self.sender() == self.pos_btn:</span><br><span class="line">            self.pos_anim.start()</span><br><span class="line">        else:</span><br><span class="line">            self.color_anim.start()</span><br><span class="line">            # 除了start()，还有以下几种控制动画的方法。</span><br><span class="line">            # ● stop()：停止动画。● pause()：暂停动画。● resume()：继续动画。</span><br><span class="line"></span><br><span class="line">    def delete(self):</span><br><span class="line">        if self.sender() == self.size_anim:</span><br><span class="line">            self.size_btn.deleteLater()</span><br><span class="line">        elif self.sender() == self.pos_anim:</span><br><span class="line">            self.pos_btn.deleteLater()</span><br><span class="line">        else:</span><br><span class="line">            self.color_btn.deleteLater()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-4-1-属性动画类QPropertyAnimation-改变按钮颜色"><a href="#6-4-1-属性动画类QPropertyAnimation-改变按钮颜色" class="headerlink" title="6.4.1 属性动画类QPropertyAnimation-改变按钮颜色"></a>6.4.1 属性动画类QPropertyAnimation-改变按钮颜色</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class ColorButton(QPushButton):</span><br><span class="line">    def __init__(self, text=None, parent=None):</span><br><span class="line">        super(ColorButton, self).__init__(text, parent)</span><br><span class="line">        self._color = QColor()</span><br><span class="line"></span><br><span class="line">    @pyqtProperty(QColor)      # 返回QColor类型的值</span><br><span class="line">    def color(self):</span><br><span class="line">        return self._color</span><br><span class="line"></span><br><span class="line">    @color.setter              # 2</span><br><span class="line">    def color(self, value):</span><br><span class="line">        self._color = value</span><br><span class="line">        red = value.red()</span><br><span class="line">        green = value.green()</span><br><span class="line">        blue = value.blue()</span><br><span class="line">        self.setStyleSheet(f&#x27;background-color: rgb(&#123;red&#125;, &#123;green&#125;, &#123;blue&#125;)&#x27;)</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.color_btn = ColorButton(&#x27;颜色&#x27;, self)</span><br><span class="line">        self.color_btn.move(20, 20)</span><br><span class="line">        self.color_btn.resize(100, 100)</span><br><span class="line">        self.color_btn.clicked.connect(self.start_anim)</span><br><span class="line"></span><br><span class="line">        self.color_anim = QPropertyAnimation(self.color_btn, b&#x27;color&#x27;)</span><br><span class="line">        self.color_anim.setDuration(5000)</span><br><span class="line">        self.color_anim.setStartValue(QColor(0, 0, 0))</span><br><span class="line">        self.color_anim.setEndValue(QColor(255, 255, 255))</span><br><span class="line">        self.color_anim.finished.connect(self.delete)</span><br><span class="line"></span><br><span class="line">    def start_anim(self):</span><br><span class="line">        self.color_anim.start()</span><br><span class="line"></span><br><span class="line">    def delete(self):</span><br><span class="line">        self.color_btn.deleteLater()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-4-2-串行动画组类QSequentialAnimationGroup"><a href="#6-4-2-串行动画组类QSequentialAnimationGroup" class="headerlink" title="6.4.2 串行动画组类QSequentialAnimationGroup"></a>6.4.2 串行动画组类QSequentialAnimationGroup</h3><p>串行动画组就是指按照动画添加顺序来执行动画。<br>我们只用实例化QSequentialAnimationGroup类，<br>然后调用addAnimation()或者insertAnimation()方法把各个属性动画添加到动画组里面就可以了，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(500, 500)</span><br><span class="line"></span><br><span class="line">        self.start_btn = QPushButton(&#x27;开始&#x27;, self)</span><br><span class="line">        self.stop_btn = QPushButton(&#x27;停止&#x27;, self)</span><br><span class="line">        self.pause_resume_btn = QPushButton(&#x27;暂停/继续&#x27;, self)</span><br><span class="line">        self.start_btn.move(20, 20)</span><br><span class="line">        self.stop_btn.move(20, 50)</span><br><span class="line">        self.pause_resume_btn.move(20, 80)</span><br><span class="line">        self.start_btn.clicked.connect(self.control_anim)</span><br><span class="line">        self.stop_btn.clicked.connect(self.control_anim)</span><br><span class="line">        self.pause_resume_btn.clicked.connect(self.control_anim)</span><br><span class="line"></span><br><span class="line">        self.plane = QLabel(self)</span><br><span class="line">        self.plane.move(200, 400)</span><br><span class="line">        self.plane.setPixmap(QPixmap(&#x27;11.png&#x27;))</span><br><span class="line">        self.plane.setScaledContents(True)</span><br><span class="line"></span><br><span class="line">        self.anim1 = QPropertyAnimation(self.plane, b&#x27;pos&#x27;)   # 实例化了两个属性动画</span><br><span class="line">        self.anim1.setDuration(2000)</span><br><span class="line">        self.anim1.setStartValue(QPoint(200, 400))</span><br><span class="line">        self.anim1.setEndValue(QPoint(200, 300))</span><br><span class="line">        self.anim2 = QPropertyAnimation(self.plane, b&#x27;pos&#x27;)</span><br><span class="line">        self.anim2.setDuration(3000)</span><br><span class="line">        self.anim2.setStartValue(QPoint(200, 300))</span><br><span class="line">        self.anim2.setEndValue(QPoint(100, 200))              #注释1结束</span><br><span class="line"></span><br><span class="line">        self.anim_group = QSequentialAnimationGroup()         #注释2开始</span><br><span class="line">        self.anim_group.addAnimation(self.anim1)</span><br><span class="line">        self.anim_group.addPause(1000)                        # 添加了一个暂停1000ms的特殊动画</span><br><span class="line">        self.anim_group.addAnimation(self.anim2)</span><br><span class="line">        self.anim_group.stateChanged.connect(self.get_info)</span><br><span class="line">        print(self.anim_group.totalDuration())                #注释2结束</span><br><span class="line"></span><br><span class="line">    def get_info(self):                                     </span><br><span class="line">        print(self.anim_group.currentAnimation())  # 取当前正在播放的动画对象</span><br><span class="line">        print(self.anim_group.currentTime())       # 取当前正在播放的动画时间</span><br><span class="line"></span><br><span class="line">    def control_anim(self):                                   # 4 开始播放和停止播放动画 </span><br><span class="line">        if self.sender() == self.start_btn:</span><br><span class="line">            self.anim_group.start()</span><br><span class="line">        elif self.sender() == self.stop_btn:</span><br><span class="line">            self.anim_group.stop()</span><br><span class="line">        else:</span><br><span class="line">            if self.anim_group.state() == QAbstractAnimation.Paused: # 获取当前的动画状态</span><br><span class="line">                self.anim_group.resume() # 继续动画</span><br><span class="line">            else:</span><br><span class="line">                self.anim_group.pause() # 暂停动画</span><br><span class="line">            # 动画状态有3种</span><br><span class="line">            # QAbstractAnimation.Stopped      停止状态</span><br><span class="line">            # QAbstractAnimation.Paused       暂停状态</span><br><span class="line">            # QAbstractAnimation.Running      播放状态</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-4-3-并行动画组类QParallelAnimationGroup"><a href="#6-4-3-并行动画组类QParallelAnimationGroup" class="headerlink" title="6.4.3 并行动画组类QParallelAnimationGroup"></a>6.4.3 并行动画组类QParallelAnimationGroup</h3><p>串行动画组就是指按照动画添加顺序来执行动画。<br>我们只用实例化QSequentialAnimationGroup类，<br>然后调用addAnimation()或者insertAnimation()方法把各个属性动画添加到动画组里面就可以了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(500, 500)</span><br><span class="line"></span><br><span class="line">        self.start_btn = QPushButton(&#x27;开始&#x27;, self)</span><br><span class="line">        self.stop_btn = QPushButton(&#x27;停止&#x27;, self)</span><br><span class="line">        self.pause_resume_btn = QPushButton(&#x27;暂停/继续&#x27;, self)</span><br><span class="line">        self.start_btn.move(20, 20)</span><br><span class="line">        self.stop_btn.move(20, 50)</span><br><span class="line">        self.pause_resume_btn.move(20, 80)</span><br><span class="line">        self.start_btn.clicked.connect(self.control_anim)</span><br><span class="line">        self.stop_btn.clicked.connect(self.control_anim)</span><br><span class="line">        self.pause_resume_btn.clicked.connect(self.control_anim)</span><br><span class="line"></span><br><span class="line">        self.plane = QLabel(self)</span><br><span class="line">        self.plane.move(200, 400)</span><br><span class="line">        self.plane.setPixmap(QPixmap(&#x27;11.png&#x27;))</span><br><span class="line">        self.plane.setScaledContents(True)</span><br><span class="line"></span><br><span class="line">        self.anim1 = QPropertyAnimation(self.plane, b&#x27;pos&#x27;)# 属性动画anim1和anim2分别用来修改飞机的位置和大小。</span><br><span class="line">        self.anim1.setDuration(2000)                       # 但在并行动画组中，这两个动画会同时运行。</span><br><span class="line">        self.anim1.setStartValue(QPoint(200, 400))</span><br><span class="line">        self.anim1.setEndValue(QPoint(200, 300))</span><br><span class="line">        self.anim2 = QPropertyAnimation(self.plane, b&#x27;size&#x27;)</span><br><span class="line">        self.anim2.setDuration(3000)</span><br><span class="line">        self.anim2.setStartValue(QSize(200, 200))</span><br><span class="line">        self.anim2.setEndValue(QSize(60, 60))</span><br><span class="line"></span><br><span class="line">        self.anim_group = QParallelAnimationGroup()</span><br><span class="line">        self.anim_group.addAnimation(self.anim1)</span><br><span class="line">        self.anim_group.addAnimation(self.anim2)</span><br><span class="line">        self.anim_group.stateChanged.connect(self.get_info)</span><br><span class="line">        print(self.anim_group.totalDuration())</span><br><span class="line">        # 并行动画组没有addPause()方法，因为不能让暂停动画和其他动画一起播放，这样没有意义。</span><br><span class="line">        # currentAnimation()方法也不适用，因为同一时间段总是有多个动画。</span><br><span class="line">        </span><br><span class="line">    def get_info(self):</span><br><span class="line">        print(self.anim_group.currentTime())             #注释1结束</span><br><span class="line">        </span><br><span class="line">    def control_anim(self):                                   # 4 开始播放和停止播放动画 </span><br><span class="line">        if self.sender() == self.start_btn:</span><br><span class="line">            self.anim_group.start()</span><br><span class="line">        elif self.sender() == self.stop_btn:</span><br><span class="line">            self.anim_group.stop()</span><br><span class="line">        else:</span><br><span class="line">            if self.anim_group.state() == QAbstractAnimation.Paused: # 获取当前的动画状态</span><br><span class="line">                self.anim_group.resume() # 继续动画</span><br><span class="line">            else:</span><br><span class="line">                self.anim_group.pause() # 暂停动画</span><br><span class="line">            # 动画状态有3种</span><br><span class="line">            # QAbstractAnimation.Stopped      停止状态</span><br><span class="line">            # QAbstractAnimation.Paused       暂停状态</span><br><span class="line">            # QAbstractAnimation.Running      播放状态</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-4-4-时间轴类QTimeline"><a href="#6-4-4-时间轴类QTimeline" class="headerlink" title="6.4.4 时间轴类QTimeline"></a>6.4.4 时间轴类QTimeline</h3><p>一个动画由多张静态图片组成，每一张静态图片为一帧。<br>如果每隔一定时间显示一帧，且时间间隔非常短的话，那这些静态图片就会构成一个连续影像，动画由此而来。<br>QTimeLine提供了用于控制动画的时间轴，我们可以用它来快速实现动画效果。<br>示例代码QTimeLine给按钮添加了一段移动动画，同时用QProgressBar显示了动画进度。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(500, 130)</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;开始&#x27;, self)</span><br><span class="line">        self.btn.resize(100, 100)</span><br><span class="line">        self.btn.move(0, 0)</span><br><span class="line">        self.btn.clicked.connect(self.start_anim)</span><br><span class="line"></span><br><span class="line">        self.progress_bar = QProgressBar(self)</span><br><span class="line">        self.progress_bar.setRange(0, 100)</span><br><span class="line">        self.progress_bar.resize(500, 20)</span><br><span class="line">        self.progress_bar.move(0, 100)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        self.time_line = QTimeLine(1000)           # 实例化QTimeLine对象时候需传时间值（单位是毫秒）作为动画的运行时长</span><br><span class="line">        self.time_line.setFrameRange(0, 100)       # 设置动画帧数范围，表示在动画运行时长内要播放多少帧</span><br><span class="line">        self.time_line.frameChanged.connect(self.move_btn)  # 帧数发生改变时，frameChanged信号就会发射</span><br><span class="line">        self.time_line.finished.connect(self.change_direction) </span><br><span class="line">        # # QTimeLine默认使用的缓动曲线(Easing Curve)为QEasingCurve.InOutSine</span><br><span class="line">        # self.time_line.setEasingCurve(QEasingCurve.OutQuart)  # 调用setEasingCurve()方法来修改缓动曲线的类型，比如改成QEasingCurve. OutQuart</span><br><span class="line">        # 可以在官方文档中搜索QEasingCurve来查看所有的缓动曲线。</span><br><span class="line">        </span><br><span class="line">    def start_anim(self):</span><br><span class="line">        if self.time_line.state() == QTimeLine.NotRunning:</span><br><span class="line">            self.time_line.start()</span><br><span class="line"></span><br><span class="line">    def move_btn(self):                        # 2</span><br><span class="line">        frame = self.time_line.currentFrame()  # 获取动画当前的帧数来确定按钮的目标位置和进度条的进度</span><br><span class="line">        self.btn.move(frame*4, 0)</span><br><span class="line">        self.progress_bar.setValue(frame) </span><br><span class="line"></span><br><span class="line">    def change_direction(self):                # 3 </span><br><span class="line">        if self.time_line.direction() == QTimeLine.Forward: # 通过direction()获取当前的播放方向</span><br><span class="line">            self.time_line.setDirection(QTimeLine.Backward) # setDirection()方法改变播放方向</span><br><span class="line">        else:</span><br><span class="line">            self.time_line.setDirection(QTimeLine.Forward)</span><br><span class="line">    # QTimeLine中的动画状态一共有3种</span><br><span class="line">    # QTimeLine.NoRunning   动画未开始或已结束</span><br><span class="line">    # QTimeLine.Running     动画正在播放</span><br><span class="line">    # QTimeLine.Paused      动画被暂停</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="6-5-1-声音类QSound"><a href="#6-5-1-声音类QSound" class="headerlink" title="6.5.1 声音类QSound"></a>6.5.1 声音类QSound</h2><p>如果只是想简单地播放一段音频，那用QSound类就够了，我们只需要调用它的play()方法，不过它只能播放.wav格式的音频文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtMultimedia import * # 导入多媒体模块</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(100, 30)</span><br><span class="line"></span><br><span class="line">        self.sound = QSound(&#x27;audio.wav&#x27;)   </span><br><span class="line">        self.sound.setLoops(2)             # 设置播放音频的循环次数，如果想要无限循环，可以传入QSound.Infinite</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;播放/停止&#x27;, self)</span><br><span class="line">        self.btn.clicked.connect(self.play_or_stop)</span><br><span class="line"></span><br><span class="line">    def play_or_stop(self):                # 2</span><br><span class="line">        if self.sound.isFinished(): # 判断音频是否处于结束状态</span><br><span class="line">            self.sound.play()</span><br><span class="line">        else:</span><br><span class="line">            self.sound.stop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-5-2-音效类QSoundEffect"><a href="#6-5-2-音效类QSoundEffect" class="headerlink" title="6.5.2 音效类QSoundEffect"></a>6.5.2 音效类QSoundEffect</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">QSoundEffect可以用来播放无压缩的音频文件（典型的是.wav文件）。</span><br><span class="line">通过它我们不仅能够以低延迟的方式来播放音频，还能够对音频进行更进一步的操作（比如控制音量）。</span><br><span class="line">该类非常适合用来播放交互音效，如弹出框的提示音、游戏音效等。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtMultimedia import * # 导入多媒体模块</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(80, 60)</span><br><span class="line"></span><br><span class="line">        self.sound_effect = QSoundEffect()     # 实例化一个QSoundEffect对象</span><br><span class="line">        self.sound_effect.setSource(QUrl.fromLocalFile(&#x27;click.wav&#x27;)) # 设置音频源，传入一个QUrl类型的参数。</span><br><span class="line">        self.sound_effect.setLoopCount(1)    # 设置音频播放的循环次数，如果想要无限循环，可以传入QSoundEffect.Infinite。</span><br><span class="line">        self.sound_effect.setVolume(0.8)       #设置声音的音量，范围为0.0～1.0</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;播放&#x27;, self)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;关闭声音&#x27;, self)</span><br><span class="line">        self.btn1.move(0, 0)</span><br><span class="line">        self.btn2.move(0, 30)</span><br><span class="line">        self.btn1.clicked.connect(self.play)</span><br><span class="line">        self.btn2.clicked.connect(self.mute_unmute)</span><br><span class="line"></span><br><span class="line">    def play(self):</span><br><span class="line">        self.sound_effect.play()</span><br><span class="line"></span><br><span class="line">    def mute_unmute(self):      </span><br><span class="line">        if self.sound_effect.isMuted():       # 判断当前音频是否为静音</span><br><span class="line">            self.sound_effect.setMuted(False) </span><br><span class="line">            self.btn2.setText(&#x27;关闭声音&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            self.sound_effect.setMuted(True)</span><br><span class="line">            self.btn2.setText(&#x27;开启声音&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-5-3-媒体播放机类QMediaPlayer-播放视频"><a href="#6-5-3-媒体播放机类QMediaPlayer-播放视频" class="headerlink" title="6.5.3 媒体播放机类QMediaPlayer-播放视频"></a>6.5.3 媒体播放机类QMediaPlayer-播放视频</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtMultimedia import * # 导入多媒体模块</span><br><span class="line">from PyQt5.Qt import QVideoWidget # 导入视频模块</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(600, 400)</span><br><span class="line"></span><br><span class="line">        video1 = QUrl.fromLocalFile(&#x27;./video1.mp4&#x27;)</span><br><span class="line">        video2 = QUrl.fromLocalFile(&#x27;./video2.mp4&#x27;)</span><br><span class="line">        video3 = QUrl.fromLocalFile(&#x27;./video3.mp4&#x27;)</span><br><span class="line"></span><br><span class="line">        self.playlist = QMediaPlaylist()           #注释1开始</span><br><span class="line">        self.playlist.addMedia(QMediaContent(video1))</span><br><span class="line">        self.playlist.addMedia(QMediaContent(video2))</span><br><span class="line">        self.playlist.addMedia(QMediaContent(video3))</span><br><span class="line">        self.playlist.setCurrentIndex(0)</span><br><span class="line">        self.playlist.setPlaybackMode(QMediaPlaylist.Loop)</span><br><span class="line">        self.playlist.currentMediaChanged.connect(self.show_info)</span><br><span class="line"></span><br><span class="line">        self.video_widget = QVideoWidget()</span><br><span class="line"></span><br><span class="line">        self.player = QMediaPlayer()</span><br><span class="line">        self.player.setPlaylist(self.playlist)</span><br><span class="line">        self.player.setVideoOutput(self.video_widget)#注释1结束</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;上一个&#x27;, self)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;播放/停止&#x27;, self)</span><br><span class="line">        self.btn3 = QPushButton(&#x27;下一个&#x27;, self)</span><br><span class="line">        self.btn1.clicked.connect(self.control)</span><br><span class="line">        self.btn2.clicked.connect(self.control)</span><br><span class="line">        self.btn3.clicked.connect(self.control)</span><br><span class="line"></span><br><span class="line">        btn_h_layout = QHBoxLayout()</span><br><span class="line">        window_v_layout = QVBoxLayout()</span><br><span class="line">        btn_h_layout.addWidget(self.btn1)</span><br><span class="line">        btn_h_layout.addWidget(self.btn2)</span><br><span class="line">        btn_h_layout.addWidget(self.btn3)</span><br><span class="line">        window_v_layout.addWidget(self.video_widget)</span><br><span class="line">        window_v_layout.addLayout(btn_h_layout)</span><br><span class="line">        self.setLayout(window_v_layout)</span><br><span class="line"></span><br><span class="line">    def show_info(self):</span><br><span class="line">        print(&#x27;索引：&#x27;, self.playlist.currentIndex())</span><br><span class="line">        print(&#x27;当前媒体：&#x27;, self.playlist.currentMedia())</span><br><span class="line"></span><br><span class="line">    def control(self):</span><br><span class="line">        print(&#x27;媒体状态：&#x27;, self.player.mediaStatus())</span><br><span class="line"></span><br><span class="line">        if self.sender() == self.btn1:</span><br><span class="line">            self.playlist.previous()</span><br><span class="line">        elif self.sender() == self.btn2:</span><br><span class="line">            if self.player.state() == QMediaPlayer.StoppedState:</span><br><span class="line">                self.player.play()</span><br><span class="line">            else:</span><br><span class="line">                self.player.stop()</span><br><span class="line">        else:</span><br><span class="line">            self.playlist.next()</span><br><span class="line"># 如果无法播放视频，可能是没有视频解码器，安装LAV Filters就可以了。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-5-3-媒体播放机类QMediaPlayer-播放音频"><a href="#6-5-3-媒体播放机类QMediaPlayer-播放音频" class="headerlink" title="6.5.3 媒体播放机类QMediaPlayer-播放音频"></a>6.5.3 媒体播放机类QMediaPlayer-播放音频</h3><p>QMediaPlayer是一个高级的媒体播放机类，它的功能非常强大，通过它我们既可以播放音频（可以是.mp3格式的文件），也可以播放视频。<br>该类可以和播放列表类QMediaPlayList一同使用，播放列表用来存放待播放的音频和视频源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtMultimedia import * # 导入多媒体模块</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(320, 50)</span><br><span class="line"></span><br><span class="line">        audio1 = QUrl.fromLocalFile(&#x27;./audio1.wav&#x27;)       # 首先将音频源保存在audio1、audio2和audio3变量中</span><br><span class="line">        audio2 = QUrl.fromLocalFile(&#x27;./audio2.mp3&#x27;)</span><br><span class="line">        audio3 = QUrl.fromLocalFile(&#x27;./audio3.mp3&#x27;)</span><br><span class="line"></span><br><span class="line">        self.playlist = QMediaPlaylist()    # 实例化一个QMediaPlaylist对象</span><br><span class="line">        self.playlist.addMedia(QMediaContent(audio1)) # 将各个音频源添加到播放列表中</span><br><span class="line">        self.playlist.addMedia(QMediaContent(audio2)) # 该方法接收一个QMediaContent类型的参数</span><br><span class="line">        self.playlist.addMedia(QMediaContent(audio3))</span><br><span class="line">        self.playlist.setCurrentIndex(0)              # 设置当前要播放的音频，传入0表示播放第一个音频</span><br><span class="line">        # 如果需要切换到上一个音频或下一个音频，我们可以直接调用previous()或next()来实现</span><br><span class="line">        self.playlist.setPlaybackMode(QMediaPlaylist.Loop)</span><br><span class="line">        self.playlist.currentMediaChanged.connect(self.show_info)</span><br><span class="line">        # 当一个音频播放完毕，要切换时，currentMediaChanged信号会发射出来</span><br><span class="line">        </span><br><span class="line">        # setPlaybackMode()方法用来设置播放模式</span><br><span class="line">        # QMediaPlaylist.CurrentltemOnce    当前音频只播放一次</span><br><span class="line">        # QMediaPlaylist.CurrentlteminLoop  单曲循环</span><br><span class="line">        # QMediaPlaylist.Sequential          顺序播放</span><br><span class="line">        # QMediaPlaylist.Loop               列表循环</span><br><span class="line">        # QMediaPlaylist.Random              随机播放</span><br><span class="line"></span><br><span class="line">        self.player = QMediaPlayer()   </span><br><span class="line">        self.player.setPlaylist(self.playlist) # 设置媒体播放机要播放的音频列表。</span><br><span class="line">        self.player.setVolume(90)              # setVolume()用来设置音量，范围为0～100。</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;上一个&#x27;, self)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;播放/停止&#x27;, self)</span><br><span class="line">        self.btn3 = QPushButton(&#x27;下一个&#x27;, self)</span><br><span class="line">        self.btn1.move(0, 0)</span><br><span class="line">        self.btn2.move(90, 0)</span><br><span class="line">        self.btn3.move(190, 0)</span><br><span class="line">        self.btn1.clicked.connect(self.control)</span><br><span class="line">        self.btn2.clicked.connect(self.control)</span><br><span class="line">        self.btn3.clicked.connect(self.control)</span><br><span class="line"></span><br><span class="line">    def show_info(self):               # 3</span><br><span class="line">        print(&#x27;当前媒体：&#x27;, self.playlist.currentMedia())  # 获取媒体对象</span><br><span class="line">        print(&#x27;索引：&#x27;, self.playlist.currentIndex())      # 获取媒体对象在列表中的索引</span><br><span class="line"></span><br><span class="line">    def control(self):                     # 4</span><br><span class="line">        print(&#x27;媒体状态：&#x27;, self.player.mediaStatus()) # 获取当前音频文件的加载状态</span><br><span class="line">        # 共有9种加载状态</span><br><span class="line">        # 常量                              值       描述</span><br><span class="line">        # QMediaPlayer.UnknownMediaStatus   0    未知媒体状态</span><br><span class="line">        # QMediaPlayer.NoMedia              1    无媒体文件，QMediaPlayer必于stoppedState播放状态</span><br><span class="line">        # MediaPlayer.LoadingMedia          2    正在加载媒体文件，QMediaPlayer可以必于任何状态</span><br><span class="line">        # QMediaPlayer.LoadedMedia          3    已加载媒体文件，QMediaPlayer必于stoppedState播放状态</span><br><span class="line">        # QMediaPlayer.StalledMedia         4    媒体文件由于缓中不足或其他原因处于卡顿的加载状态，QMediaPlayer必于PlavingState(正在播放)或PausedState(暂停播放)状态</span><br><span class="line">        # QMediaPlayer.BufferingMedia       5    在缓中数据，QMediaPlayer必于PlayingState(正在播放)或PausedState (暂停播放)状态</span><br><span class="line">        # OMediaPlaver.BufferedMedia        6    正已完成缓冲，QMediaPlayer必于PlayingState (正在播放)或PausedState (暂停播放)状态</span><br><span class="line">        # QMediaPlayer.EndOfMedia           7    媒体文件播放结束，QMediaPlayer必于StoppedState (停止播放)状态</span><br><span class="line">        # QMediaPlayerInvalidMedia          8    非法的媒体文件，QMediaPlayer必于StoppedState   (停止播放)状态</span><br><span class="line">        </span><br><span class="line">        # QMediaPlayer的播放状态有以下3种</span><br><span class="line">        # QMediaPlayer.StoppedState 停止播放状态</span><br><span class="line">        # QMediaPlayer.PlayingState  正在播放状态</span><br><span class="line">        # QMediaPlayer.PausedState   暂停播放状态</span><br><span class="line"></span><br><span class="line">        if self.sender() == self.btn1:</span><br><span class="line">            self.playlist.previous()</span><br><span class="line">        elif self.sender() == self.btn2:</span><br><span class="line">            if self.player.state() == QMediaPlayer.StoppedState:</span><br><span class="line">                self.player.play()</span><br><span class="line">            else:</span><br><span class="line">                self.player.stop()</span><br><span class="line">        else:</span><br><span class="line">            self.playlist.next()</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="6-6-1-了解QWebEngineView"><a href="#6-6-1-了解QWebEngineView" class="headerlink" title="6.6.1 了解QWebEngineView"></a>6.6.1 了解QWebEngineView</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">from PyQt5.QtWebEngineWidgets import QWebEngineView</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.web_view = QWebEngineView()               #注释1开始</span><br><span class="line">        self.web_view.load(QUrl(&#x27;https://www.baidu.com&#x27;))  # 加载一个网页，需要传入一个QUrl类型的参数</span><br><span class="line">        self.web_view.loadStarted.connect(self.start)      # loadStarted信号会在网页开始加载时发射；</span><br><span class="line">        self.web_view.loadProgress.connect(self.progress)</span><br><span class="line">        self.web_view.loadFinished.connect(self.finish)</span><br><span class="line">        self.web_view.urlChanged.connect(self.show_url)#注释1结束</span><br><span class="line">        # loadProgress信号会在网页加载过程中不断发射，连接的progress()槽函数会不断输出当前的加载进度，如果进度为100，则表示加载完毕；</span><br><span class="line">        # loadFinished信号会在网页加载结束后发射，在finish()槽函数中，我们可以通过title()获取网页的标题；</span><br><span class="line">        # 最后一个urlChanged信号会在网页地址发生改变时发射。</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;更改网址&#x27;)              #注释2开始</span><br><span class="line">        self.btn.clicked.connect(self.change_url)      #注释2结束</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.web_view)</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def start(self):</span><br><span class="line">        print(&#x27;开始加载&#x27;)</span><br><span class="line"></span><br><span class="line">    def progress(self, value):</span><br><span class="line">        print(value)</span><br><span class="line"></span><br><span class="line">    def finish(self):</span><br><span class="line">        print(&#x27;加载结束&#x27;)</span><br><span class="line">        print(self.web_view.title())</span><br><span class="line">        print(self.web_view.icon())</span><br><span class="line"></span><br><span class="line">    def show_url(self):</span><br><span class="line">        print(self.web_view.url())</span><br><span class="line"></span><br><span class="line">    def change_url(self):</span><br><span class="line">        self.web_view.setUrl(QUrl(&#x27;https://www.ptpress.com.cn/&#x27;)) #调用了setUrl()方法显示出新的网页。</span><br><span class="line">        # 如果想要显示自定义的HTML页面，可以调用setHtml()方法。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-6-2-制作一款简单的浏览器"><a href="#6-6-2-制作一款简单的浏览器" class="headerlink" title="6.6.2 制作一款简单的浏览器"></a>6.6.2 制作一款简单的浏览器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtWebEngineWidgets import QWebEngineView</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(1000, 600)</span><br><span class="line">        self.url_input = QLineEdit()       #注释1开始</span><br><span class="line">        self.back_btn = QPushButton()      # 后退</span><br><span class="line">        self.forward_btn = QPushButton()   # 前进</span><br><span class="line">        self.refresh_btn = QPushButton()   # 刷新</span><br><span class="line">        self.zoom_in_btn = QPushButton()   # 放大网页</span><br><span class="line">        self.zoom_out_btn = QPushButton()  # 缩小网页</span><br><span class="line">        self.web_view = QWebEngineView()   </span><br><span class="line"></span><br><span class="line">        self.init_ui()</span><br><span class="line"></span><br><span class="line">    def init_ui(self):</span><br><span class="line">        self.init_widgets()</span><br><span class="line">        self.init_signals()</span><br><span class="line">        self.init_layouts()</span><br><span class="line"></span><br><span class="line">    def init_widgets(self):</span><br><span class="line">        self.back_btn.setEnabled(False) </span><br><span class="line">        self.forward_btn.setEnabled(False)</span><br><span class="line">        self.back_btn.setIcon(QIcon(&#x27;back.png&#x27;))</span><br><span class="line">        self.forward_btn.setIcon(QIcon(&#x27;forward.png&#x27;))</span><br><span class="line">        self.refresh_btn.setIcon(QIcon(&#x27;refresh.png&#x27;))</span><br><span class="line">        self.zoom_in_btn.setIcon(QIcon(&#x27;zoom-in.png&#x27;))</span><br><span class="line">        self.zoom_out_btn.setIcon(QIcon(&#x27;zoom-out.png&#x27;))</span><br><span class="line">        self.url_input.setText(&#x27;about:blank&#x27;)</span><br><span class="line">        self.url_input.setPlaceholderText(&#x27;请输入网址&#x27;)</span><br><span class="line">        self.web_view.setUrl(QUrl(&#x27;about:blank&#x27;))</span><br><span class="line"></span><br><span class="line">    def init_signals(self):                 # 2</span><br><span class="line">        self.back_btn.clicked.connect(self.web_view.back) </span><br><span class="line">        self.forward_btn.clicked.connect(self.web_view.forward)</span><br><span class="line">        self.refresh_btn.clicked.connect(self.web_view.reload)</span><br><span class="line">        self.zoom_in_btn.clicked.connect(self.zoom_in)</span><br><span class="line">        self.zoom_out_btn.clicked.connect(self.zoom_out)</span><br><span class="line">        self.web_view.loadFinished.connect(self.update_state) # 当网页加载完毕，loadFinished信号就会发射</span><br><span class="line">        # 在放大和缩小网页时，先调用zoomFactor()方法获取到当前网页的缩放值，</span><br><span class="line">        # 在这个基础上再通过setZoomFactor()方法设置新的缩放值（范围为0.25～5.0）。</span><br><span class="line">        </span><br><span class="line">    def init_layouts(self):</span><br><span class="line">        h_layout = QHBoxLayout()</span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        h_layout.addWidget(self.back_btn)</span><br><span class="line">        h_layout.addWidget(self.forward_btn)</span><br><span class="line">        h_layout.addWidget(self.refresh_btn)</span><br><span class="line">        h_layout.addWidget(self.url_input)</span><br><span class="line">        h_layout.addWidget(self.zoom_in_btn)</span><br><span class="line">        h_layout.addWidget(self.zoom_out_btn)</span><br><span class="line">        v_layout.addLayout(h_layout)</span><br><span class="line">        v_layout.addWidget(self.web_view)</span><br><span class="line">        v_layout.setContentsMargins(0, 8, 0, 0)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">    def update_state(self):</span><br><span class="line">        url = self.web_view.url().toString()  # 将url_input控件中的文本设置为当前所加载的网址。</span><br><span class="line">        self.url_input.setText(url)</span><br><span class="line"></span><br><span class="line">        if self.web_view.history().canGoBack(): # 获取到网页历史对象，它保留了当前用户的浏览记录</span><br><span class="line">            self.back_btn.setEnabled(True)</span><br><span class="line">        else:</span><br><span class="line">            self.back_btn.setEnabled(False)</span><br><span class="line"></span><br><span class="line">        if self.web_view.history().canGoForward():# 调用该对象的canGoBack()和canGoForward()方法就可以知道当前是否能够后退或前进。</span><br><span class="line">            self.forward_btn.setEnabled(True)</span><br><span class="line">        else:</span><br><span class="line">            self.forward_btn.setEnabled(False)</span><br><span class="line"></span><br><span class="line">    def zoom_in(self):</span><br><span class="line">        zoom_factor = self.web_view.zoomFactor()</span><br><span class="line">        self.web_view.setZoomFactor(zoom_factor + 0.1)</span><br><span class="line"></span><br><span class="line">    def zoom_out(self):</span><br><span class="line">        zoom_factor = self.web_view.zoomFactor()</span><br><span class="line">        self.web_view.setZoomFactor(zoom_factor - 0.1)</span><br><span class="line"></span><br><span class="line">    def keyPressEvent(self, event):     # 当用户在文本框中输完URL并按“Enter”键后，我们要先判断文本框是否有焦点（部分用户输入完毕后可能会先单击窗口其他地方，导致文本框失去焦点）</span><br><span class="line">        if event.key() == Qt.Key_Enter:</span><br><span class="line">            if not self.url_input.hasFocus():</span><br><span class="line">                return</span><br><span class="line">            # 假如不进行判断，那每当用户在窗口上按“Enter”键后，网页就会直接重新加载。</span><br><span class="line">            url = self.url_input.text() # 判断用户输入的URL是否以“https://”或“http://”开头，不是的话就先加上“https://”再进行加载。</span><br><span class="line">            if url.startswith(&#x27;https://&#x27;) or url.startswith(&#x27;http://&#x27;):</span><br><span class="line">                self.web_view.load(QUrl(url))</span><br><span class="line">            else:</span><br><span class="line">                url = &#x27;https://&#x27; + url</span><br><span class="line">                self.web_view.load(QUrl(url))</span><br><span class="line"></span><br><span class="line">            self.url_input.setText(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="6-7-1-QUdpSocket-开发多人聊天室应用"><a href="#6-7-1-QUdpSocket-开发多人聊天室应用" class="headerlink" title="6.7.1 QUdpSocket 开发多人聊天室应用"></a>6.7.1 QUdpSocket 开发多人聊天室应用</h2><p>PyQt提供了QUdpSocket、QTcpSocket、QTcpServer这3个类，它们封装了许多功能，能够帮助我们快速实现基于UDP和TCP的应用程序。<br>它们相较于Python标准库中的socket模块使用起来也更加方便。这3个类都在QtNetwork模块中，使用前要先导入它们</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Client(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Client, self).__init__()</span><br><span class="line">        self.resize(600, 500)</span><br><span class="line"></span><br><span class="line">        self.browser = QTextBrowser()          # 用来显示当前用户发送和接收到的各种信息</span><br><span class="line">        self.edit = QTextEdit()                # QTextEdit控件用来输入信息</span><br><span class="line">        self.edit.setPlaceholderText(&#x27;请输入消息&#x27;) </span><br><span class="line">        self.splitter = QSplitter(Qt.Vertical) </span><br><span class="line">        self.splitter.addWidget(self.browser) </span><br><span class="line">        self.splitter.addWidget(self.edit)</span><br><span class="line">        self.splitter.setSizes([200, 100])</span><br><span class="line"></span><br><span class="line">        self.send_btn = QPushButton(&#x27;发送&#x27;)</span><br><span class="line">        self.send_btn.clicked.connect(self.send)</span><br><span class="line">        </span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.splitter)</span><br><span class="line">        v_layout.addWidget(self.send_btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.name = f&#x27;用户&#123;id(self)&#125;&#x27;   # 通过id(self)获取到当前窗口对象的内存地址后，将它作为用户名称保存到name变量中</span><br><span class="line">        print(f&#x27;我是&#123;self.name&#125;.&#x27;)      # </span><br><span class="line"></span><br><span class="line">        self.udp = QUdpSocket()        # </span><br><span class="line">        data = f&#x27;&#123;self.name&#125;\n**%%加入%%**&#x27; # </span><br><span class="line">        self.udp.writeDatagram(data.encode(), QHostAddress(&#x27;127.0.0.1&#x27;), 6666) # 将数据报发送到服务端IP地址（为QHostAddress类型），告诉它用户已加入聊天</span><br><span class="line">        self.udp.readyRead.connect(self.receive)</span><br><span class="line">        self.browser.append(&#x27;您已加入聊天。\n&#x27;)  #注释2结束</span><br><span class="line">        # PyQt提供了几种常用的IP地址</span><br><span class="line">        # QHostAddress.Null           空地址，等同于QHostAddress()</span><br><span class="line">        # QHostAddress.LocalHost      IPv4本地主机地址，等同于QHostAddress(127.0.0.1)</span><br><span class="line">        # QHostAddress.LocalHostlPv6  IPv6本地主机地址，等同于QHostAddress(.:1</span><br><span class="line">        # QHostAddress.Broadcast      IPv4广播地址，等同于QHostAddress(255.255.255.255 </span><br><span class="line">        # QHostAddress.AnyIPv4        任何IPv4地址，等同于QHostAdress(0.0.0.0，与该常量绑定的套接字只监听IPV4接</span><br><span class="line">        # QHostAddress.AnylPv6        任何IPv6地址，等同于QHostAdress(::)，与该常量绑定的套接字只监听IPV6接口</span><br><span class="line">        # QHostAddress.Any            任何双协议栈地址，与该常量绑定的套接字可以监听IPV4接口和IPV6接口</span><br><span class="line"></span><br><span class="line">    def send(self):</span><br><span class="line">        if not self.edit.toPlainText():</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        message = self.edit.toPlainText()</span><br><span class="line">        data = f&#x27;&#123;self.name&#125;\n&#123;message&#125;\n&#x27;</span><br><span class="line"></span><br><span class="line">        self.edit.clear()</span><br><span class="line">        self.browser.append(data)</span><br><span class="line">        self.udp.writeDatagram(data.encode(), QHostAddress(&#x27;127.0.0.1&#x27;), 6666)</span><br><span class="line"></span><br><span class="line">    def receive(self):                         </span><br><span class="line">        while self.udp.hasPendingDatagrams():                    # 判断是否存在任何待读取的数据报</span><br><span class="line">            data_size = self.udp.pendingDatagramSize()           # 获取到数据报的大小</span><br><span class="line">            data, host, port = self.udp.readDatagram(data_size)  # 读取数据，数据报内容、发送者IP地址和发送者端口</span><br><span class="line">            if data:</span><br><span class="line">                data = data.decode()</span><br><span class="line">                self.browser.append(data)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):               # 发送一条信息到服务端，告诉它当前用户已下线。</span><br><span class="line">        data = f&#x27;&#123;self.name&#125;\n**%%离开%%**&#x27;</span><br><span class="line">        self.udp.writeDatagram(data.encode(), QHostAddress(&#x27;127.0.0.1&#x27;), 6666)</span><br><span class="line">        event.accept()</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Client()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-7-2-QTcpSocket和QTcpServer-使用QTcpServer编写服务端"><a href="#6-7-2-QTcpSocket和QTcpServer-使用QTcpServer编写服务端" class="headerlink" title="6.7.2 QTcpSocket和QTcpServer-使用QTcpServer编写服务端"></a>6.7.2 QTcpSocket和QTcpServer-使用QTcpServer编写服务端</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Server(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Server, self).__init__()</span><br><span class="line">        self.resize(400, 200)</span><br><span class="line">        self.browser = QTextBrowser()</span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.browser)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.tcp = QTcpServer()                                #  实例化一个QTcpServer对象</span><br><span class="line">        if self.tcp.listen(QHostAddress.LocalHost, 6666):      # 调用listen()方法对指定IP地址和端口进行监听</span><br><span class="line">        # 如果监听正常，则返回True，否则返回False。</span><br><span class="line">            self.browser.append(&#x27;已准备好与客户端进行连接。\n&#x27;)  # </span><br><span class="line">            self.tcp.newConnection.connect(self.handle_connection) </span><br><span class="line">            # 每当有来自客户端的新的连接请求时，QTcpServer就会发射newConnection信号。</span><br><span class="line">        else:</span><br><span class="line">            error = self.tcp.errorString()     # 可以调用errorString()方法来获取监听失败的原因。</span><br><span class="line">            self.browser.append(error)      </span><br><span class="line"></span><br><span class="line">        self.client_set = set()</span><br><span class="line"></span><br><span class="line">    def handle_connection(self):               </span><br><span class="line">        sock = self.tcp.nextPendingConnection() </span><br><span class="line">        # 调用nextPendingConnection()方法来获取一个连接到客户端的QTcpSocket对象，通过它我们就可以和客户端通信了</span><br><span class="line">        self.client_set.add(sock)</span><br><span class="line">        sock.readyRead.connect(lambda: self.receive(sock))</span><br><span class="line">        sock.disconnected.connect(lambda: self.handle_disconnection(sock))# 如果客户端与服务端断开连接，disconnected信号就会发射。</span><br><span class="line">        address, port = self.get_address_and_port(sock)</span><br><span class="line">        data = f&#x27;&#123;address&#125;:&#123;port&#125;已加入聊天。\n&#x27;</span><br><span class="line">        self.browser.append(data)</span><br><span class="line">        self.send_to_other_clients(sock, data.encode())</span><br><span class="line"></span><br><span class="line">    def receive(self, sock):</span><br><span class="line">        while sock.bytesAvailable():</span><br><span class="line">            data_size = sock.bytesAvailable()</span><br><span class="line">            data = sock.read(data_size)</span><br><span class="line">            self.send_to_other_clients(sock, data)</span><br><span class="line"></span><br><span class="line">    def handle_disconnection(self, sock):</span><br><span class="line">        self.client_set.remove(sock)</span><br><span class="line"></span><br><span class="line">        address, port = self.get_address_and_port(sock)</span><br><span class="line">        data = f&#x27;&#123;address&#125;:&#123;port&#125;离开。\n&#x27;</span><br><span class="line">        self.browser.append(data)</span><br><span class="line">        self.send_to_other_clients(sock, data.encode())</span><br><span class="line"></span><br><span class="line">    def send_to_other_clients(self, current_client, data):</span><br><span class="line">        for target in self.client_set:</span><br><span class="line">            if target != current_client:</span><br><span class="line">                target.write(data)</span><br><span class="line">                address, port = self.get_address_and_port(target)</span><br><span class="line">                self.browser.append(f&#x27;已将消息发送给&#123;address&#125;:&#123;port&#125;。\n&#x27;)</span><br><span class="line"></span><br><span class="line">    def get_address_and_port(self, sock):# 过peerAddress()和peerPort()方法分别获取到客户端使用的IP地址和端口。</span><br><span class="line">        address = sock.peerAddress().toString() # 获取客户端ip地址</span><br><span class="line">        port = sock.peerPort()                  # 获取客服端端口</span><br><span class="line">        return address, port</span><br><span class="line">    # 这个修改后的多人聊天室应用的使用方法和6.7.1小节中的一样，也是先运行服务端代码，再运行客户端代码</span><br><span class="line"></span><br><span class="line">    def closeEvent(self,event):</span><br><span class="line">        self.tcp.close()</span><br><span class="line">        event.accept()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Server()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-7-2-QTcpSocket和QTcpServer-使用QTcpSocket编写客户端"><a href="#6-7-2-QTcpSocket和QTcpServer-使用QTcpSocket编写客户端" class="headerlink" title="6.7.2 QTcpSocket和QTcpServer-使用QTcpSocket编写客户端"></a>6.7.2 QTcpSocket和QTcpServer-使用QTcpSocket编写客户端</h3><p>QTcpSocket和QTcpServer这两个类可以用来开发基于TCP的应用，前者用来开发客户端，后者用来开发服务端。<br>我们将使用这两个类来开发6.7.1小节中的多人聊天室应用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Client(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Client, self).__init__()</span><br><span class="line">        self.resize(600, 500)</span><br><span class="line"></span><br><span class="line">        self.browser = QTextBrowser()</span><br><span class="line">        self.edit = QTextEdit()</span><br><span class="line">        self.edit.setPlaceholderText(&#x27;请输入消息&#x27;)</span><br><span class="line">        self.splitter = QSplitter(Qt.Vertical)</span><br><span class="line">        self.splitter.addWidget(self.browser)</span><br><span class="line">        self.splitter.addWidget(self.edit)</span><br><span class="line">        self.splitter.setSizes([200, 100])</span><br><span class="line"></span><br><span class="line">        self.send_btn = QPushButton(&#x27;发送&#x27;)</span><br><span class="line">        self.send_btn.clicked.connect(self.send)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.splitter)</span><br><span class="line">        v_layout.addWidget(self.send_btn)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.name = f&#x27;用户&#123;id(self)&#125;&#x27;</span><br><span class="line">        print(f&#x27;我是&#123;self.name&#125;.&#x27;)</span><br><span class="line"></span><br><span class="line">        self.tcp = QTcpSocket()                              # 实例化一个QTcpSockset对象</span><br><span class="line">        self.tcp.connectToHost(QHostAddress.LocalHost, 6666) # 连接服务端（三次握手）。</span><br><span class="line">        self.tcp.connected.connect(self.handle_connection)   # 如果客户端和服务端连接成功，connected信号就会发射出来。</span><br><span class="line">        self.tcp.readyRead.connect(self.receive)             # 当有新数据等待读取时，readyRead信号就会发射。</span><br><span class="line"></span><br><span class="line">    def handle_connection(self):</span><br><span class="line">        self.browser.append(&#x27;已连接到服务器！\n&#x27;)</span><br><span class="line">        self.browser.append(&#x27;您已加入聊天。\n&#x27;)</span><br><span class="line"></span><br><span class="line">    def send(self):</span><br><span class="line">        if not self.edit.toPlainText():</span><br><span class="line">            return</span><br><span class="line"></span><br><span class="line">        message = self.edit.toPlainText()</span><br><span class="line">        data = f&#x27;&#123;self.name&#125;\n&#123;message&#125;\n&#x27;</span><br><span class="line"></span><br><span class="line">        self.edit.clear()</span><br><span class="line">        self.browser.append(data)</span><br><span class="line">        self.tcp.write(data.encode())</span><br><span class="line"></span><br><span class="line">    def receive(self):             </span><br><span class="line">        while self.tcp.bytesAvailable(): # 判断是否还有数据等待接收，如果有的话则调用read()方法将其读取出来。</span><br><span class="line">            data_size = self.tcp.bytesAvailable()</span><br><span class="line">            data = self.tcp.read(data_size)</span><br><span class="line">            if data:</span><br><span class="line">                self.browser.append(data.decode())</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):   # 如果用户关闭了聊天窗口，则调用close()方法关闭连接，释放系统资源。</span><br><span class="line">        self.tcp.close()</span><br><span class="line">        event.accept()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Client()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="6-8-QSS-QSS样读取式"><a href="#6-8-QSS-QSS样读取式" class="headerlink" title="6.8 QSS-QSS样读取式"></a>6.8 QSS-QSS样读取式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">        with open(&#x27;./style.qss&#x27;, &#x27;r&#x27;) as f: # 文件中的样式不能有其他注释</span><br><span class="line">            qss = f.read()</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;, self)</span><br><span class="line">        self.btn.setStyleSheet(qss)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-8-QSS-调用QApplication对象的setStyleSheet-方法将样式作用于整个应用程序"><a href="#6-8-QSS-调用QApplication对象的setStyleSheet-方法将样式作用于整个应用程序" class="headerlink" title="6.8 QSS-调用QApplication对象的setStyleSheet()方法将样式作用于整个应用程序"></a>6.8 QSS-调用QApplication对象的setStyleSheet()方法将样式作用于整个应用程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;, self)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&#x27;style.qss&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        qss = f.read()</span><br><span class="line"></span><br><span class="line">    app = QApplication([])</span><br><span class="line">    app.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec())</span><br></pre></td></tr></table></figure><h3 id="6-8-QSS-改变按钮控件上文本字体的大小"><a href="#6-8-QSS-改变按钮控件上文本字体的大小" class="headerlink" title="6.8 QSS-改变按钮控件上文本字体的大小"></a>6.8 QSS-改变按钮控件上文本字体的大小</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        qss = &quot;QPushButton &#123;font-size: 50px;&#125;&quot;   # 文本字体大小变为50像素</span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;, self)   # </span><br><span class="line">        self.btn.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-8-2-QSS基本规则"><a href="#6-8-2-QSS基本规则" class="headerlink" title="6.8.2 QSS基本规则"></a>6.8.2 QSS基本规则</h3><p>每个QSS样式都由选择器和声明这两部分组成，前者用来指定样式所作用的控件对象，后者用来指定样式使用的属性和值。<br>比方说“QPushButton {font-size:50px;}”这个样式，选择器“QPushButton”指定将样式作用于所有QPushButton按钮控件以及继承这个类的控件。<br>声明部分则指定“font-size”文本字体大小属性，并将值设置成了50像素。<br>我们可以声明多个属性和值，每对属性和值之间需要用英文分号间隔开来。</p><h1 id="QPushButton-font-size-50px-color-red"><a href="#QPushButton-font-size-50px-color-red" class="headerlink" title="QPushButton {    font-size: 50px;    color: red;}"></a>QPushButton {<br>font-size: 50px;<br>color: red;<br>}</h1><h1 id="当然也可以同时指定多个选择器。QPushButton-QLabel-QLineEdit-font-size-50px-color-red"><a href="#当然也可以同时指定多个选择器。QPushButton-QLabel-QLineEdit-font-size-50px-color-red" class="headerlink" title="当然也可以同时指定多个选择器。QPushButton, QLabel, QLineEdit {    font-size: 50px;    color: red;}"></a>当然也可以同时指定多个选择器。<br>QPushButton, QLabel, QLineEdit {<br>font-size: 50px;<br>color: red;<br>}</h1><p>把选择器部分拆开<br>QPushButton {<br>font-size: 50px;<br>color: red;<br>}<br>QLabel {<br>font-size: 50px;<br>color: red;<br>}<br>QLineEdit {<br>font-size: 50px;<br>color: red;<br>}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.btn = QPushButton(&#x27;QPushButton&#x27;)</span><br><span class="line">        self.label = QLabel(&#x27;QLabel&#x27;)</span><br><span class="line">        self.line_edit = QLineEdit()</span><br><span class="line">        self.text_edit = QTextEdit()</span><br><span class="line">        self.line_edit.setText(&#x27;QLineEdit&#x27;)</span><br><span class="line">        self.text_edit.setText(&#x27;QTextEdit&#x27;) # 1 由于QTextEdit没有在QSS样式的选择器中出现，所以它的文本字体大小和颜色是不会改变的</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.btn)</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        v_layout.addWidget(self.line_edit)</span><br><span class="line">        v_layout.addWidget(self.text_edit)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&#x27;style.qss&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        qss = f.read()</span><br><span class="line"></span><br><span class="line">    app = QApplication([])</span><br><span class="line">    app.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec())</span><br></pre></td></tr></table></figure><h3 id="6-8-3-选择器的类型"><a href="#6-8-3-选择器的类型" class="headerlink" title="6.8.3 选择器的类型"></a>6.8.3 选择器的类型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">选择器的类型有很多种，下面总结了几种常用的选择器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">类型                示例                         描述</span><br><span class="line"></span><br><span class="line">通用选择器             *                     匹配所有控件</span><br><span class="line">类型选择器        QPushButton               匹配所有QPushButton控件及其子类(即上文中演示的那种)</span><br><span class="line">属性选择器       QPushButton[name=&quot;btn&quot;]    匹配所有name属性的值为“bn的QPushButlon控件~=代表匹所有name性的值中包含“bn的QPushButon控件。</span><br><span class="line">                QPushButton[name~=&quot;btn&quot;]   可以通过etPropert/0方法设属性以及对应的值，而如果要获取某属性值，使用property0方法，传入属性名就可以了</span><br><span class="line">类名选择器       .QPushButton               匹配所有QPushButton控件，但不匹配其子类。也可以这样写:*[class~=&quot;QPushButton&quot;]</span><br><span class="line">ID选择器        QPushButton#btn            匹配所有对象名称(ObjectName)为&quot;btn&quot;的QPushButon控件，可以调用setobjectName()方法设置对象名称。虽然不同的控件可以设置相同的对象名称，但是不建议这样做</span><br><span class="line">后代选择器      QWidget.QPushButton        匹配所有QWidget控件中包含(无论是直接包合还是间接包合)的QPushButton控件</span><br><span class="line">子选择器        QWidget&gt;QPushButton        匹配所有QWidget控件中直接包合的QPushButton控件</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line"></span><br><span class="line">        self.btn1 = QPushButton(&#x27;button1&#x27;, self)</span><br><span class="line">        self.btn2 = QPushButton(&#x27;button2&#x27;, self)</span><br><span class="line">        self.btn2.setProperty(&#x27;name&#x27;, &#x27;btn&#x27;) #设置了一个自定义属性name，并将该属性的值设为“btn”，所以property(&#x27;name&#x27;)输出的值就是“btn”，“button2”按钮的背景颜色就为绿色。</span><br><span class="line">        print(self.btn2.property(&#x27;name&#x27;))          #注释1结束</span><br><span class="line"></span><br><span class="line">        self.line_edit1 = QLineEdit(self)</span><br><span class="line">        self.line_edit1.setPlaceholderText(&#x27;line edit&#x27;)</span><br><span class="line">        self.line_edit2 = SubLineEdit()</span><br><span class="line"></span><br><span class="line">        self.combo_box = QComboBox(self)           # 下拉框</span><br><span class="line">        self.combo_box.addItems([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;]) # 下拉列表</span><br><span class="line">        self.combo_box.setObjectName(&#x27;cb&#x27;)         #下拉列表框调用了setObjectName()方法将对象名称设置为“cb”</span><br><span class="line">        # 这样就匹配到了QComboBox#cb &#123;color: blue;&#125;</span><br><span class="line"></span><br><span class="line">        self.group_box = QGroupBox()               # label1是直接被添加到QGroupBox中</span><br><span class="line">        self.label1 = QLabel(&#x27;label1&#x27;)             # 匹配的是“QGroupBox QLabel &#123;color:blue;&#125;”和“QGroupBox &gt; QLabel &#123;font: 30px;&#125;”这两个样式</span><br><span class="line">        self.label2 = QLabel(&#x27;label2&#x27;)             # 通过一个QStackWidget被添加到QGroupBox中的，所以算是间接包含，只匹配前者。</span><br><span class="line">        self.stack = QStackedWidget()</span><br><span class="line">        self.stack.addWidget(self.label2)          #而label2则是通过一个QStackWidget被添加到QGroupBox中的</span><br><span class="line"></span><br><span class="line">        gb_layout = QVBoxLayout()</span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        gb_layout.addWidget(self.label1)</span><br><span class="line">        gb_layout.addWidget(self.stack)</span><br><span class="line">        self.group_box.setLayout(gb_layout)</span><br><span class="line">        v_layout.addWidget(self.btn1)</span><br><span class="line">        v_layout.addWidget(self.btn2)</span><br><span class="line">        v_layout.addWidget(self.line_edit1)</span><br><span class="line">        v_layout.addWidget(self.line_edit2)</span><br><span class="line">        v_layout.addWidget(self.combo_box)</span><br><span class="line">        v_layout.addWidget(self.group_box)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">class SubLineEdit(QLineEdit):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(SubLineEdit, self).__init__()</span><br><span class="line">        self.setPlaceholderText(&#x27;sub line edit&#x27;)</span><br><span class="line">        </span><br><span class="line">    # 明明“* &#123;color: red&#125;”这个样式是把所有的文本颜色设为红色，但是有些控件的文本颜色并没有改变，</span><br><span class="line">    # 比如QComboBox上的文本颜色就是蓝色。这里就涉及“具体与笼统”的概念，当选择器写得越具体时，</span><br><span class="line">    # 选择器的优先程度就越高。通配符*这一选择器写法非常笼统，而之后几个样式的选择器都是指定了控件名称的，</span><br><span class="line">    # 比通配符更加具体，所以优先程度更高。再比如这两个样式：</span><br><span class="line">    </span><br><span class="line">    # QPushButton &#123;background-color: blue;&#125;</span><br><span class="line">    # QPushButton[name=&#x27;btn&#x27;] &#123;background-color: green;&#125;</span><br><span class="line">    </span><br><span class="line">    # 第一个样式规定所有QPushButton控件及其子类的背景颜色变为蓝色，</span><br><span class="line">    # 但第二个样式指定了name属性，比第一个样式更加具体，所以匹配到该选择器的按钮控件背景颜色为绿色，不会遵循第一个样式。</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&#x27;style1.qss&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        qss = f.read()</span><br><span class="line"></span><br><span class="line">    app = QApplication([])</span><br><span class="line">    app.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec())</span><br></pre></td></tr></table></figure><h3 id="6-8-4-子控制器"><a href="#6-8-4-子控制器" class="headerlink" title="6.8.4 子控制器"></a>6.8.4 子控制器</h3><p>PyQt提供的原生控件其实可以被细分成不同的子控件，比如QSpinBox数字调节框控件，<br>它就包含一个单行文本框控件、向上调节按钮控件和向下调节按钮控件。<br>QSS中有丰富的属性用来修改输入框样式或其中的文本样式，但是这两个调节按钮控件似乎不那么容易被获取到。<br>此时就应该使用子控制器，它是QSS中独有的（CSS中没有子控制器这一概念），用来设置窗口或控件的子控件样式。<br>子控制器的出现能够让QSS更深入地改变界面样式。<br>QSpinBox的向上调节按钮控件和向下调节按钮控件可以分别通过::up-button和::down-button获取到（子控制器用两个冒号::获取）。<br>示例代码通过子控制器改变了这两个按钮控件的样式，首先我们在style.qss中输入以下内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.spin_box = QSpinBox(self)</span><br><span class="line">        self.spin_box.resize(100, 30)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&#x27;style2.qss&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        qss = f.read()</span><br><span class="line"></span><br><span class="line">    app = QApplication([])</span><br><span class="line">    app.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec())</span><br></pre></td></tr></table></figure><h3 id="6-8-5-伪状态"><a href="#6-8-5-伪状态" class="headerlink" title="6.8.5 伪状态"></a>6.8.5 伪状态</h3><p>控件会根据用户的不同操作呈现出不同的状态，这些状态也被称为“伪状态”。<br>比方说QPushButton按钮控件，当我们单击按钮时，它处于被按下的状态(pressed)。<br>如果调用setEnabled(False)禁用按钮，那它就处于禁用状态(disabled)。<br>PyQt提供了很多伪状态选择器以方便我们对不同状态下的控件样式进行修改，<br>比如要修改按钮被禁用时的样式，就可以先用:disabled获取到禁用状态（伪状态用一个冒号:获取）。<br>示例代码通过伪状态选择器改变了按钮在不同状态下的样式，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">from PyQt5.QtNetwork import *</span><br><span class="line">        </span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.btn = QPushButton(&#x27;button&#x27;, self)</span><br><span class="line">        self.btn.clicked.connect(lambda: self.btn.setEnabled(False))</span><br><span class="line"></span><br><span class="line"># 我们可以在伪状态前加一个英文格式的感叹号“!”来表示相反的状态，比方说在悬停状态前加一个“!”，像下面这样。</span><br><span class="line">#QPushButton:!hover &#123;</span><br><span class="line">#     background-color: red;</span><br><span class="line"># &#125;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&#x27;style3.qss&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">        qss = f.read()</span><br><span class="line"></span><br><span class="line">    app = QApplication([])</span><br><span class="line">    app.setStyleSheet(qss)</span><br><span class="line"></span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec())</span><br></pre></td></tr></table></figure><h3 id="6-8-6-QSS第三方库"><a href="#6-8-6-QSS第三方库" class="headerlink" title="6.8.6 QSS第三方库"></a>6.8.6 QSS第三方库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># 1.Qt-Material  提供了许多仿Material的界面样式          pip install qt-material</span><br><span class="line"># 导入   from qt_material import apply_stylesheet </span><br><span class="line"># =============================================================================</span><br><span class="line"># class Window(QWidget):</span><br><span class="line">#     def __init__(self):</span><br><span class="line">#         super(Window, self).__init__()</span><br><span class="line">#         self.btn = QPushButton(&#x27;BUTTON&#x27;, self)</span><br><span class="line"># 　</span><br><span class="line"># if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">#     app = QApplication([])</span><br><span class="line">#     apply_stylesheet(app, theme=&#x27;dark_teal.xml&#x27;)# 1</span><br><span class="line"># 　</span><br><span class="line">#     window = Window()</span><br><span class="line">#     window.show()</span><br><span class="line">#     sys.exit(app.exec())</span><br><span class="line"># =============================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 2.QDarkStyleSheet 它提供了完整的明暗系列主题          pip install qdarkstyle</span><br><span class="line"># 导入    import qdarkstyle</span><br><span class="line"># =============================================================================</span><br><span class="line"># class Window(QWidget):</span><br><span class="line">#     def __init__(self):</span><br><span class="line">#         super(Window, self).__init__()</span><br><span class="line">#         self.btn = QPushButton(&#x27;button&#x27;, self)</span><br><span class="line"># 　</span><br><span class="line"># if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">#     app = QApplication([])</span><br><span class="line">#     qss = qdarkstyle.load_stylesheet() #注释1开始</span><br><span class="line">#     app.setStyleSheet(qss)             #注释1结束</span><br><span class="line"># 　</span><br><span class="line">#     window = Window()</span><br><span class="line">#     window.show()</span><br><span class="line">#     sys.exit(app.exec())</span><br><span class="line"># =============================================================================</span><br><span class="line"></span><br><span class="line"># #1 程序首先调用load_stylesheet()方法获取QSS样式，然后将它传入QApplication对象的setStyleSheet()方法中。</span><br><span class="line"># 如果要切换为明亮主题，只需要往load_stylesheet()方法中传入qdarkstyle.LightPalette，</span><br><span class="line"># 该方法默认使用的是黑暗主题qdarkstyle.DarkPalette。</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-9-1-国际化-使用translate-方法"><a href="#6-9-1-国际化-使用translate-方法" class="headerlink" title="6.9.1 国际化-使用translate()方法"></a>6.9.1 国际化-使用translate()方法</h2><p>当我们给控件设置文本时，会调用setText()方法并传入相应的文本。<br>为了能让PyQt提取出要翻译的文本，我们要先对各个文本字符串使用QCoreApplication.translate()方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.combo_box = QComboBox()</span><br><span class="line">        self.combo_box.addItems([&#x27;English&#x27;, &#x27;中文&#x27;])</span><br><span class="line">        self.button = QPushButton()</span><br><span class="line">        self.label = QLabel()</span><br><span class="line">        self.label.setAlignment(Qt.AlignCenter)</span><br><span class="line"></span><br><span class="line">        v_layout = QVBoxLayout()</span><br><span class="line">        v_layout.addWidget(self.combo_box)</span><br><span class="line">        v_layout.addWidget(self.button)</span><br><span class="line">        v_layout.addWidget(self.label)</span><br><span class="line">        self.setLayout(v_layout)</span><br><span class="line"></span><br><span class="line">        self.retranslateUi() </span><br><span class="line"></span><br><span class="line">    def retranslateUi(self):             # 专门定义了一个retranslateUi()函数来更新控件的文本。</span><br><span class="line">        _translate = QCoreApplication.translate  # 将QCoreApplication.translate保存到_translate变量中，这样可以让我们更加方便使用它</span><br><span class="line">        self.setWindowTitle(_translate(&#x27;Window&#x27;, &#x27;Switch&#x27;)) # _translate()方法接收的第一个参数是待翻译文本所在的类名称，第二个参数是待翻译文本</span><br><span class="line">        self.button.setText(_translate(&#x27;Window&#x27;, &#x27;Start&#x27;))</span><br><span class="line">        self.label.setText(_translate(&#x27;Window&#x27;, &#x27;Hello World!&#x27;))</span><br><span class="line">        # 当我们将设计师生成的.ui文件转换为.py文件后，其实也可以看到这个名称为retranslateUi的函数，</span><br><span class="line">        # 它是专门用来更新界面上的文本的。</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="6-9-2-制作-ts文件"><a href="#6-9-2-制作-ts文件" class="headerlink" title="6.9.2 制作.ts文件"></a>6.9.2 制作.ts文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line"> #跳过</span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="7-1-图形图元类QGraphicsItem-标准图元"><a href="#7-1-图形图元类QGraphicsItem-标准图元" class="headerlink" title="7.1 图形图元类QGraphicsItem-标准图元"></a>7.1 图形图元类QGraphicsItem-标准图元</h2><p>第7章　<br>图形视图框架PyQt提供的图形视图框架可以让我们方便地管理大量的自定义2D图元并与之进行交互。<br>该框架使用BSP（Binary Space Partitioning，二叉空间剖分）树，能够快速查找图形元素。<br>因此，就算视图中包含大量的内容，我们也可以在界面上快速地操作它们。除此之外，<br>该框架还提供了图元放大、缩小、旋转和碰撞检测的相关方法，非常适合用来开发游戏。</p><p>图形视图框架主要包含3个类：<br>图形图元类QGraphicsItem、图形场景类QGraphicsScene和图形视图类QGraphicsView。</p><p>用简单的一句话来概括一下三者的关系：<br>图元是放在场景上的，而场景内容则是通过视图显示出来的。</p><p>PyQt标准图元：<br>● 椭圆图元QGraphicsEllipseItem。<br>● 直线图元QGraphicsLineItem。<br>● 路径图元QGraphicsPathItem。<br>● 图片图元QGraphicsPixmapItem。<br>● 多边形图元QGraphicsPolygonItem。<br>● 矩形图元QGraphicsRectItem。<br>● 纯文本图元QGraphicsSimpleTextItem。<br>● 富文本图元QGraphicsTextItem。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView): # 场景内容通过视图显示出来，所以我们直接继承QGraphicsView来开发这个窗口</span><br><span class="line">    def __init__(self): </span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.ellipse = QGraphicsEllipseItem() # 矩形图元</span><br><span class="line">        self.ellipse.setRect(0, 100, 50, 100)</span><br><span class="line"></span><br><span class="line">        self.line = QGraphicsLineItem()  # 直线图元</span><br><span class="line">        self.line.setLine(100, 100, 100, 200)</span><br><span class="line"></span><br><span class="line">        self.path = QGraphicsPathItem()  # 路径图元</span><br><span class="line">        tri_path = QPainterPath()</span><br><span class="line">        tri_path.moveTo(150, 100)</span><br><span class="line">        tri_path.lineTo(200, 100)</span><br><span class="line">        tri_path.lineTo(200, 200)</span><br><span class="line">        tri_path.lineTo(150, 100)</span><br><span class="line">        tri_path.closeSubpath()</span><br><span class="line">        self.path.setPath(tri_path)</span><br><span class="line"></span><br><span class="line">        self.pixmap = QGraphicsPixmapItem()   # 图片图元</span><br><span class="line">        self.pixmap.setPixmap(QPixmap(&#x27;11.png&#x27;).scaled(100, 100))  # 设置图片图元</span><br><span class="line">        self.pixmap.setPos(250, 100)                        # # 设置图元位置</span><br><span class="line">        self.pixmap.setFlags(QGraphicsItem.ItemIsMovable)   # 设置图元特征，传入参数QGraphicsItem.ItemIsMovable表示图元能够用鼠标来移动</span><br><span class="line">        # 所有图元都可以使用setFlags()来设置特征</span><br><span class="line">        # QGraphicsitem.ltemlsMovable        可以移动图元</span><br><span class="line">        # QGraphicsltem.ltemlsSelectable     可以选择图元，选择时图元周围会有一圈虚线</span><br><span class="line">        # QGraphicsltem.ltemlsFocusable      图元可以接收焦点</span><br><span class="line">        # QGraphicsltem.ltemClipsToShape     根据图元形状进行裁剪形状区域之外的区域无法被绘制，也不会触发鼠标事件、拖放事件</span><br><span class="line">        # QGraphicsltem.ltemClipsChildrenToShape    根据当前图元的形状进裁剪，该图元的直接或间接子图元都将限制在该形状区域内，无法在形状区域之外的区域进行绘制</span><br><span class="line">        # QGraphicsltem.ltemlgnoresParentOpacity    忽略父图元的透明度</span><br><span class="line">        # QGraphicsltem.ltemStacksBehindParent      当一个父图元添加子图时，子图元会被放置在父图元下面(默认是置于父图元上面的)。该特征很适合用来制作阴影效果</span><br><span class="line"></span><br><span class="line">        self.polygon = QGraphicsPolygonItem()  # 图片旁边的线图</span><br><span class="line">        point1 = QPointF(400.0, 100.0)</span><br><span class="line">        point2 = QPointF(420.0, 150.0)</span><br><span class="line">        point3 = QPointF(430.0, 200.0)</span><br><span class="line">        point4 = QPointF(380.0, 110.0)</span><br><span class="line">        point5 = QPointF(350.0, 110.0)</span><br><span class="line">        point6 = QPointF(400.0, 100.0)</span><br><span class="line">        self.polygon.setPolygon(QPolygonF([point1, point2, point3,point4, point5, point6]))</span><br><span class="line"></span><br><span class="line">        self.rect = QGraphicsRectItem() # 矩形图元</span><br><span class="line">        self.rect.setRect(450, 100, 50, 100)</span><br><span class="line"></span><br><span class="line">        self.simple_text = QGraphicsSimpleTextItem() # 纯文本图元</span><br><span class="line">        self.simple_text.setText(&#x27;Hello PyQt!&#x27;)</span><br><span class="line">        self.simple_text.setPos(550, 100)</span><br><span class="line"></span><br><span class="line">        self.rich_text = QGraphicsTextItem()  # 富文本图元</span><br><span class="line">        self.rich_text.setHtml(&#x27;&lt;p style=&quot;font-size:10px&quot;&gt;Hello PyQt!&lt;/p&gt;&#x27;)</span><br><span class="line">        self.rich_text.setPos(650, 100)</span><br><span class="line">        self.rich_text.setTextInteractionFlags(Qt.TextEditorInteraction) </span><br><span class="line">        # 文本图元有一个独有的setTextInteractionFlags()方法，它用来设置文本的交互特征，传入Qt.TextEditorInteraction表示用户能够直接通过双击来编辑文本</span><br><span class="line">        # Qt.NoTextlnteraction            无任何交互</span><br><span class="line">        # Qt.TextSelectableByMouse        文本可以通过鼠标或键盘选择和复制</span><br><span class="line">        # Qt.TextSelectableByKeyboard     文本可以通过键盘上的方向键选择</span><br><span class="line">        # Qt.LinksAccessibleByMouse        可以通过单击访问超链接</span><br><span class="line">        # Qt.LinksAccessibleByKeyboard    可以通过“Tab”键获取焦点并用“Enter键访问超链接</span><br><span class="line">        # Qt.TextEditable                 文本能够被完全编辑</span><br><span class="line">        # Qt.TextEditorlnteraction        行为与QTextEdit控件相同</span><br><span class="line">        # Qt.TextBrowserlnteraction       行为与QTextBrowser控件相同</span><br><span class="line">        self.rich_text.setDefaultTextColor(QColor(100, 100, 100)) # 设置文本颜色,只有富文本图元才拥有，纯文本图元无法设置文本颜色</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()             # 图元是要放到场景中的，所以需要实例化一个QGraphicsScene对象</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 750, 300)   # 设置场景大小</span><br><span class="line">        self.graphics_scene.addItem(self.ellipse)          # addItem()方法用来添加图元</span><br><span class="line">        self.graphics_scene.addItem(self.line)</span><br><span class="line">        self.graphics_scene.addItem(self.path)</span><br><span class="line">        self.graphics_scene.addItem(self.pixmap)</span><br><span class="line">        self.graphics_scene.addItem(self.polygon)</span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line">        self.graphics_scene.addItem(self.simple_text)</span><br><span class="line">        self.graphics_scene.addItem(self.rich_text)   </span><br><span class="line"></span><br><span class="line">        self.resize(750, 300)                          # 场景内容通过视图显示出来，所以我们直接继承QGraphicsView来开发这个窗口，resize()方法用来设置视图大小</span><br><span class="line">        self.setScene(self.graphics_scene)             # setScene()用来确定要显示的场景</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-1-2-图元层级"><a href="#7-1-2-图元层级" class="headerlink" title="7.1.2 图元层级"></a>7.1.2 图元层级</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.rect1 = QGraphicsRectItem()        # 程序实例化了3个矩形图元</span><br><span class="line">        self.rect1.setRect(0, 0, 200, 200)</span><br><span class="line">        self.rect1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.rect1.setFlags(QGraphicsItem.ItemIsMovable)</span><br><span class="line">        self.rect1.setZValue(1.0)     # rect1矩形图元对象调用了setZValue()方法改变了自身的层级大小</span><br><span class="line"></span><br><span class="line">        self.rect2 = QGraphicsRectItem()</span><br><span class="line">        self.rect2.setRect(0, 0, 100, 100)</span><br><span class="line">        self.rect2.setBrush(QBrush(QColor(0, 255, 0)))</span><br><span class="line">        self.rect2.setFlags(QGraphicsItem.ItemIsMovable)</span><br><span class="line"></span><br><span class="line">        self.rect3 = QGraphicsRectItem()</span><br><span class="line">        self.rect3.setRect(0, 0, 50, 50)</span><br><span class="line">        self.rect3.setBrush(QBrush(QColor(0, 0, 255)))</span><br><span class="line">        self.rect3.setFlags(QGraphicsItem.ItemIsMovable)  </span><br><span class="line">        # 默认rect3会遮挡rect2，rect2会遮挡rect1。</span><br><span class="line">        # 但是rect1矩形图元对象调用了setZValue()方法改变了自身的层级大小，且层级大于rect2和rec3，</span><br><span class="line">        # 也就是rect1会遮挡住rect2和rect3。</span><br><span class="line"></span><br><span class="line">        print(self.rect1.zValue()) #  zValue()方法用来获取一个图元的层级大小</span><br><span class="line">        print(self.rect2.zValue())</span><br><span class="line">        print(self.rect3.zValue()) </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500,500)</span><br><span class="line">        self.graphics_scene.addItem(self.rect1)</span><br><span class="line">        self.graphics_scene.addItem(self.rect2)</span><br><span class="line">        self.graphics_scene.addItem(self.rect3)</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line">        # 添加到场景中的顺序为rect1、rect2、rect3，所以默认rect3会遮挡rect2，rect2会遮挡rect1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-1-2-图元层级—父图元会被子图元遮挡"><a href="#7-1-2-图元层级—父图元会被子图元遮挡" class="headerlink" title="7.1.2 图元层级—父图元会被子图元遮挡"></a>7.1.2 图元层级—父图元会被子图元遮挡</h3><p>父图元会被子图元遮挡，而且父图元无法通过setZValue()方法改变这种遮挡情况</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.rect1 = QGraphicsRectItem()</span><br><span class="line">        self.rect1.setRect(0, 0, 200, 200)</span><br><span class="line">        self.rect1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.rect1.setFlags(QGraphicsItem.ItemIsMovable)</span><br><span class="line">        self.rect1.setZValue(2.0)</span><br><span class="line"></span><br><span class="line">        self.rect2 = QGraphicsRectItem()</span><br><span class="line">        self.rect2.setRect(0, 0, 100, 100)</span><br><span class="line">        self.rect2.setBrush(QBrush(QColor(0, 255, 0)))</span><br><span class="line">        self.rect2.setFlags(QGraphicsItem.ItemIsMovable)</span><br><span class="line">        self.rect2.setParentItem(self.rect1)   # rect2和rect3通过setParentItem()方法确定rect1为它们的父图元</span><br><span class="line">        self.rect2.setZValue(1.0)</span><br><span class="line">        # rect2比rect3先被添加到父图元上，所以目前的遮挡情况是：rect3遮挡rect2，rect2遮挡rect1</span><br><span class="line">        self.rect3 = QGraphicsRectItem()</span><br><span class="line">        self.rect3.setRect(0, 0, 50, 50)</span><br><span class="line">        self.rect3.setBrush(QBrush(QColor(0, 0, 255)))</span><br><span class="line">        self.rect3.setFlags(QGraphicsItem.ItemIsMovable)</span><br><span class="line">        self.rect3.setParentItem(self.rect1)   # rect2和rect3通过setParentItem()方法确定rect1为它们的父图元</span><br><span class="line"></span><br><span class="line">        print(self.rect1.zValue())</span><br><span class="line">        print(self.rect2.zValue())</span><br><span class="line">        print(self.rect3.zValue())</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500,500)</span><br><span class="line">        self.graphics_scene.addItem(self.rect1)# 在往场景中添加图元时，我们只需要添加rect1即可，剩下的几个矩形图元都会根据父子关系自动被添加到场景中。</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line">        # 可以通过QGraphicsItem.ItemStacksBehindParent来改变父子图元的遮挡情况。</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-1-3-图元变换"><a href="#7-1-3-图元变换" class="headerlink" title="7.1.3 图元变换"></a>7.1.3 图元变换</h3><p>学习如何将平移、缩放和旋转这3种变换应用到图元上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        </span><br><span class="line">        self.rect1 = QGraphicsRectItem()</span><br><span class="line">        self.rect1.setRect(0, 0, 200, 200)</span><br><span class="line">        self.rect1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.rect1.moveBy(100, 100)    # 平移图元（图元在场景上的x轴和y轴上的移动距离）</span><br><span class="line">        self.rect1.setScale(1.5)       # 缩放图元 传入0会将图元缩小成一个点，传入负数则会返回图元翻转和镜像化后的样子</span><br><span class="line">        self.rect1.setRotation(45)     # 旋转图元 [-360, 360]</span><br><span class="line">        self.rect1.setTransformOriginPoint(100,100)   # 改变图元的中心点 缩放和旋转的中心点默认为(0, 0)，也就是图元的左上角</span><br><span class="line"># setTransformOriginPoint()方法是根据图元的原始大小来设置中心点的，缩放操作不会对该方法产生影响。</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500, 500)</span><br><span class="line">        self.graphics_scene.addItem(self.rect1)</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-1-4-图元分组"><a href="#7-1-4-图元分组" class="headerlink" title="7.1.4 图元分组"></a>7.1.4 图元分组</h3><p>分组就是指对各个图元进行分类，分到一起的图元会共同行动（选中、移动或复制等）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView): # rect1和ellipse1为一组，rect2和ellipse2为另一组</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.rect1 = QGraphicsRectItem() # 实例化矩形图元</span><br><span class="line">        self.rect2 = QGraphicsRectItem()</span><br><span class="line">        self.ellipse1 = QGraphicsEllipseItem() # 实例化椭圆图元</span><br><span class="line">        self.ellipse2 = QGraphicsEllipseItem()</span><br><span class="line">        self.rect1.setRect(10, 10, 100, 100)</span><br><span class="line">        self.rect1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.rect2.setRect(150, 10, 100, 100)</span><br><span class="line">        self.rect2.setBrush(QBrush(QColor(0, 0, 255)))</span><br><span class="line">        self.ellipse1.setRect(10, 150, 100, 50)</span><br><span class="line">        self.ellipse1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.ellipse2.setRect(150, 150, 100, 50)</span><br><span class="line">        self.ellipse2.setBrush(QBrush(QColor(0, 0, 255)))</span><br><span class="line"></span><br><span class="line">        self.group1 = QGraphicsItemGroup()                # 实例化两个QGraphicsItemGroup分组对象</span><br><span class="line">        self.group2 = QGraphicsItemGroup()</span><br><span class="line">        self.group1.addToGroup(self.rect1)</span><br><span class="line">        self.group1.addToGroup(self.ellipse1)</span><br><span class="line">        self.group1.setFlags(QGraphicsItem.ItemIsSelectable | QGraphicsItem.ItemIsMovable)</span><br><span class="line">        self.group2.addToGroup(self.rect2)</span><br><span class="line">        self.group2.addToGroup(self.ellipse2)</span><br><span class="line">        self.group2.setFlags(QGraphicsItem.ItemIsSelectable | QGraphicsItem.ItemIsMovable) #注释1结束</span><br><span class="line"></span><br><span class="line">        print(self.group1.boundingRect())                 #注释2开始</span><br><span class="line">        print(self.group2.boundingRect())                 #注释2结束</span><br><span class="line">        # 选中时，分组边界的大小是由组内的图元整体决定的，边界的位置和大小可以通过boundingRect()方法获取到。</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500, 500)</span><br><span class="line">        self.graphics_scene.addItem(self.group1)          # 调用场景对象的addItem()方法将分组添加到场景中</span><br><span class="line">        self.graphics_scene.addItem(self.group2)          </span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-1-5-碰撞检测"><a href="#7-1-5-碰撞检测" class="headerlink" title="7.1.5 碰撞检测"></a>7.1.5 碰撞检测</h3><p>碰撞检测通常会在游戏中出现，比如在《飞机大战》游戏中，程序会对子弹和敌机进行碰撞检测。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.rect = QGraphicsRectItem()                      # 界面上有一个矩形图元和一个椭圆图元，两者都可以被移动和选中。</span><br><span class="line">        self.ellipse = QGraphicsEllipseItem()</span><br><span class="line">        self.rect.setRect(100, 100, 150, 130)</span><br><span class="line">        self.rect.setFlags(QGraphicsItem.ItemIsMovable | QGraphicsItem.ItemIsSelectable)</span><br><span class="line">        self.ellipse.setRect(100, 300, 150, 100)</span><br><span class="line">        self.ellipse.setFlags(QGraphicsItem.ItemIsMovable | QGraphicsItem.ItemIsSelectable)#注释1结束</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500, 500)</span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line">        self.graphics_scene.addItem(self.ellipse)</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">    def mouseMoveEvent(self, event):       # 2</span><br><span class="line">        super(Window, self).mouseMoveEvent(event)</span><br><span class="line">        if self.ellipse.collidesWithItem(self.rect, Qt.IntersectsItemShape): # 当ellipse本身的轮廓与rect的轮廓相交时，collidesWithItem()方法就会返回True。</span><br><span class="line">            print(self.ellipse.collidingItems(Qt.IntersectsItemShape))  # collidingItems()方法会返回与ellipse图元发生碰撞的图元列表。</span><br><span class="line">            # 碰撞的检测方式</span><br><span class="line">            # Qt.ContainsItemShape          以形状为范围，当前图元被其他图元完全包含</span><br><span class="line">            # Qt.IntersectsItemShape        以形状为范围，当前图元被完全包含或者与其他图元有重圣</span><br><span class="line">            # Qt.ContainsItemBoundingRect   以矩形边界为范围，当前图元被其他图元完全包合</span><br><span class="line">            # Qt.IntersectsItemBoundingRect 以矩形进界为范围，当前图元被完全包含或者与其他图元有重叠</span><br><span class="line">            </span><br><span class="line">            # 矩形边界就是当我们选中某图元时周围显示的矩形虚线，可以用boundingRect()方法获取到</span><br><span class="line">            # 而形状就是图元本身的轮廓，可以用shape()方法获取到</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-1-6-给图元添加信号和动画"><a href="#7-1-6-给图元添加信号和动画" class="headerlink" title="7.1.6 给图元添加信号和动画"></a>7.1.6 给图元添加信号和动画</h3><p>QGraphicsItem不继承QObject，所以本身并不能使用信号和槽机制，我们也无法给它添加动画，<br>不过PyQt提供了QGraphicsObject类好让我们解决这一问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">            </span><br><span class="line">class MyRectItem(QGraphicsObject):                     # 继承QGraphicsObject</span><br><span class="line">    my_signal = pyqtSignal()</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(MyRectItem, self).__init__()</span><br><span class="line"></span><br><span class="line">    def boundingRect(self):                            # 重写</span><br><span class="line">        return QRectF(0, 0, 100, 30)                   # 返回一个QRectF类型的值来确定矩形图元的初始位置和大小</span><br><span class="line"></span><br><span class="line">    def paint(self, painter, styles, widget=None):     # 重写</span><br><span class="line">        painter.drawRect(self.boundingRect())          # 调用drawRect()方法将矩形画到界面上。</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.rect = MyRectItem()                       # 实例化一个MyRectItem对象</span><br><span class="line">        self.rect.my_signal.connect(lambda: print(&#x27;signal and slot&#x27;)) # 应用信号</span><br><span class="line">        self.rect.my_signal.emit()</span><br><span class="line"></span><br><span class="line">        self.animation = QPropertyAnimation(self.rect, b&#x27;pos&#x27;) # 动画</span><br><span class="line">        self.animation.setDuration(3000)</span><br><span class="line">        self.animation.setStartValue(QPointF(100, 30))</span><br><span class="line">        self.animation.setEndValue(QPointF(100, 200))</span><br><span class="line">        self.animation.setLoopCount(-1)</span><br><span class="line">        self.animation.start()  #注释4结束</span><br><span class="line"></span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 500, 500)</span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="7-2-图形场景类QGraphicsScene"><a href="#7-2-图形场景类QGraphicsScene" class="headerlink" title="7.2 图形场景类QGraphicsScene"></a>7.2 图形场景类QGraphicsScene</h2><p>我们可以把场景看作一个大容器，它能够容纳大量的图元，并提供相应的方法来对图元进行管理。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-2-1-管理图元"><a href="#7-2-1-管理图元" class="headerlink" title="7.2.1 管理图元"></a>7.2.1 管理图元</h3><p>QGraphicsScene类提供了快速添加、查找和删除图元的相关方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">            </span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()     # 实例化场景</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 300, 300)</span><br><span class="line">        self.graphics_scene.focusItemChanged.connect(self.show_item)# 1</span><br><span class="line">        # 场景有一个focusItemChanged信号，当我们选中不同的图元时，该信号就会发射，并传递两个值：</span><br><span class="line">        # 第一个是新选中的图元，第二个是之前选中的图元</span><br><span class="line">        # 注意，该信号只针对设置了ItemIsFocusable特征的图元。场景也提供了focusItem()方法让我们直接获取到当前新选中的图元。</span><br><span class="line"></span><br><span class="line">        self.ellipse = self.graphics_scene.addEllipse(50, 100, 50, 100) # 直接调用场景的相应方法来添加不同类型的图元  椭圆图元</span><br><span class="line">        self.ellipse.setFlags(QGraphicsItem.ItemIsFocusable)</span><br><span class="line">        self.rect = self.graphics_scene.addRect(150, 100, 100, 100)   # 矩形图元</span><br><span class="line">        self.rect.setFlags(QGraphicsItem.ItemIsFocusable)  </span><br><span class="line"></span><br><span class="line">        print(self.graphics_scene.items())                 </span><br><span class="line">        # items()方法会以列表形式返回场景中的所有图元，且默认按照降序方式(Qt.DescendingOrder)进行排列，即最顶层的图元排在列表最前面。</span><br><span class="line">        # 如果要按照升序方式进行排列，只需要往items()方法中传入Qt.AscendingOrder这个值</span><br><span class="line">        print(self.graphics_scene.itemsBoundingRect())     #  itemsBoundingRect()方法会返回包含所有图元的最小矩形边界</span><br><span class="line"></span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">    def show_item(self, new_item, old_item):</span><br><span class="line">        print(f&#x27;new item: &#123;new_item&#125;&#x27;)</span><br><span class="line">        print(f&#x27;old item: &#123;old_item&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):                      # 鼠标按下事件函数</span><br><span class="line">        super(Window, self).mousePressEvent(event)</span><br><span class="line">        pos = event.pos()                                      # 获取单击时鼠标指针的位置</span><br><span class="line">        item = self.graphics_scene.itemAt(pos, QTransform())   # 获取到当前单击的图元</span><br><span class="line">        # 第二个参数是QTransform类型的值，表示应用到视图上的变换，目前只需要传入QTranform()（也就是不应用任何变换）。</span><br><span class="line">        print(item)</span><br><span class="line"></span><br><span class="line">    def mouseDoubleClickEvent(self, event):                # 鼠标双击事件函数</span><br><span class="line">        super(Window, self).mouseDoubleClickEvent(event)</span><br><span class="line">        pos = event.pos()</span><br><span class="line">        item = self.graphics_scene.itemAt(pos, QTransform())   # itemAt()获取到当前双击的图元</span><br><span class="line">        if item:</span><br><span class="line">            self.graphics_scene.removeItem(item)  # 用removeItem()方法将其删除</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-2-2-嵌入控件"><a href="#7-2-2-嵌入控件" class="headerlink" title="7.2.2 嵌入控件"></a>7.2.2 嵌入控件</h3><p>我们还可以向场景中添加不同类型的控件，QGraphicsScene场景类专门提供了addWidget()方法用于实现此功能</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 220, 100)</span><br><span class="line"></span><br><span class="line">        self.label = QLabel(&#x27;label&#x27;)</span><br><span class="line">        self.button = QPushButton(&#x27;button&#x27;)</span><br><span class="line"></span><br><span class="line">        self.label_proxy = self.graphics_scene.addWidget(self.label) # 调用了addWidget()方法将QLabel和QPushButton控件添加到场景中</span><br><span class="line">       # 该方法返回一个QGraphicsProxyWidget控件代理对象，它可以被看作场景中的一个图元，而我们可以通过控制代理对象来操作控件。</span><br><span class="line">        self.button_proxy = self.graphics_scene.addWidget(self.button)</span><br><span class="line">        self.label_proxy.setPos(10, 20)</span><br><span class="line">        self.button_proxy.setPos(50, 20)</span><br><span class="line">        </span><br><span class="line">        # 控件的背景是灰色的，与场景的白色背景不搭。可以在程序中添加以下两行代码使控件背景透明化</span><br><span class="line">        self.label.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.button.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line"></span><br><span class="line">        self.resize(220, 80)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line">            </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-2-2-嵌入控件-使用布局管理器排列控件"><a href="#7-2-2-嵌入控件-使用布局管理器排列控件" class="headerlink" title="7.2.2 嵌入控件-使用布局管理器排列控件"></a>7.2.2 嵌入控件-使用布局管理器排列控件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line">            </span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 260, 80)</span><br><span class="line"></span><br><span class="line">        self.user_label = QLabel(&#x27;Username:&#x27;)</span><br><span class="line">        self.pass_label = QLabel(&#x27;Password:&#x27;)</span><br><span class="line">        self.user_line = QLineEdit()</span><br><span class="line">        self.pass_line = QLineEdit()</span><br><span class="line">        self.user_label.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.pass_label.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.user_line.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.pass_line.setAttribute(Qt.WA_TranslucentBackground)</span><br><span class="line">        self.user_label_proxy = self.graphics_scene.addWidget(self.user_label)</span><br><span class="line">        self.pass_label_proxy = self.graphics_scene.addWidget(self.pass_label)</span><br><span class="line">        self.user_line_proxy = self.graphics_scene.addWidget(self.user_line)</span><br><span class="line">        self.pass_line_proxy = self.graphics_scene.addWidget(self.pass_line)</span><br><span class="line"></span><br><span class="line">        linear_layout1 = QGraphicsLinearLayout()   # 使用线性布局管理器，默认水平布局方向</span><br><span class="line">        linear_layout2 = QGraphicsLinearLayout()</span><br><span class="line">        linear_layout3 = QGraphicsLinearLayout()</span><br><span class="line">        linear_layout3.setOrientation(Qt.Vertical) # 通过setOrientation()方法改变布局方向。</span><br><span class="line">        # 图形视图框架还提供了QGraphicsGridLayout网格布局管理器和QGraphicsAnchorLayout锚点布局管理器。</span><br><span class="line">        </span><br><span class="line">        linear_layout1.addItem(self.user_label_proxy)</span><br><span class="line">        linear_layout1.addItem(self.user_line_proxy)</span><br><span class="line">        linear_layout2.addItem(self.pass_label_proxy)</span><br><span class="line">        linear_layout2.addItem(self.pass_line_proxy)</span><br><span class="line">        linear_layout3.addItem(linear_layout1)</span><br><span class="line">        linear_layout3.addItem(linear_layout2)</span><br><span class="line"></span><br><span class="line">        graphics_widget = QGraphicsWidget()           # 将布局设置到QGraphicsWidget对象上</span><br><span class="line">        graphics_widget.setLayout(linear_layout3)</span><br><span class="line">        self.graphics_scene.addItem(graphics_widget)  # 将QGraphicsWidget对象添加到场景</span><br><span class="line"></span><br><span class="line">        self.resize(260, 80)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="7-3-图形视图类QGraphicsView"><a href="#7-3-图形视图类QGraphicsView" class="headerlink" title="7.3 图形视图类QGraphicsView"></a>7.3 图形视图类QGraphicsView</h2><p>QGraphicsView用来显示场景内容，它是一个提供了滚动条的视窗。<br>多个场景可以通过同一个图形视图来切换显示，而同一个场景也可以应用多个图形视图，让我们能够从不同的角度同时进行观察</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-3-1-视图和场景的大小关系"><a href="#7-3-1-视图和场景的大小关系" class="headerlink" title="7.3.1 视图和场景的大小关系"></a>7.3.1 视图和场景的大小关系</h3><p>在之前的示例代码中，场景和视图的大小都是一样的。如果场景大小大于等于视图大小，<br>视图则会显示垂直或水平滚动条供用户浏览剩余场景内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window1(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window1, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 300, 300)# 1</span><br><span class="line"></span><br><span class="line">        self.rect = QGraphicsRectItem()</span><br><span class="line">        self.rect.setRect(220, 220, 50, 50)</span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line"></span><br><span class="line">        self.resize(200, 200)                           # 2</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line"># 当场景大小等于视图大小时，如果我们想要去掉滚动条，只需要用QSS把QGraphicsView的边框border属性的值设置为0即可</span><br><span class="line">class Window2(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window2, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 400, 400)</span><br><span class="line"></span><br><span class="line">        self.rect = QGraphicsRectItem()</span><br><span class="line">        self.rect.setRect(0, 0, 50, 50)</span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line"></span><br><span class="line">        self.graphics_view = QGraphicsView(self)</span><br><span class="line">        self.graphics_view.resize(200, 200)</span><br><span class="line">        self.graphics_view.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">        qss = &quot;QGraphicsView &#123; border: 0px; &#125;&quot;</span><br><span class="line">        self.graphics_view.setStyleSheet(qss)</span><br><span class="line">        </span><br><span class="line"># 如果场景大小小于视图大小，那视图就会默认居中显示场景内容</span><br><span class="line">class Window3(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window3, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 100, 100)</span><br><span class="line"></span><br><span class="line">        self.rect1 = QGraphicsRectItem()</span><br><span class="line">        self.rect1.setRect(0, 0, 50, 50)</span><br><span class="line">        self.rect1.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.rect2 = QGraphicsRectItem()</span><br><span class="line">        self.rect2.setRect(0, 50, 50, 50)</span><br><span class="line">        self.rect2.setBrush(QBrush(QColor(0, 255, 0)))</span><br><span class="line">        self.rect3 = QGraphicsRectItem()</span><br><span class="line">        self.rect3.setRect(50, 0, 50, 50)</span><br><span class="line">        self.rect3.setBrush(QBrush(QColor(0, 0, 255)))</span><br><span class="line">        self.rect4 = QGraphicsRectItem()</span><br><span class="line">        self.rect4.setRect(50, 50, 50, 50)</span><br><span class="line">        self.rect4.setBrush(QBrush(QColor(255, 0, 255)))</span><br><span class="line"></span><br><span class="line">        self.graphics_scene.addItem(self.rect1)</span><br><span class="line">        self.graphics_scene.addItem(self.rect2)</span><br><span class="line">        self.graphics_scene.addItem(self.rect3)</span><br><span class="line">        self.graphics_scene.addItem(self.rect4)</span><br><span class="line"></span><br><span class="line">        self.resize(200, 200)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window3()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-3-2-视图变换"><a href="#7-3-2-视图变换" class="headerlink" title="7.3.2 视图变换"></a>7.3.2 视图变换</h3><p>在视图上执行的平移、缩放和旋转变换会作用在所有图元上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 300, 300)</span><br><span class="line"></span><br><span class="line">        self.rect = QGraphicsRectItem()</span><br><span class="line">        self.rect.setRect(50, 50, 50, 50)</span><br><span class="line">        self.rect.setBrush(QBrush(QColor(255, 0, 0)))</span><br><span class="line">        self.ellipse = QGraphicsEllipseItem()</span><br><span class="line">        self.ellipse.setRect(100, 100, 50, 50)</span><br><span class="line">        self.ellipse.setBrush(QBrush(QColor(0, 255, 0)))</span><br><span class="line"></span><br><span class="line">        self.graphics_scene.addItem(self.rect)</span><br><span class="line">        self.graphics_scene.addItem(self.ellipse)</span><br><span class="line"></span><br><span class="line">        self.move(10, 10)</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      #  调用rotate(10)将视图顺时针旋转10°</span><br><span class="line">        self.rotate(10)</span><br><span class="line"></span><br><span class="line">    def wheelEvent(self, event):           # 鼠标滚轮事件函数</span><br><span class="line">        if event.angleDelta().y() &lt; 0:</span><br><span class="line">            self.scale(0.9, 0.9)          # 通过scale()方法改变视图大小</span><br><span class="line">        else:</span><br><span class="line">            self.scale(1.1, 1.1)</span><br><span class="line">        # 平移视图可以使用move()方法，平移视图也就是指改变窗口在计算机屏幕上的位置</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="7-4-1-事件传递顺序"><a href="#7-4-1-事件传递顺序" class="headerlink" title="7.4.1 事件传递顺序"></a>7.4.1 事件传递顺序</h2><p>现在编写3个类，让它们分别继承QGraphicsView、QGraphicsScene和QGraphicsItem，<br>然后重写mousePressEvent()事件函数，观察一下事件的传递顺序是怎么样的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class ParentItem(QGraphicsRectItem):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(ParentItem, self).__init__()</span><br><span class="line">        self.setRect(100, 30, 100, 50)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      # 1</span><br><span class="line">        print(&#x27;event from parent QGraphicsItem&#x27;)</span><br><span class="line">        super().mousePressEvent(event)     # 视图→场景→子图元→父图元</span><br><span class="line">        # 需要注意的一点是：调用父类的事件处理接口不能省略，否则事件就会停止传递。</span><br><span class="line">        # 比如删掉Window类下mousePressEvent()事件函数中的super().mousePressEvent(event)，</span><br><span class="line">        # 那么控制台就只会输出“event from QGraphicsView”文本了</span><br><span class="line">        </span><br><span class="line">class ChildItem(QGraphicsRectItem):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(ChildItem, self).__init__()</span><br><span class="line">        self.setRect(100, 30, 50, 30)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      # 1</span><br><span class="line">        print(&#x27;event from child QGraphicsItem&#x27;)</span><br><span class="line">        super().mousePressEvent(event)</span><br><span class="line"></span><br><span class="line">class Scene(QGraphicsScene):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Scene, self).__init__()</span><br><span class="line">        self.setSceneRect(0, 0, 300, 300)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      # 1</span><br><span class="line">        print(&#x27;event from QGraphicsScene&#x27;)</span><br><span class="line">        super().mousePressEvent(event)</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.resize(300, 300)</span><br><span class="line"></span><br><span class="line">        self.scene = Scene()</span><br><span class="line">        self.setScene(self.scene)</span><br><span class="line"></span><br><span class="line">        self.parent_item = ParentItem()</span><br><span class="line">        self.child_item = ChildItem()</span><br><span class="line">        self.child_item.setParentItem(self.parent_item)</span><br><span class="line">        self.scene.addItem(self.parent_item)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):      # 1</span><br><span class="line">        print(&#x27;event from QGraphicsView&#x27;)</span><br><span class="line">        super().mousePressEvent(event)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h3 id="7-4-2-坐标转换"><a href="#7-4-2-坐标转换" class="headerlink" title="7.4.2 坐标转换"></a>7.4.2 坐标转换</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from PyQt5.QtGui import *</span><br><span class="line">from PyQt5.QtCore import *</span><br><span class="line">from PyQt5.QtWidgets import *</span><br><span class="line">from PyQt5.QtSql import *</span><br><span class="line"></span><br><span class="line">class Window(QGraphicsView):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Window, self).__init__()</span><br><span class="line">        self.graphics_scene = QGraphicsScene()</span><br><span class="line">        self.graphics_scene.setSceneRect(0, 0, 300, 300)</span><br><span class="line"></span><br><span class="line">        self.ellipse = self.graphics_scene.addEllipse(50, 100, 50, 100)</span><br><span class="line">        self.rect = self.graphics_scene.addRect(150, 100, 100, 100)</span><br><span class="line"></span><br><span class="line">        self.resize(500, 500)</span><br><span class="line">        self.setScene(self.graphics_scene)</span><br><span class="line"></span><br><span class="line">    def mousePressEvent(self, event):</span><br><span class="line">        super(Window, self).mousePressEvent(event)</span><br><span class="line">        pos = event.pos()     # # 在窗口上单击时，通过event.pos()获取到的坐标是视图内的坐标</span><br><span class="line">        # 如果场景大小和视图大小一样的话，那么event.pos()获取到的坐标也可以被看作场景内的坐标</span><br><span class="line">        # 但是如果它们的大小不一样，那我们就需要把event.pos()获取到的视图内的坐标转换成场景内的坐标</span><br><span class="line">        # 否则我们无法通过QGraphicsScene. itemAt()方法正确获取到场景中的图元</span><br><span class="line">        item = self.graphics_scene.itemAt(pos, QTransform())</span><br><span class="line">        # itemAt()方法无法通过传给它的视图坐标找到这两个图元，它需要一个场景坐标</span><br><span class="line">        print(item)</span><br><span class="line">        # 此时，我们应该将这个视图坐标映射到场景中。图形视图框架提供了视图、场景和图元坐标之间的转换方法，以及图元与图元坐标之间的转换方法</span><br><span class="line">        # QGraphicsView.mapToScene()        将视图内的坐标转换为场景内的坐标</span><br><span class="line">        # QGraphicsView.mapFromScene()      将场景内的坐标转换为视图内的坐标</span><br><span class="line">        # QGraphicsltem.mapFromScene()      将场景内的坐标转换为图元内的坐标</span><br><span class="line">        # QGraphicsltem.mapToScene()        将图元内的坐标转换为场景内的坐标</span><br><span class="line">        # QGraphicsltem.mapToParent()       将子图元内的坐标转换为父图元内的坐标</span><br><span class="line">        # QGraphicsltem.mapFromParent()     将父图元内的坐标转换为子图元内的坐标</span><br><span class="line">        # QGraphicsltem.mapToltem()         将当前图元内的坐标转换为其他图元内的坐标</span><br><span class="line">        # QGraphicsitem.mapFromltem()       将其他图元内的坐标转换为当前图元内的坐标</span><br><span class="line">        </span><br><span class="line">        # 坐标转换代码</span><br><span class="line">        # def mousePressEvent(self, event):</span><br><span class="line">            # super(Window, self).mousePressEvent(event)</span><br><span class="line">            # pos = self.mapToScene(event.pos())</span><br><span class="line">            # item = self.graphics_scene.itemAt(pos, QTransform())</span><br><span class="line">            # print(item)</span><br><span class="line">            </span><br><span class="line">        # GraphicsView也提供了itemAt()方法，我们只需要给该方法传入视图内的坐标就能获取到图元，</span><br><span class="line">        # 不需要传入第二个QTransform类型的参数。</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app = QApplication([])</span><br><span class="line">    finance_app = Window()</span><br><span class="line">    finance_app.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><h2 id="8-1-PyInstaller"><a href="#8-1-PyInstaller" class="headerlink" title="8.1 PyInstaller"></a>8.1 PyInstaller</h2><p>PyInstaller的用法非常简单，而且它的打包速度很快。<br>通过它我们能够将程序打包成Windows、macOS和Linux上的可执行文件。<br>PyInstaller已经成功运用在一些不常见的系统上，比如AIX、Solaris、FreeBSD和OpenBSD。<br>PyInstaller官方也在不断更新，所以能够被PyInstaller打包的第三方库也越来越多，“坑”也越来越少。</p><h3 id="8-1-1-环境配置"><a href="#8-1-1-环境配置" class="headerlink" title="8.1.1 环境配置"></a>8.1.1 环境配置</h3><p>环境配置<br>pip install pyinstaller</p><h3 id="8-1-2-PyInstaller多文件和单文件打包模式"><a href="#8-1-2-PyInstaller多文件和单文件打包模式" class="headerlink" title="8.1.2 PyInstaller多文件和单文件打包模式"></a>8.1.2 PyInstaller多文件和单文件打包模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># 在命令提示符窗口中执行“pyinstaller -v”命令后发现有以下文字时，执行pip uninstall pathlib命令 卸载掉过时的路径包</span><br><span class="line"># The &#x27;pathlib&#x27; package is an obsolete backport of a standard library package and is incompatible with PyInstaller. Please remove this package (located in C:\Users\11298\AppData\Local\Programs\Python\Python311\Lib\site-packages) using</span><br><span class="line">#     &quot;C:\Users\11298\AppData\Local\Programs\Python\Python311\python.exe&quot; -m pip uninstall pathlib</span><br><span class="line"># then try again.</span><br><span class="line"></span><br><span class="line">接着，打开demo文件夹，在路径栏中输入“cmd”并按“Enter”键。在出现的命令提示符窗口中输入以下命令。</span><br><span class="line"></span><br><span class="line">pyinstaller hello.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">打包结束后，demo文件夹下出现了build和dist两个文件夹，以及一个.spec文件。</span><br><span class="line"></span><br><span class="line">build文件夹中存放着一些编译文件，可以直接删除。</span><br><span class="line">hello.spec是一个打包配置文件，我们也可以通过该文件来打包程序，但效果与命令提示符窗口中执行命令是一样的。</span><br><span class="line"></span><br><span class="line">2.单文件打包模式</span><br><span class="line"></span><br><span class="line">dist文件夹中只会生成一个hello.exe可执行文件，全部的依赖文件都已经被打包到这个文件中了。</span><br><span class="line">只需要添加一个“-F”就可以使用单文件打包模式。   pyinstaller -F hello.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">采用单文件打包模式生成的hello.exe在运行时，会先花费一点儿时间把依赖文件解压出来，再显示运行结果。</span><br><span class="line">这就是为什么通过单文件打包模式打包出来的程序在运行时会比较慢。</span><br><span class="line"></span><br><span class="line">可以使用“--runtime-tmpdir”命令改变_MEI临时文件夹的生成位置，语法格式如下</span><br><span class="line">&quot;&quot;&quot; </span><br><span class="line">pyinstaller -F --runtime-tmpdir=/another/path/ hello.py</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">_MEI文件夹会在程序关闭时自动被删除掉。但是如果程序运行崩溃或者被强制退出（比如使用任务管理器强制退出）的话，</span><br><span class="line">那么这个文件夹是不会自动被删除的！这就会导致磁盘内存被占用，需要我们手动进行删除。</span><br></pre></td></tr></table></figure><h3 id="8-1-3-黑框的调试作用"><a href="#8-1-3-黑框的调试作用" class="headerlink" title="8.1.3 黑框的调试作用"></a>8.1.3 黑框的调试作用</h3><p>黑框指的是命令提示符窗口。当我们运行可执行文件后，黑框中会显示程序的输出内容。<br>但是如果可执行文件运行失败，那么黑框中就会显示报错信息。通过这个信息，我们就能知道如何调试程序</p><p>调试程序： 打开一个新的命令提示符窗口，然后将hello.exe拖入，按“Enter”键运行</p><p>在确保程序运行无误后，我们可以在打包命令中加上“-w”来去掉黑框。<br>pyinstaller -w hello.py</p><p>当我们在打包一个程序时，先不要加“-w”，因为黑框能够告诉我们报错信息。若可执行文件运行成功，且内部功能正常，再加上“-w”重新打包。<br>如果程序本身就需要用到命令提示符窗口来输入或输出一些内容，那就不用加“-w”了。</p><h3 id="8-1-4-给可执行文件加上图标"><a href="#8-1-4-给可执行文件加上图标" class="headerlink" title="8.1.4 给可执行文件加上图标"></a>8.1.4 给可执行文件加上图标</h3><p>如果要给可执行文件添加图标，我们可以在打包时加上“-i”命令，并在“-i”后面加上图标文件的路径，使用格式如下。<br>pyinstaller -i &#x2F;path&#x2F;to&#x2F;xxx.ico hello.py</p><p>在macOS系统上打包时，必须要使用.icns格式的图标文件。</p><p>一些读者用了“-i”命令后，可执行文件的图标并没有发生改变，可能原因有以下两点。<br>① 图标文件是无效的。请不要用修改扩展名的方式来获取.ico格式的文件，比如直接把.png改成.ico，我们应该使用专业的格式转换软件（如格式工厂）来改变格式。<br>② 缓存原因。把可执行文件移动到其他路径下后，就会发现图标是正常显示的。当然也可以重启计算机。</p><h3 id="8-1-5-打包资源文件"><a href="#8-1-5-打包资源文件" class="headerlink" title="8.1.5 打包资源文件"></a>8.1.5 打包资源文件</h3><p>资源文件（即icon.ico）相对于可执行文件的路径必须要正确，这样程序才能正常运行。</p><p>把资源文件手动复制到hello文件夹中的方法只适用于多文件打包模式。</p><p>如果用单文件打包模式打包，包含依赖文件的文件夹只有在可执行文件运行后才被解压出来，<br>而程序会因为找不到资源文件立即报错，所以我们是没有时间去复制的。</p><p>在打包时直接把资源文件添加到生成的hello文件夹（单文件打包模式下是_MEI文件夹）中：<br>pyinstaller –add-data&#x3D;SRC;DEST hello.py</p><p>SRC表示资源文件所在的路径（绝对路径和相对路径都可以），<br>DEST表示在打包后资源文件在hello文件夹中的相对路径，<br>在Windows系统上两个路径之间用英文分号“;”隔开，<br>在macOS和Linux系统上两个路径之间用英文冒号“:”隔开</p><p>我们现在用多文件打包模式重新打包示例代码8-2，使用如下打包命令。<br>pyinstaller –add-data&#x3D;.&#x2F;icon.ico;. hello.py</p><p>icon.ico在当前路径下，所以在SRC处填写“.&#x2F;icon.ico”的话就可以让PyIsntaller找到它。<br>我们要在打包后将icon.ico放在hello文件夹中，所以在DEST处填写“.”。<br>打包结束后，可以发现icon.ico出现在了hello文件夹中，程序运行也没有问题</p><p>我们可以使用通配符“<em>”来添加多个资源文件。<br>比如“–add-data&#x3D;</em>;.&#x2F;folder&#x2F;”就表示将当前路径下的所有文件放在hello文件夹下名为folder的文件夹中。<br>我们也可以添加同种格式的多个文件，比如“–add-data&#x3D;*.jpg;.&#x2F;image&#x2F;”就表示将当前路径下的所有.jpg格式的文件放到hello文件夹下名为image的文件夹中。</p><p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p><p>现在使用单文件打包模式打包hello.py文件，命令如下。<br>pyinstaller -F –add-data&#x3D;.&#x2F;icon.ico;. hello.py</p><p>打包结束后，我们运行hello.exe，发现报错了，但是解压出来的_MEI临时文件夹中确实有icon.ico！这是怎么回事？先来看一下这行代码。<br>win.iconbitmap(‘.&#x2F;icon.ico’) #设置窗口图标</p><p>程序会在当前路径下寻找icon.ico文件，但是hello.exe在dist文件夹中，而icon.ico在_MEI文件夹中，所以才会报错。<br>可以将示例代码8-2修改一下，让程序能够找到_MEI文件夹中的icon.ico，详见示例代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import tkinter</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">　</span><br><span class="line">def res_path(relative_path):   # </span><br><span class="line">    &quot;&quot;&quot;获取资源路径&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        # 获取_MEI文件夹所在路径</span><br><span class="line">        base_path = sys._MEIPASS  # 通过sys模块的_MEIPASS属性来获取_MEI文件夹的位置</span><br><span class="line">    except Exception: </span><br><span class="line">        # 没有_MEI文件夹的话使用当前路径</span><br><span class="line">        base_path = os.path.abspath(&quot;.&quot;)</span><br><span class="line"></span><br><span class="line">    return os.path.join(base_path, relative_path)</span><br><span class="line">　</span><br><span class="line">win = tkinter.Tk()</span><br><span class="line">win.iconbitmap(res_path(&#x27;./icon.ico&#x27;))  # 设置窗口图标</span><br><span class="line">win.mainloop()</span><br></pre></td></tr></table></figure><p>在用单文件打包模式打包前，需要修改程序代码，将res_path()函数套在各个路径上。</p><h3 id="8-1-6-减小打包后的文件大小"><a href="#8-1-6-减小打包后的文件大小" class="headerlink" title="8.1.6 减小打包后的文件大小"></a>8.1.6 减小打包后的文件大小</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PyInstaller会把Python环境和程序使用到的库打包进来，有时候还会打包一些明明没有用到的第三方库，</span><br><span class="line">导致打包所花的时间越来越多，包也越来越大。</span><br><span class="line"></span><br><span class="line">第一个减小包体的方法就是使用干净的打包环境。所谓干净，指的是计算机上只安装了程序运行所必需的库。</span><br><span class="line">通常，我们会使用虚拟环境，或者在虚拟机中打包。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第二个方法：如果目前无法在干净的环境中打包，那么可以使用“--exclude-module”命令，</span><br><span class="line">它的作用是在打包时排除指定的库或模块，这样就不会把无关的文件包含进来了，使用格式如下。</span><br><span class="line">pyinstaller --exclude-module=NAME hello.py</span><br><span class="line">在NAME处填写要排除的库或模块名称。</span><br><span class="line"></span><br><span class="line">比方说我们现在要打包一个程序，该程序仅仅使用到了操作Excel文件的openpyxl库</span><br><span class="line">from openpyxl import Workbook</span><br><span class="line"></span><br><span class="line"># 创建文件对象</span><br><span class="line">wb = Workbook()</span><br><span class="line"></span><br><span class="line"># 获取当前正使用的工作表</span><br><span class="line">ws = wb.active</span><br><span class="line"></span><br><span class="line"># 为工作表添加一些字段</span><br><span class="line">ws.append([&#x27;test1&#x27;, &#x27;test2&#x27;, &#x27;test3&#x27;])</span><br><span class="line"></span><br><span class="line"># 保存为test.xlsx</span><br><span class="line">wb.save(&#x27;test.xlsx&#x27;)</span><br><span class="line"></span><br><span class="line">假如我们计算机上还装有NumPy和pandas，那这两个没有用到的库也可能会被打包进来。所以我们应该用“--exclude-module”命令排除这两个库，使用以下命令打包。</span><br><span class="line">pyinstaller --exclude-module=numpy --exclude-module=pandas hello.py</span><br><span class="line"></span><br><span class="line">第三个方法就是使用UPX工具，它可以进一步压缩可执行文件。我们首先去UPX官网下载对应系统版本的UPX工具。</span><br><span class="line">笔者使用的是Windows 10 64位的计算机，所以需要下载win64版本的UPX</span><br></pre></td></tr></table></figure><h3 id="8-1-7-其他常用的命令"><a href="#8-1-7-其他常用的命令" class="headerlink" title="8.1.7 其他常用的命令"></a>8.1.7 其他常用的命令</h3><p>1.pyinstaller -h 查看PyInstaller所有命令的解释和用法<br>2. pyinstaller -n&#x3D;good hello.py 用来修改生成的可执行文件名称 原来生成的可执行文件名称为hello.exe，现在就变成good.exe了</p><p>3.-y<br>当打包完毕后，我们可能会想修改一下源码然后重新打包。<br>那么第二次打包时PyInstaller会询问是否要删除之前打包生成的文件，此时需要我们往命令提示符窗口中输入y或者N<br>如果在打包命令中加上“-y”，那PyInstaller会直接删除上次打包遗留下的文件，不会询问</p><p>4.–clean<br>删除前一次打包留下的缓存文件，不过在删除前PyInstaller会先询问是否确认执行，所以我们可以加上“-y”命令<br>pyinstaller –clean -y hello.py</p><p>5.–hidden-import<br>我们经常会碰到“ModuleNotFoundError: No module named xxx”这种报错。<br>出现这种报错的原因无非就两种。<br>① 没有安装相应的库或模块。<br>② 已经安装相应的库或模块了，代码中也导入了，但是PyInstaller在打包时没有找到。<br>如果是第一种原因，我们用pip命令下载相应库或模块就可以解决了。<br>如果是第二种原因，在打包时添加“–hidden-import”命令就可以解决了，其使用格式如下（xxx就是库或模块的名称）。<br>pyinstaller –hidden-import&#x3D;xxx hello.py</p><p>6.–noupx代表不使用UPX工具。</p><p>7.–runtime-hook当我们双击可执行文件后，程序就会执行。<br>“–runtime-hook”命令能够让我们在程序运行前先执行一段代码，非常有用。<br>在hello.py中，我们想要读取data.txt的文本内容。<br>但是data.txt在data.zip压缩文件中，所以必须先执行extract_data.py中的程序将data.txt解压出来。打包命令如下所示。<br>pyinstaller –runtime-hook&#x3D;extract_data.py –add-data&#x3D;data.zip;. hello.py</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://weixiansheng1.github.io">嗷，Mr.威</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://weixiansheng1.github.io/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/">https://weixiansheng1.github.io/2023/10/02/pyQt5%E5%AD%A6%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://weixiansheng1.github.io" target="_blank">嗷，Mr.威</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="https://th.bing.com/th/id/R.3a2265a62c9ea6e5769e2ab506e606a6?rik=eRGuqrtWyswwWg&amp;riu=http%3a%2f%2fwww.v3wall.com%2fwallpaper%2f1920_1080%2f1108%2f1920_1080_20110819121148354481.jpg&amp;ehk=Ngr6unVKpbdvUlP8b1xdPcLdhijzPSJSsMoSX8EKvL0%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信（wechat）"></a><div class="post-qr-code-desc">微信（wechat）</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝（alipay）"></a><div class="post-qr-code-desc">支付宝（alipay）</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/02/obsidian%20%E4%B8%8E%20hexo%20%E8%81%94%E5%8A%A8%E9%83%A8%E7%BD%B2github%20page/" title="obsidian 与 hexo 联动部署github page"><img class="cover" src="https://pic2.zhimg.com/80/v2-597a23f8427f41a41dfd2f5b8474d09d_1440w.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">obsidian 与 hexo 联动部署github page</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/02/saleor%E5%AE%89%E8%A3%85/" title="saleor安装历程"><img class="cover" src="https://th.bing.com/th/id/R.5732c288719926da179ffd7d61c0edcb?rik=9M1z9RjA9FgmKA&amp;riu=http%3a%2f%2fimg95.699pic.com%2fphoto%2f50057%2f8076.jpg_wh860.jpg&amp;ehk=dhw8jZncuc5ebGMUMorCBPqjApPjzwcBGfySZgQBKrE%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">saleor安装历程</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/2f517e76-.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">嗷，Mr.威</div><div class="author-info__description">一念犯鬼神，言行需谨慎。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" href="https://github.com/weixiansheng1"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/weixiansheng1" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E6%B6%88%E6%81%AF%E6%A1%86%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">2.2消息框控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2%E4%B8%8E%E6%B6%88%E6%81%AF%E6%A1%86%E4%BA%A4%E4%BA%92"><span class="toc-number">1.1.</span> <span class="toc-text">2.2.2与消息框交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3%E7%BC%96%E5%86%99%E5%B8%A6%E4%B8%AD%E6%96%87%E6%8C%89%E9%92%AE%E7%9A%84%E6%B6%88%E6%81%AF%E6%A1%86"><span class="toc-number">1.2.</span> <span class="toc-text">2.2.3编写带中文按钮的消息框</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%E6%96%87%E6%9C%AC%E6%A1%86%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">2.3文本框控件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-4%E5%A4%8D%E9%80%89%E6%A1%86%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6QCheckBox"><span class="toc-number">3.</span> <span class="toc-text">2.4.4复选框按钮控件QCheckBox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-5%E5%8F%AF%E7%BC%96%E8%BE%91%E7%9A%84%E4%B8%8B%E6%8B%89%E6%A1%86%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6QcomboBox"><span class="toc-number">3.1.</span> <span class="toc-text">2.4.5可编辑的下拉框按钮控件QcomboBox</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-1%E6%B6%B2%E6%99%B6%E6%95%B0%E5%AD%97%E6%8E%A7%E4%BB%B6QLCDNumber"><span class="toc-number">4.</span> <span class="toc-text">2.5.1液晶数字控件QLCDNumber</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2%E6%95%B0%E5%AD%97%E8%B0%83%E8%8A%82%E6%A1%86%E6%8E%A7%E4%BB%B6QSpinBox%E5%92%8CQDoubleSpinBox"><span class="toc-number">4.1.</span> <span class="toc-text">2.5.2数字调节框控件QSpinBox和QDoubleSpinBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6QSlider"><span class="toc-number">4.2.</span> <span class="toc-text">2.5.3滑动条控件QSlider</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6QSlider-1"><span class="toc-number">4.3.</span> <span class="toc-text">2.5.3滑动条控件QSlider</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-1%E6%97%A5%E5%8E%86%E6%8E%A7%E4%BB%B6QCalendarWidge"><span class="toc-number">5.</span> <span class="toc-text">2.6.1日历控件QCalendarWidge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-2%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%8E%A7%E4%BB%B6QDateTimeEdit"><span class="toc-number">5.1.</span> <span class="toc-text">2.6.2日期时间控件QDateTimeEdit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-1%E5%AE%9A%E6%97%B6%E5%99%A8%E6%8E%A7%E4%BB%B6QTimer"><span class="toc-number">6.</span> <span class="toc-text">2.7.1定时器控件QTimer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2%E8%BF%9B%E5%BA%A6%E6%9D%A1%E6%8E%A7%E4%BB%B6QProgressBar"><span class="toc-number">6.1.</span> <span class="toc-text">2.7.2进度条控件QProgressBar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-1%E5%88%86%E7%BB%84%E6%A1%86%E6%8E%A7%E4%BB%B6QGroupBox"><span class="toc-number">7.</span> <span class="toc-text">3.1.1分组框控件QGroupBox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-2%E5%B7%A5%E5%85%B7%E7%AE%B1%E6%8E%A7%E4%BB%B6QToolBox"><span class="toc-number">7.1.</span> <span class="toc-text">3.1.2工具箱控件QToolBox</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-1%E6%8E%A7%E4%BB%B6%E6%BB%9A%E5%8A%A8%E5%8C%BA%E5%9F%9FQScrollArea"><span class="toc-number">8.</span> <span class="toc-text">3.2.1控件滚动区域QScrollArea</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2%E6%BB%9A%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6QScrollBar"><span class="toc-number">8.1.</span> <span class="toc-text">3.2.2滚动条控件QScrollBar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-1%E6%8B%86%E5%88%86%E7%AA%97%E5%8F%A3%E6%8E%A7%E4%BB%B6QSplitter"><span class="toc-number">9.</span> <span class="toc-text">3.3.1拆分窗口控件QSplitter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2-%E6%A0%87%E7%AD%BE%E9%A1%B5%E6%8E%A7%E4%BB%B6QTabWidget"><span class="toc-number">9.1.</span> <span class="toc-text">3.3.2 标签页控件QTabWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3-%E5%A0%86%E6%A0%88%E6%8E%A7%E4%BB%B6QStackedWidget"><span class="toc-number">9.2.</span> <span class="toc-text">3.3.3 堆栈控件QStackedWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-4-%E5%A4%9A%E6%96%87%E6%A1%A3%E5%8C%BA%E5%9F%9F%E6%8E%A7%E4%BB%B6QMdiArea"><span class="toc-number">9.3.</span> <span class="toc-text">3.3.4 多文档区域控件QMdiArea</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6%E3%80%81%E6%A0%91%E5%BD%A2%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6%E3%80%81%E8%A1%A8%E6%A0%BC%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6"><span class="toc-number">10.</span> <span class="toc-text">3.4 列表视图控件、树形视图控件、表格视图控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QListView"><span class="toc-number">10.1.</span> <span class="toc-text">3.4.1 列表视图控件QListView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E6%A0%91%E5%BD%A2%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QTreeVie"><span class="toc-number">10.2.</span> <span class="toc-text">3.4.2 树形视图控件QTreeVie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E8%A1%A8%E6%A0%BC%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QTableView"><span class="toc-number">10.3.</span> <span class="toc-text">3.4.3 表格视图控件QTableView</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-1-%E7%AE%80%E5%8C%96%E7%89%88%E5%88%97%E8%A1%A8%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QListWidge"><span class="toc-number">11.</span> <span class="toc-text">3.5.1 简化版列表视图控件QListWidge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-2-%E7%AE%80%E5%8C%96%E7%89%88%E6%A0%91%E5%BD%A2%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QTreeWidget"><span class="toc-number">11.1.</span> <span class="toc-text">3.5.2 简化版树形视图控件QTreeWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-3-%E7%AE%80%E5%8C%96%E7%89%88%E8%A1%A8%E6%A0%BC%E8%A7%86%E5%9B%BE%E6%8E%A7%E4%BB%B6QTableWidget"><span class="toc-number">11.2.</span> <span class="toc-text">3.5.3 简化版表格视图控件QTableWidget</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-1-%E9%A2%9C%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86%E6%8E%A7%E4%BB%B6QColorDialog"><span class="toc-number">12.</span> <span class="toc-text">3.6.1 颜色对话框控件QColorDialog</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-2-%E5%AD%97%E4%BD%93%E5%AF%B9%E8%AF%9D%E6%A1%86%E6%8E%A7%E4%BB%B6QFontDialog"><span class="toc-number">12.1.</span> <span class="toc-text">3.6.2 字体对话框控件QFontDialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-3-%E8%BE%93%E5%85%A5%E5%AF%B9%E8%AF%9D%E6%A1%86%E6%8E%A7%E4%BB%B6QInputDialog"><span class="toc-number">12.2.</span> <span class="toc-text">3.6.3 输入对话框控件QInputDialog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-4-%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%A1%86%E6%8E%A7%E4%BB%B6QFileDialog"><span class="toc-number">12.3.</span> <span class="toc-text">3.6.4 文件对话框控件QFileDialog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%B7%B1%E5%85%A5%E7%AA%97%E5%8F%A3"><span class="toc-number">13.</span> <span class="toc-text">第4章　深入窗口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E7%AA%97%E5%8F%A3%E6%A0%87%E9%A2%98%E5%92%8C%E5%9B%BE%E6%A0%87"><span class="toc-number">13.1.</span> <span class="toc-text">4.1.1 窗口标题和图标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E5%92%8C%E4%BD%8D%E7%BD%AE-1"><span class="toc-number">13.2.</span> <span class="toc-text">4.1.2 窗口大小和位置-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E5%92%8C%E4%BD%8D%E7%BD%AE-2"><span class="toc-number">13.3.</span> <span class="toc-text">4.1.2 窗口大小和位置-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E5%85%B6%E4%BB%96%E7%AA%97%E5%8F%A3%E5%B1%9E%E6%80%A7"><span class="toc-number">13.4.</span> <span class="toc-text">4.1.3 其他窗口属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-1-%E7%90%86%E8%A7%A3%E5%9D%90%E6%A0%87%E4%BD%93%E7%B3%BB"><span class="toc-number">14.</span> <span class="toc-text">4.2.1 理解坐标体系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-1-%E7%AA%97%E5%8F%A3%E5%85%B3%E9%97%AD%E4%BA%8B%E4%BB%B6"><span class="toc-number">15.</span> <span class="toc-text">4.3.1 窗口关闭事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E8%B0%83%E6%95%B4%E4%BA%8B%E4%BB%B6"><span class="toc-number">15.1.</span> <span class="toc-text">4.3.2 窗口大小调整事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6"><span class="toc-number">15.2.</span> <span class="toc-text">4.3.3 键盘事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-4-%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6-1"><span class="toc-number">15.3.</span> <span class="toc-text">4.3.4 鼠标事件-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-4-%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6-2"><span class="toc-number">15.4.</span> <span class="toc-text">4.3.4 鼠标事件-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-5-%E6%8B%96%E6%94%BE%E4%BA%8B%E4%BB%B6"><span class="toc-number">15.5.</span> <span class="toc-text">4.3.5 拖放事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-6-%E7%BB%98%E5%88%B6%E4%BA%8B%E4%BB%B6"><span class="toc-number">15.6.</span> <span class="toc-text">4.3.6 绘制事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-1-%E4%B8%BB%E7%AA%97%E5%8F%A3%E7%9A%84%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="toc-number">16.</span> <span class="toc-text">4.4.1 主窗口的组成部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-%E5%81%9C%E9%9D%A0%E7%AA%97%E5%8F%A3%E7%B1%BBQDockWidget"><span class="toc-number">16.1.</span> <span class="toc-text">4.4.2 停靠窗口类QDockWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-3-%E8%8F%9C%E5%8D%95%E6%A0%8F%E7%B1%BBQMenuBar"><span class="toc-number">16.2.</span> <span class="toc-text">4.4.3 菜单栏类QMenuBar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-4-%E5%B7%A5%E5%85%B7%E6%A0%8F%E7%B1%BBQToolbar"><span class="toc-number">16.3.</span> <span class="toc-text">4.4.4 工具栏类QToolbar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-5-%E7%8A%B6%E6%80%81%E6%A0%8F%E7%B1%BBQStatusBar-1"><span class="toc-number">16.4.</span> <span class="toc-text">4.4.5 状态栏类QStatusBar-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-5-%E7%8A%B6%E6%80%81%E6%A0%8F%E7%B1%BBQStatusBar-2"><span class="toc-number">16.5.</span> <span class="toc-text">4.4.5 状态栏类QStatusBar-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-6-%E7%A8%8B%E5%BA%8F%E5%90%AF%E5%8A%A8%E7%94%BB%E9%9D%A2%E7%B1%BBQSplashScreen"><span class="toc-number">16.6.</span> <span class="toc-text">4.4.6 程序启动画面类QSplashScreen</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">17.</span> <span class="toc-text">6.1 数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%85%B3%E9%97%AD"><span class="toc-number">17.1.</span> <span class="toc-text">6.1.1 数据库连接和关闭</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%85%B3%E9%97%AD-MySQL"><span class="toc-number">17.2.</span> <span class="toc-text">6.1.1 数据库连接和关闭-MySQL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-number">18.</span> <span class="toc-text">6.2 多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-%E4%BD%BF%E7%94%A8QThread%E7%BA%BF%E7%A8%8B%E7%B1%BB-1"><span class="toc-number">18.1.</span> <span class="toc-text">6.2.1 使用QThread线程类-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-%E4%BD%BF%E7%94%A8QThread%E7%BA%BF%E7%A8%8B%E7%B1%BB-2"><span class="toc-number">18.2.</span> <span class="toc-text">6.2.1 使用QThread线程类-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-2-%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B8%AD%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">18.3.</span> <span class="toc-text">6.2.2 在线程中获取窗口数据信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-3-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E7%88%AC%E7%A8%8B%E5%BA%8F"><span class="toc-number">18.4.</span> <span class="toc-text">6.2.3 编写一个简单的爬程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-1-%E7%94%BB%E7%AC%94%E7%B1%BBQPen"><span class="toc-number">19.</span> <span class="toc-text">6.3.1 画笔类QPen</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-2-%E7%94%BB%E5%88%B7%E7%B1%BBQBrush"><span class="toc-number">19.1.</span> <span class="toc-text">6.3.2 画刷类QBrush</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-3-%E7%94%A8%E9%BC%A0%E6%A0%87%E5%9C%A8%E7%AA%97%E5%8F%A3%E4%B8%8A%E7%BB%98%E5%88%B6%E7%9F%A9%E5%BD%A2"><span class="toc-number">19.2.</span> <span class="toc-text">6.3.3 用鼠标在窗口上绘制矩形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-4-%E6%89%93%E5%8D%B0"><span class="toc-number">19.3.</span> <span class="toc-text">6.3.4 打印</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-1-%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E7%B1%BBQPropertyAnimation"><span class="toc-number">20.</span> <span class="toc-text">6.4.1 属性动画类QPropertyAnimation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-1-%E5%B1%9E%E6%80%A7%E5%8A%A8%E7%94%BB%E7%B1%BBQPropertyAnimation-%E6%94%B9%E5%8F%98%E6%8C%89%E9%92%AE%E9%A2%9C%E8%89%B2"><span class="toc-number">20.1.</span> <span class="toc-text">6.4.1 属性动画类QPropertyAnimation-改变按钮颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-2-%E4%B8%B2%E8%A1%8C%E5%8A%A8%E7%94%BB%E7%BB%84%E7%B1%BBQSequentialAnimationGroup"><span class="toc-number">20.2.</span> <span class="toc-text">6.4.2 串行动画组类QSequentialAnimationGroup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-3-%E5%B9%B6%E8%A1%8C%E5%8A%A8%E7%94%BB%E7%BB%84%E7%B1%BBQParallelAnimationGroup"><span class="toc-number">20.3.</span> <span class="toc-text">6.4.3 并行动画组类QParallelAnimationGroup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-4-%E6%97%B6%E9%97%B4%E8%BD%B4%E7%B1%BBQTimeline"><span class="toc-number">20.4.</span> <span class="toc-text">6.4.4 时间轴类QTimeline</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-1-%E5%A3%B0%E9%9F%B3%E7%B1%BBQSound"><span class="toc-number">21.</span> <span class="toc-text">6.5.1 声音类QSound</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-2-%E9%9F%B3%E6%95%88%E7%B1%BBQSoundEffect"><span class="toc-number">21.1.</span> <span class="toc-text">6.5.2 音效类QSoundEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-3-%E5%AA%92%E4%BD%93%E6%92%AD%E6%94%BE%E6%9C%BA%E7%B1%BBQMediaPlayer-%E6%92%AD%E6%94%BE%E8%A7%86%E9%A2%91"><span class="toc-number">21.2.</span> <span class="toc-text">6.5.3 媒体播放机类QMediaPlayer-播放视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-3-%E5%AA%92%E4%BD%93%E6%92%AD%E6%94%BE%E6%9C%BA%E7%B1%BBQMediaPlayer-%E6%92%AD%E6%94%BE%E9%9F%B3%E9%A2%91"><span class="toc-number">21.3.</span> <span class="toc-text">6.5.3 媒体播放机类QMediaPlayer-播放音频</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-1-%E4%BA%86%E8%A7%A3QWebEngineView"><span class="toc-number">22.</span> <span class="toc-text">6.6.1 了解QWebEngineView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-2-%E5%88%B6%E4%BD%9C%E4%B8%80%E6%AC%BE%E7%AE%80%E5%8D%95%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="toc-number">22.1.</span> <span class="toc-text">6.6.2 制作一款简单的浏览器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-1-QUdpSocket-%E5%BC%80%E5%8F%91%E5%A4%9A%E4%BA%BA%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%BA%94%E7%94%A8"><span class="toc-number">23.</span> <span class="toc-text">6.7.1 QUdpSocket 开发多人聊天室应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-2-QTcpSocket%E5%92%8CQTcpServer-%E4%BD%BF%E7%94%A8QTcpServer%E7%BC%96%E5%86%99%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">23.1.</span> <span class="toc-text">6.7.2 QTcpSocket和QTcpServer-使用QTcpServer编写服务端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-2-QTcpSocket%E5%92%8CQTcpServer-%E4%BD%BF%E7%94%A8QTcpSocket%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">23.2.</span> <span class="toc-text">6.7.2 QTcpSocket和QTcpServer-使用QTcpSocket编写客户端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8-QSS-QSS%E6%A0%B7%E8%AF%BB%E5%8F%96%E5%BC%8F"><span class="toc-number">24.</span> <span class="toc-text">6.8 QSS-QSS样读取式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-QSS-%E8%B0%83%E7%94%A8QApplication%E5%AF%B9%E8%B1%A1%E7%9A%84setStyleSheet-%E6%96%B9%E6%B3%95%E5%B0%86%E6%A0%B7%E5%BC%8F%E4%BD%9C%E7%94%A8%E4%BA%8E%E6%95%B4%E4%B8%AA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">24.1.</span> <span class="toc-text">6.8 QSS-调用QApplication对象的setStyleSheet()方法将样式作用于整个应用程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-QSS-%E6%94%B9%E5%8F%98%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6%E4%B8%8A%E6%96%87%E6%9C%AC%E5%AD%97%E4%BD%93%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">24.2.</span> <span class="toc-text">6.8 QSS-改变按钮控件上文本字体的大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-2-QSS%E5%9F%BA%E6%9C%AC%E8%A7%84%E5%88%99"><span class="toc-number">24.3.</span> <span class="toc-text">6.8.2 QSS基本规则</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#QPushButton-font-size-50px-color-red"><span class="toc-number"></span> <span class="toc-text">QPushButton { font-size: 50px; color: red;}</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BD%93%E7%84%B6%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%90%8C%E6%97%B6%E6%8C%87%E5%AE%9A%E5%A4%9A%E4%B8%AA%E9%80%89%E6%8B%A9%E5%99%A8%E3%80%82QPushButton-QLabel-QLineEdit-font-size-50px-color-red"><span class="toc-number"></span> <span class="toc-text">当然也可以同时指定多个选择器。QPushButton, QLabel, QLineEdit { font-size: 50px; color: red;}</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-3-%E9%80%89%E6%8B%A9%E5%99%A8%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.1.</span> <span class="toc-text">6.8.3 选择器的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-4-%E5%AD%90%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">0.2.</span> <span class="toc-text">6.8.4 子控制器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-5-%E4%BC%AA%E7%8A%B6%E6%80%81"><span class="toc-number">0.3.</span> <span class="toc-text">6.8.5 伪状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-6-QSS%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">0.4.</span> <span class="toc-text">6.8.6 QSS第三方库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-9-1-%E5%9B%BD%E9%99%85%E5%8C%96-%E4%BD%BF%E7%94%A8translate-%E6%96%B9%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">6.9.1 国际化-使用translate()方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-2-%E5%88%B6%E4%BD%9C-ts%E6%96%87%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">6.9.2 制作.ts文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%9B%BE%E5%BD%A2%E5%9B%BE%E5%85%83%E7%B1%BBQGraphicsItem-%E6%A0%87%E5%87%86%E5%9B%BE%E5%85%83"><span class="toc-number">2.</span> <span class="toc-text">7.1 图形图元类QGraphicsItem-标准图元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E5%9B%BE%E5%85%83%E5%B1%82%E7%BA%A7"><span class="toc-number">2.1.</span> <span class="toc-text">7.1.2 图元层级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E5%9B%BE%E5%85%83%E5%B1%82%E7%BA%A7%E2%80%94%E7%88%B6%E5%9B%BE%E5%85%83%E4%BC%9A%E8%A2%AB%E5%AD%90%E5%9B%BE%E5%85%83%E9%81%AE%E6%8C%A1"><span class="toc-number">2.2.</span> <span class="toc-text">7.1.2 图元层级—父图元会被子图元遮挡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-3-%E5%9B%BE%E5%85%83%E5%8F%98%E6%8D%A2"><span class="toc-number">2.3.</span> <span class="toc-text">7.1.3 图元变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-4-%E5%9B%BE%E5%85%83%E5%88%86%E7%BB%84"><span class="toc-number">2.4.</span> <span class="toc-text">7.1.4 图元分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-5-%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B"><span class="toc-number">2.5.</span> <span class="toc-text">7.1.5 碰撞检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-6-%E7%BB%99%E5%9B%BE%E5%85%83%E6%B7%BB%E5%8A%A0%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%8A%A8%E7%94%BB"><span class="toc-number">2.6.</span> <span class="toc-text">7.1.6 给图元添加信号和动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%9B%BE%E5%BD%A2%E5%9C%BA%E6%99%AF%E7%B1%BBQGraphicsScene"><span class="toc-number">3.</span> <span class="toc-text">7.2 图形场景类QGraphicsScene</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-1-%E7%AE%A1%E7%90%86%E5%9B%BE%E5%85%83"><span class="toc-number">3.1.</span> <span class="toc-text">7.2.1 管理图元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-2-%E5%B5%8C%E5%85%A5%E6%8E%A7%E4%BB%B6"><span class="toc-number">3.2.</span> <span class="toc-text">7.2.2 嵌入控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-2-%E5%B5%8C%E5%85%A5%E6%8E%A7%E4%BB%B6-%E4%BD%BF%E7%94%A8%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86%E5%99%A8%E6%8E%92%E5%88%97%E6%8E%A7%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">7.2.2 嵌入控件-使用布局管理器排列控件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%9B%BE%E5%BD%A2%E8%A7%86%E5%9B%BE%E7%B1%BBQGraphicsView"><span class="toc-number">4.</span> <span class="toc-text">7.3 图形视图类QGraphicsView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-1-%E8%A7%86%E5%9B%BE%E5%92%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%85%B3%E7%B3%BB"><span class="toc-number">4.1.</span> <span class="toc-text">7.3.1 视图和场景的大小关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-2-%E8%A7%86%E5%9B%BE%E5%8F%98%E6%8D%A2"><span class="toc-number">4.2.</span> <span class="toc-text">7.3.2 视图变换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-1-%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.</span> <span class="toc-text">7.4.1 事件传递顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-2-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2"><span class="toc-number">5.1.</span> <span class="toc-text">7.4.2 坐标转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-PyInstaller"><span class="toc-number">6.</span> <span class="toc-text">8.1 PyInstaller</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">6.1.</span> <span class="toc-text">8.1.1 环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-2-PyInstaller%E5%A4%9A%E6%96%87%E4%BB%B6%E5%92%8C%E5%8D%95%E6%96%87%E4%BB%B6%E6%89%93%E5%8C%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.2.</span> <span class="toc-text">8.1.2 PyInstaller多文件和单文件打包模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-3-%E9%BB%91%E6%A1%86%E7%9A%84%E8%B0%83%E8%AF%95%E4%BD%9C%E7%94%A8"><span class="toc-number">6.3.</span> <span class="toc-text">8.1.3 黑框的调试作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-4-%E7%BB%99%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E5%8A%A0%E4%B8%8A%E5%9B%BE%E6%A0%87"><span class="toc-number">6.4.</span> <span class="toc-text">8.1.4 给可执行文件加上图标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-5-%E6%89%93%E5%8C%85%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">6.5.</span> <span class="toc-text">8.1.5 打包资源文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-6-%E5%87%8F%E5%B0%8F%E6%89%93%E5%8C%85%E5%90%8E%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F"><span class="toc-number">6.6.</span> <span class="toc-text">8.1.6 减小打包后的文件大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-7-%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">6.7.</span> <span class="toc-text">8.1.7 其他常用的命令</span></a></li></ol></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/02/Tiktok%E9%80%BB%E8%BE%91/" title="Tiktok逻辑"><img src="https://wallpaperm.cmcm.com/9655cfa8c58487380493c671b8daa038.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Tiktok逻辑"></a><div class="content"><a class="title" href="/2023/10/02/Tiktok%E9%80%BB%E8%BE%91/" title="Tiktok逻辑">Tiktok逻辑</a><time datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/02/hello-world%20/" title="Hello World2"><img src="https://pic4.zhimg.com/v2-337ffc158c015de82c001e08b8e44ac3_r.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hello World2"></a><div class="content"><a class="title" href="/2023/10/02/hello-world%20/" title="Hello World2">Hello World2</a><time datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/02/hexo%20%E5%8A%A0%E5%85%A5mermaid/" title="hexo 加入 mermaid（基于butterfly主题）"><img src="https://th.bing.com/th?id=OSK.HERO_5pA1UD5woifCs5BQrRR_mZULDvDIyqmHBXIp9eZbS4&amp;w=472&amp;h=280&amp;c=1&amp;rs=2&amp;o=6&amp;dpr=2.3&amp;pid=SANGAM" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="hexo 加入 mermaid（基于butterfly主题）"></a><div class="content"><a class="title" href="/2023/10/02/hexo%20%E5%8A%A0%E5%85%A5mermaid/" title="hexo 加入 mermaid（基于butterfly主题）">hexo 加入 mermaid（基于butterfly主题）</a><time datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/02/hexo%20%E8%81%94%E5%8A%A8%E9%83%A8%E7%BD%B2github%20page%20-%20%E5%89%AF%E6%9C%AC/" title="hexo 联动部署github page"><img src="https://pic4.zhimg.com/v2-66979fba86f65e3900e76a4ec928319b_r.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="hexo 联动部署github page"></a><div class="content"><a class="title" href="/2023/10/02/hexo%20%E8%81%94%E5%8A%A8%E9%83%A8%E7%BD%B2github%20page%20-%20%E5%89%AF%E6%9C%AC/" title="hexo 联动部署github page">hexo 联动部署github page</a><time datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/02/obsidian%20%E4%B8%8E%20hexo%20%E8%81%94%E5%8A%A8%E9%83%A8%E7%BD%B2github%20page/" title="obsidian 与 hexo 联动部署github page"><img src="https://pic2.zhimg.com/80/v2-597a23f8427f41a41dfd2f5b8474d09d_1440w.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="obsidian 与 hexo 联动部署github page"></a><div class="content"><a class="title" href="/2023/10/02/obsidian%20%E4%B8%8E%20hexo%20%E8%81%94%E5%8A%A8%E9%83%A8%E7%BD%B2github%20page/" title="obsidian 与 hexo 联动部署github page">obsidian 与 hexo 联动部署github page</a><time datetime="2023-10-02T06:17:08.474Z" title="发表于 2023-10-02 14:17:08">2023-10-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 <i id="heartbeat" class="fa fas fa-heartbeat"></i> 嗷，Mr.威</div><div class="framework-info"><span>框架 </span><a href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>var options;window.mermaid&&(options=JSON.parse(document.getElementById("maid-script").getAttribute("mermaidoptioins")),mermaid.initialize(options))</script></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="/js/sakura.js"></script><script type="text/javascript" src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script><script type="text/javascript" src="\js\snow.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!0,document.body.addEventListener("input",POWERMODE)</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script data-pjax>function butterfly_categories_card_injector_config(){var a=document.getElementById("recent-posts");console.log("已挂载butterfly_categories_card"),a.insertAdjacentHTML("afterbegin",'<style>li.categoryBar-list-item{width:24%;}.categoryBar-list{max-height: 380px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 320px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover1.webp);"> <a class="categoryBar-list-link" href="categories/跨境电商/">跨境电商</a><span class="categoryBar-list-count">5</span><span class="categoryBar-list-descr">万里青天开笑口</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover2.webp);"> <a class="categoryBar-list-link" href="categories/学习笔记/">学习笔记</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">持换取信任，信任就是品牌</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover3.webp);"> <a class="categoryBar-list-link" href="categories/hexo/">hexo</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">书到今生读已迟坚</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover4.webp);"> <a class="categoryBar-list-link" href="categories/网站搭建/">网站搭建</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">岩中宴坐已多事，况起多余问什么</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover5.webp);"> <a class="categoryBar-list-link" href="categories/开源ai模型/">开源ai模型</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">天天开心</span></li></ul></div></div>')}document.getElementById("recent-posts")&&"/"===location.pathname&&butterfly_categories_card_injector_config()</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/koharu.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},log:!1})</script></body></html>